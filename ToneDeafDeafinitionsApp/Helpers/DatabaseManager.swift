//
//  DatabaseManager.swift
//  ToneDeafDeafinitionsApp
//
//  Created by Tone Deaf on 7/29/20.
//  Copyright Â© 2020 GITEM Solutions. All rights reserved.
//

import Foundation
import FirebaseDatabase
var langId = ""
var songContentTag = "SONG"
var beatContentTag = "BEAT"
var albumContentTag = "ALBM"
var videoContentTag = "VIDO"
var iGTVVideoContentTag = "IGTV"
var eventsContentTag = "EVNT"
var instagramPostVideoContentTag = "IGPO"
var facebookPostVideoContentTag = "FBPO"
var worldstarVideoContentTag = "WDST"
var tikTokVideoContentTag = "TKTK"
var twitterVideoContentTag = "TWIT"

var youtubeVideoContentTyp = "YTVD"
var youtubePlaylistContentType = "YTPL"
var youtubeBeatVideoContentTyp = "YTBT"
var youtubeAudioVideoContentType = "YTAD"
var youtubeAltVideoContentType = "YTAL"
var songIGTVVideoContentType = "sIGTV"
var instrumentalContentType = "INMT"

var appleMusicContentType = "APPL"
var spotifyMusicContentType = "SPTY"
var soundcloudMusicContentType = "SDCD"
var youtubeMusicContentType = "YMSC"
var amazonMusicContentType = "AMZN"
var deezerMusicContentType = "DEEZ"
var spinrillaMusicContentType = "SPNR"
var napsterMusicContentType = "NAPS"
var tidalMusicContentType = "TIDL"

//24 didgits is memorabilia
//23 didgits is apperal
//22 didgits is a kit
//21 didgits is a bundle
//20 didgits is a service
//14 didgits is a beat
//12 digits is an instrumental
//10 digits is a song
//9 digits is a video
//8 digits is an Album
//6 digits is a Registered Person

//Verification Levels
//A - High Level and in Music Industry , Main Focus and in Music Industry
//B - Regular Industry not a major tallent or work
//C - Street Buzz, Underground
//U - Underground, Unverified


final class DatabaseManager {
    
    public var tempbeats: [BeatData] = []
    
    static let shared = DatabaseManager()
    
    private let database = Database.database().reference()
        
}

extension DatabaseManager {
    
    func getUserData(with uid: String, completion: @escaping ((UserData) -> Void)) {
        var favorites:[UserFavorite] = []
        var downloads:[UserDownload] = []
        let user = UserData(accountType: "", email: "", uid: "", name: "", phone: "", appleConnected: false, googleConnected: false, facebookConnected: false, twitterConnected: false, paypalConnected: false, squareConnected: false, spotifyConnected: false, currentDevice: "", favorites: [], downloads: [], brainTreeID: nil, brainTreeCT: nil)
        
        database.child("Users").queryOrdered(byChild: uid).observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                var temp:Array<Any> = []
                let data = child as! DataSnapshot
                if data.key == uid {
                    let dvalue = data.value as! [String:Any]
                    temp.append(dvalue["Account Type"] as! String)
                    temp.append(dvalue["Apple Account Connected"] as! String)
                    temp.append(dvalue["Current Device Model"] as! String)
                    temp.append(dvalue["Email"] as! String)
                    temp.append(dvalue["Facebook Account Connected"] as! String)
                    temp.append(dvalue["Full Name"] as! String)
                    temp.append(dvalue["Google Account Connected"] as! String)
                    temp.append(dvalue["Phone Number"] as! String)
                    temp.append(dvalue["Twitter Account Connected"] as! String)
                    temp.append(dvalue["uid"] as! String)
                    if let btid = dvalue["Braintree ID"] as? String {
                        user.brainTreeID = btid
                    }
                    if let btid = dvalue["Braintree CT"] as? String {
                        user.brainTreeCT = btid
                    }
                    if let dbfav = dvalue["Favorites"] as? [String:Any] {
                        for (key,val) in dbfav {
                            let valdict = val as! [String:Any]
                            let stamp = valdict["Timestamp"] as! String
                            let dateFormatter = DateFormatter()
                            dateFormatter.locale = Locale(identifier: "en_US_POSIX") // set locale to reliable US_POSIX
                            dateFormatter.dateFormat = "yyyy-MM-dd HH:mm:ss Z"
                            let date = dateFormatter.date(from:stamp)!
                            let fav = UserFavorite(dbid: key, timestamp: date)
                            favorites.append(fav)
                        }
                    }
                    if let dbfav = dvalue["Downloads"] as? [String:Any] {
                        for (key,val) in dbfav {
                            let valdict = val as! [String:Any]
                            let stamp = valdict["Timestamp"] as! String
                            let url = valdict["Download URL"] as! String
                            let dloadname = valdict["Name"] as! String
                            var fileURL:String!
                            if let url = valdict["Destination Path"] as? String {
                                fileURL = url
                            }
                            let dateFormatter = DateFormatter()
                            dateFormatter.locale = Locale(identifier: "en_US_POSIX") // set locale to reliable US_POSIX
                            dateFormatter.dateFormat = "yyyy-MM-dd HH:mm:ss Z"
                            let date = dateFormatter.date(from:stamp)!
                            let download = UserDownload(name: dloadname, dbid: key, timestamp: date, downloadURL: url, destinationPath: fileURL)
                            downloads.append(download)
                        }
                    }
                    user.accountType = temp[0] as! String
                    if temp[1] as! String == "No" {
                        user.appleConnected = false
                    } else {
                        user.appleConnected = true
                    }
                    user.currentDevice = temp[2] as! String
                    user.email = temp[3] as! String
                    if temp[4] as! String == "No" {
                        user.facebookConnected = false
                    } else {
                        user.facebookConnected = true
                    }
                    user.name = temp[5] as! String
                    if temp[6] as! String == "No" {
                        user.googleConnected = false
                    } else {
                        user.googleConnected = true
                    }
                    user.phone = temp[7] as! String
                    if temp[8] as! String == "No" {
                        user.twitterConnected = false
                    } else {
                        user.twitterConnected = true
                    }
                    user.uid = temp[9] as! String
                    user.favorites = favorites
                    user.downloads = downloads
                    
                    completion(user)
                }
            }
        })
    }

    public func adminAccountType(with uid: String, completion: @escaping ((Bool, String) -> Void)) {
        database.child("Users").child(AdminAccount).observeSingleEvent(of: .value, with: { snapshot in
            print("ðŸ“™ snapshot of admin account \(String(describing: snapshot.value))")
            if snapshot.hasChild(uid) != false {
                print("ðŸ“™ admin account data base search result: account is an Admin Account")
                completion(true, AdminAccount)
            } else {
                print("ðŸ“™ admin account data base search result: Account is not Admin.")
                completion(false, "Not Admin")
                return
            }
        })
    }
    public func anonymousAccountType(with uid: String, completion: @escaping ((Bool, String) -> Void)) {
        database.child("Users").child(AnonymousAccount).observeSingleEvent(of: .value, with: { snapshot in
            //print("ðŸ“™ snapshot of anon account \(String(describing: snapshot.value))")
            if snapshot.hasChild(uid) != false {
                print("ðŸ“™ Anonymous account data base search result: account is an Anonymous Account")
                completion(true, AnonymousAccount)
            } else {
                print("ðŸ“™ Anonymous account data base search result: Account is not Anonymous.")
                completion(false, "Not Anonymous")
                return
            }
        })
    }
    public func listenerAccountType(with uid: String, completion: @escaping ((Bool, String) -> Void)) {
        database.child("Users").child(ListenerAccount).observeSingleEvent(of: .value, with: { snapshot in
            //print("ðŸ“™ snapshot of listener account \(String(describing: snapshot.value))")
            if snapshot.hasChild(uid) != false {
                print("ðŸ“™ Listener account data base search result: account is a Listener Account")
                completion(true, ListenerAccount)
            } else {
                print("ðŸ“™ Listener account data base search result: Account is not Listener.")
                completion(false, "Not Listener")
                return
            }
        })
    }
    public func creatorAccountType(with uid: String, completion: @escaping ((Bool, String) -> Void)) {
        database.child("Users").child(CreatorAccount).observeSingleEvent(of: .value, with: { snapshot in
            //print("ðŸ“™ snapshot of artist account \(String(describing: snapshot.value))")
            if snapshot.hasChild(uid) != false {
                print("ðŸ“™ Creator account data base search result: account is a Creator Account")
                completion(true, CreatorAccount)
            } else {
                print("ðŸ“™ Creator account data base search result: Account is not a Creator.")
                completion(false, "Not Creator")
                return
            }
        })
    }
    
    
    
    public func checkMemberEmail(with email: String, completion: @escaping ((Bool) -> Void)) {
        database.child("Users").queryOrdered(byChild: "Email").queryEqual(toValue: email).observeSingleEvent(of: .value, with: { snapshot in
            print("ðŸ“™ snapshot of matching emails \(String(describing: snapshot.value))")
            if snapshot.exists() != false {
                print("ðŸ“™ Account Already connected")
                completion(true)
                return
            } else {
                print("ðŸ“™ No accounts found.")
                completion(false)
                return
            }
        })
    }
    
    public func checkIfGoogleAccountIsAlreadyConnected(email:String, completion: @escaping ((Bool) -> Void)) {
        checkMemberEmail(with: email, completion: { exists in
            if !exists{
                completion(false)
                print("ðŸ“• Shouldnt make it here, CODE ERROR .")
                return
            } else
            {
                print("ðŸ“™ acctype: \(accountType)")
                let queryRef = self.database.child("Users").queryOrdered(byChild: "Email").queryEqual(toValue: email)
                queryRef.observeSingleEvent(of: .value, with: { (snapshot) in
                    for snap in snapshot.children {
                        let userSnap = snap as! DataSnapshot
                        let uid = userSnap.key//the uid of each user
                        print("ðŸ“™ uid: \(uid)")
                        self.database.child("Users").child(uid).child("Google Account Connected").observeSingleEvent(of: .value , with: { nsnapshot in
                            let snap = nsnapshot.value as! String
                            print("ðŸ“™ google account snapshot \(snap)")
                            if snap != "No" {
                                print("ðŸ“™ Google Account already connected. Returning google user")
                                completion(true)
                                return
                            } else {
                                print("ðŸ“™ No google account connection found./ New google connection to pre registered user.")
                                completion(false)
                                return
                            }
                        })
                    }
                })
            }
        })
    }
    
    public func checkIfFacebookAccountIsAlreadyConnected(email:String, completion: @escaping ((Bool) -> Void)) {
        checkMemberEmail(with: email, completion: { exists in
            if !exists{
                completion(false)
                print("ðŸ“• Shouldnt make it here, CODE ERROR .")
                return
            } else
            {
                print("ðŸ“™ acctype: \(accountType)")
                let queryRef = self.database.child("Users").child(accountType).queryOrdered(byChild: "Email").queryEqual(toValue: email)
                queryRef.observeSingleEvent(of: .value, with: { (snapshot) in
                    for snap in snapshot.children {
                        let userSnap = snap as! DataSnapshot
                        let uid = userSnap.key//the uid of each user
                        print("ðŸ“™ uid: \(uid)")
                        self.database.child("Users").child(accountType).child(uid).child("Facebook Account Connected").observeSingleEvent(of: .value , with: { nsnapshot in
                            let snap = nsnapshot.value as! String
                            print("ðŸ“™ Facebook account snapshot \(snap)")
                            if snap != "No" {
                                print("ðŸ“™ Facebook Account already connected. Returning Facebook user")
                                completion(true)
                                return
                            } else {
                                print("ðŸ“™ No Facebook account connection found./ New google connection to pre registered user.")
                                completion(false)
                                return
                            }
                        })
                    }
                })
            }
        })
    }
  
    
    
    public func checkIfAppIdExists(appid: String, completion: @escaping ((Bool) -> Void)) {
        DispatchQueue.global(qos: .background).async {
            
            Database.database().reference().child("Music Content").child("Songs").observeSingleEvent(of: .value, with: { snapshot in
                for child in snapshot.children {
                    let pieceOfContent = child as! DataSnapshot
                    if (pieceOfContent.key).contains(appid) == true {
                        print(pieceOfContent.key)
                        completion(true)
                    }
                }
                completion(false)
                return
            })
        }
    }
    
    public func checkIfBeatAppIdExists(appid: String, completion: @escaping ((Bool) -> Void)) {
        Database.database().reference().child("Beats").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let pieceOfContent = child as! DataSnapshot
                if (pieceOfContent.key).contains(appid) == true {
                    print(pieceOfContent.key)
                    completion(true)
                }
            }
            
            completion(false)
            return
        })
    }
    
    public func checkIfPersonAppIdExists(appid: String, completion: @escaping ((Bool) -> Void)) {
        Database.database().reference().child("Registered Persons").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let pieceOfContent = child as! DataSnapshot
                if (pieceOfContent.key).contains(appid) == true {
                    print(pieceOfContent.key)
                    completion(true)
                }
            }
            completion(false)
            return
        })
    }
    
    public func checkIfVideoAppIdExists(appid: String, completion: @escaping ((Bool) -> Void)) {
        Database.database().reference().child("Music Content").child("Videos").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let pieceOfContent = child as! DataSnapshot
                if (pieceOfContent.key).contains(appid) == true {
                    print(pieceOfContent.key)
                    completion(true)
                }
            }
            completion(false)
            return
        })
    }
    
    public func checkIfInstrumentalAppIdExists(appid: String, completion: @escaping ((Bool) -> Void)) {
        Database.database().reference().child("Music Content").child("Instrumentals").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let pieceOfContent = child as! DataSnapshot
                if (pieceOfContent.key).contains(appid) == true {
                    print(pieceOfContent.key)
                    completion(true)
                }
            }
            completion(false)
            return
        })
    }
    
    public func checkIfAlbumAppIdExists(appid: String, completion: @escaping ((Bool) -> Void)) {
        Database.database().reference().child("Music Content").child("Albums").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let pieceOfContent = child as! DataSnapshot
                if (pieceOfContent.key).contains(appid) == true {
                    print(pieceOfContent.key)
                    completion(true)
                }
            }
            completion(false)
            return
        })
    }
    
    
    func fetchAllPersonsFromDatabase(completion: @escaping (([PersonData]) -> Void)) {
        //print(artist)
        var contentFeaturedArray:[PersonData] = []
        Database.database().reference().child("Registered Persons").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                
                let perso = PersonData(name: "", legalName: nil, toneDeafAppId: "", mainRole: "", roles: nil, songs: nil, videos: nil, beats: nil, instrumentals: nil, albums: nil, merch: nil, alternateNames: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, youtube: nil, instagram: nil, twitter: nil, facebook: nil, tikTok: nil, manualImageURL: nil,followers: 0, industryCerified: false, verificationLevel: nil, isActive: nil)
                let up = child as! DataSnapshot
                if up.key != "All Person IDs" {
                    var temp:Array<Any> = []
                    let dvalue = up.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Main Role"] as! String)
                    temp.append(dvalue["Active Status"] as! Bool)
                    if let tval = dvalue["Alternate Names"] as? [String] {
                        perso.alternateNames = tval
                    }
                    if let tval = dvalue["Linked To Account"] as? String {
                        perso.linkedToAccount = tval
                    }
                    if let tval = dvalue["Songs"] as? [String] {
                        perso.songs = tval
                    }
                    if let tval = dvalue["Albums"] as? [String] {
                        perso.albums = tval
                    }
                    if let tval = dvalue["Beats"] as? [String] {
                        perso.beats = tval
                    }
                    if let tval = dvalue["Videos"] as? [String] {
                        perso.videos = tval
                    }
                    if let tval = dvalue["Instrumentals"] as? [String] {
                        perso.instrumentals = tval
                    }
                    if let merchandise = (dvalue["Merch"]) {
                        perso.merch = (merchandise as! [String])
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        perso.legalName = (lname as! String)
                    }
                    if let rolesarr = (dvalue["Roles"]) {
                        perso.roles = (rolesarr as! NSMutableDictionary)
                    }
                    if let tval = dvalue["Manual Image URL"] as? String {
                        perso.manualImageURL = tval
                    }
                    if let data = dvalue["Apple Music"] as? NSDictionary {
                        let togo = AppleMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, allAlbumIDs: nil)
                        if let aaid = data["All Album IDs"] as? [String] {
                            togo.allAlbumIDs = aaid
                        }
                        perso.apple = togo
                    }
                    if let data = dvalue["Spotify"] as? NSDictionary {
                        let togo = SpotifyPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.spotify = togo
                    }
                    if let data = dvalue["Soundcloud"] as? NSDictionary {
                        let togo = SoundcloudPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.soundcloud = togo
                    }
                    if let data = dvalue["Youtube Music"] as? NSDictionary {
                        let togo = YoutubeMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtubeMusic = togo
                    }
                    if let data = dvalue["Amazon Music"] as? NSDictionary {
                        let togo = AmazonPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.amazon = togo
                    }
                    if let data = dvalue["Deezer"] as? NSDictionary {
                        let togo = DeezerPersonData(url: data["URL"] as! String, profileImageURL: data["Profile Image URL"] as! String, id: data["id"] as! String, name: data["Name"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.deezer = togo
                    }
                    if let data = dvalue["Spinrilla"] as? NSDictionary {
                        let togo = SpinrillaPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.spinrilla = togo
                    }
                    if let data = dvalue["Napster"] as? NSDictionary {
                        let togo = NapsterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.napster = togo
                    }
                    if let data = dvalue["Tidal"] as? NSDictionary {
                        let togo = TidalPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tidal = togo
                    }
                    if let data = dvalue["Youtube"] as? NSDictionary {
                        let togo = YoutubePersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtube = togo
                    }
                    if let data = dvalue["Instagram"] as? NSDictionary {
                        let togo = InstagramPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.instagram = togo
                    }
                    if let data = dvalue["Twitter"] as? NSDictionary {
                        let togo = TwitterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, dateCreated: data["Date Created"] as! String, name: data["Name"] as! String, userName: data["Username"] as! String, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.twitter = togo
                    }
                    if let data = dvalue["Facebook"] as? NSDictionary {
                        let togo = FacebookPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.facebook = togo
                    }
                    if let data = dvalue["TikTok"] as? NSDictionary {
                        let togo = TikTokPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tikTok = togo
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        perso.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        perso.verificationLevel = Character(tval)
                    }
                    
                    perso.name = temp[0] as! String
                    perso.dateRegisteredToApp = temp[1] as! String
                    perso.timeRegisteredToApp = temp[2] as! String
                    perso.followers = temp[3] as! Int
                    perso.toneDeafAppId = (temp[4] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                    perso.mainRole = temp[5] as! String
                    perso.isActive = temp[6] as! Bool
                    
                    contentFeaturedArray.append(perso)
                }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllArtistFromDatabase(completion: @escaping (([ArtistData]) -> Void)) {
        //print(artist)
        var contentFeaturedArray:[ArtistData] = []
        Database.database().reference().child("Registered Artists").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                
                let artis = ArtistData(name: "", legalName: nil, toneDeafAppId: "", songs: [""], videos: [""], albums: [""], merch: nil, alternateNames: [""], dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotifyProfileURL: "", appleProfileURL: "", soundcloudProfileURL: nil, youtubeMusicProfileURL: nil, amazonProfileURL: nil, deezerProfileURL: nil, spinrillaProfileURL: nil, napsterProfileURL: nil, tidalProfileURL: nil, youtubeChannelURL: nil, instagramProfileURL: nil, twitterProfileURL: nil, facebookProfileURL: nil, spotifyProfileImageURL: "", soundcloudProfileImageURL: nil, youtubeMusicProfileImageURL: nil, amazonProfileImageURL: nil, deezerProfileImageURL: nil, spinrillaProfileImageURL: nil, napsterProfileImageURL: nil, tidalProfileImageURL: nil, youtubeChannelImageURL: nil, instagramProfileImageURL: nil, twitterProfileImageURL: nil, facebookProfileImageURL: nil,appleAllArtistAlbumIds: [""],followers: 0)
                let up = child as! DataSnapshot
                if up.key != "All Artist IDs" {
                    var temp:Array<Any> = []
                    let dvalue = up.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Alternate Names"] as! Array<String>)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Linked To Account"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Songs"] as! Array<String>)
                    temp.append(dvalue["Albums"] as! Array<String>)
                    temp.append(dvalue["Videos"] as! Array<String>)
                    if let merchandise = (dvalue["Merch"]) {
                        artis.merch = (merchandise as! [String])
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        artis.legalName = (lname as! String)
                    }
                    if let profileurl = (dvalue["Apple Profile URL"]) {
                        artis.appleProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Spotify Profile URL"]) {
                        artis.spotifyProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spotify Profile Image URL"]) {
                        artis.spotifyProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Soundcloud Profile URL"]) {
                        artis.soundcloudProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Soundcloud Profile Image URL"]) {
                        artis.soundcloudProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Music Profile URL"]) {
                        artis.youtubeMusicProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Youtube Music Profile Image URL"]) {
                        artis.youtubeMusicProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Amazon Profile URL"]) {
                        artis.amazonProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Amazon Profile Image URL"]) {
                        artis.amazonProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Deezer Profile URL"]) {
                        artis.deezerProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Deezer Profile Image URL"]) {
                        artis.deezerProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Spinrilla Profile URL"]) {
                        artis.spinrillaProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spinrilla Profile Image URL"]) {
                        artis.spinrillaProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Napster Profile URL"]) {
                        artis.napsterProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Napster Profile Image URL"]) {
                        artis.napsterProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Tidal Profile URL"]) {
                        artis.tidalProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Tidal Profile Image URL"]) {
                        artis.tidalProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Channel URL"]) {
                        artis.youtubeChannelURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Instagram Profile URL"]) {
                        artis.instagramProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Instagram Profile Image URL"]) {
                        artis.instagramProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Twitter Profile URL"]) {
                        artis.twitterProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Twitter Profile Image URL"]) {
                        artis.twitterProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Facebook Profile URL"]) {
                        artis.facebookProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Facebook Profile Image URL"]) {
                        artis.facebookProfileImageURL = (imageurl as! String)
                    }
                    
                    artis.name = temp[0] as! String
                    artis.alternateNames = temp[1] as! Array<String>
                    artis.dateRegisteredToApp = temp[2] as! String
                    artis.timeRegisteredToApp = temp[3] as! String
                    artis.linkedToAccount = temp[4] as! String
                    artis.followers = temp[5] as! Int
                    artis.toneDeafAppId = (temp[6] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                    artis.songs = temp[7] as! Array<String>
                    artis.albums = temp[8] as! Array<String>
                    artis.videos = temp[9] as! Array<String>
                    
                    contentFeaturedArray.append(artis)
                }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllProducersFromDatabase(completion: @escaping (([ProducerData]) -> Void)) {
        //print(artist)
        var contentFeaturedArray:[ProducerData] = []
        Database.database().reference().child("Registered Producers").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let producer = ProducerData(name: "", legalName: nil, toneDeafAppId: "", songs: [""], videos: [""], beats: [""], instrumentals: [""], albums: [""], merch: nil, alternateNames: [""], dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotifyProfileURL: "", appleProfileURL: "", soundcloudProfileURL: nil, youtubeMusicProfileURL: nil, amazonProfileURL: nil, deezerProfileURL: nil, spinrillaProfileURL: nil, napsterProfileURL: nil, tidalProfileURL: nil, youtubeChannelURL: nil, instagramProfileURL: nil, twitterProfileURL: nil, facebookProfileURL: nil, spotifyProfileImageURL: "", appleAllArtistAlbumIds: [""], followers: 0)
                let up = child as! DataSnapshot
                var temp:Array<Any> = []
                if up.key != "All Producer IDs" {
                    let dvalue = up.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Alternate Names"] as! Array<String>)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Linked To Account"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Songs"] as! Array<String>)
                    temp.append(dvalue["Albums"] as! Array<String>)
                    temp.append(dvalue["Videos"] as! Array<String>)
                    temp.append(dvalue["Beats"] as! Array<String>)
                    temp.append(dvalue["Instrumentals"] as! Array<String>)
                    if let merchandise = (dvalue["Merch"]) {
                        producer.merch = (merchandise as! [String])
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        producer.legalName = (lname as! String)
                    }
                    if let profileurl = (dvalue["Apple Profile URL"]) {
                        producer.appleProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Spotify Profile URL"]) {
                        producer.spotifyProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spotify Profile Image URL"]) {
                        producer.spotifyProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Soundcloud Profile URL"]) {
                        producer.soundcloudProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Music Profile URL"]) {
                        producer.youtubeMusicProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Amazon Profile URL"]) {
                        producer.amazonProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Deezer Profile URL"]) {
                        producer.deezerProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Spinrilla Profile URL"]) {
                        producer.spinrillaProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Napster Profile URL"]) {
                        producer.napsterProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Tidal Profile URL"]) {
                        producer.tidalProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Channel URL"]) {
                        producer.youtubeChannelURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Instagram Profile URL"]) {
                        producer.instagramProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Twitter Profile URL"]) {
                        producer.twitterProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Facebook Profile URL"]) {
                        producer.facebookProfileURL = (profileurl as! String)
                    }
                    
                    producer.name = temp[0] as! String
                    producer.alternateNames = temp[1] as! Array<String>
                    producer.dateRegisteredToApp = temp[2] as! String
                    producer.timeRegisteredToApp = temp[3] as! String
                    producer.linkedToAccount = temp[4] as! String
                    producer.followers = temp[5] as! Int
                    producer.toneDeafAppId = (temp[6] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                    producer.songs = temp[7] as! Array<String>
                    producer.albums = temp[8] as! Array<String>
                    producer.videos = temp[9] as! Array<String>
                    producer.beats = temp[10] as! Array<String>
                    producer.instrumentals = temp[11] as! Array<String>
                    
                    contentFeaturedArray.append(producer)
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllSongsFromDatabase(completion: @escaping (([SongData]) -> Void)) {
        var contentFeaturedArray:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                var youtubeAlts:[String] = []
                let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                let content = child as! DataSnapshot
                let akey = content.key
                if content.key != "All Song IDs" {
                    for kid in content.children {
                        let sub = kid as! DataSnapshot
                        let dkey = sub.key
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = sub.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artist"] as! Array<String>)
                            temp.append(dvalue["Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                if let eng = engies1["Mix Engineer"] as? Array<String> {
                                    song.songMixEngineer = eng
                                }
                                if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                    song.songMasteringEngineer = eng
                                }
                                if let eng = engies1["Recording Engineer"] as? Array<String> {
                                    song.songRecordingEngineer = eng
                                }
                            }
                            if let merchandise = (dvalue["Merch"] as? [String]) {
                                song.merch = (merchandise)
                            }
                            if let tval = (dvalue["Instrumentals"] as? [String]) {
                                song.instrumentals = tval
                            }
                            if let tval = (dvalue["Albums"] as? [String]) {
                                song.albums = tval
                            }
                            if let tval = (dvalue["Videos"] as? [String]) {
                                song.videos = tval
                            }
                            if let tval = (dvalue["Writers"] as? [String]) {
                                song.songWriters = tval
                            }
                            if let tval = (dvalue["Manual Image URL"] as? String) {
                                song.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"] as? String) {
                                song.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                song.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                song.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Explicit"] as? Bool) {
                                song.explicit = tval
                            }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                            
                        song.name = temp[0] as! String
                            song.songArtist = temp[1] as! Array<String>
                            song.songProducers = temp[2] as! Array<String>
                            song.favoritesOverall = temp[3] as! Int
                            song.toneDeafAppId = temp[4] as! String
                            song.isActive = temp[5] as! Bool
                        }
                        if dkey.contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist"] as! String)
                            temp.append(dvalue["Album Name"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = temp[15] as! Bool
                            
                            song.apple = apple
                            
                        }
                        if dkey.contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist 1"] as! String)
                            temp.append(dvalue["Artist 1 URL"] as! String)
                            temp.append(dvalue["Artist 2"] as! String)
                            temp.append(dvalue["Artist 2 URL"] as! String)
                            temp.append(dvalue["Artist 3"] as! String)
                            temp.append(dvalue["Artist 3 URL"] as! String)
                            temp.append(dvalue["Artist 4"] as! String)
                            temp.append(dvalue["Artist 4 URL"] as! String)
                            temp.append(dvalue["Artist 5"] as! String)
                            temp.append(dvalue["Artist 5 URL"] as! String)
                            temp.append(dvalue["Artist 6"] as! String)
                            temp.append(dvalue["Artist 6 URL"] as! String)
                            temp.append(dvalue["Album Type"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            song.spotify = spotify
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                            soundcloud.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            song.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            youtubeMusic.url = temp[0] as! String
                            youtubeMusic.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            amazon.url = temp[0] as! String
                            amazon.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String : Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String : Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.isrc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.previewURL = temp[7] as! String
                            deezer.timeIA = temp[8] as! String
                            deezer.deezerID = temp[9] as! Int
                            deezer.dateIA = temp[10] as! String
                            deezer.isActive = temp[11] as! Bool
                            
                            song.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            spinrilla.url = temp[0] as! String
                            spinrilla.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            song.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            napster.url = temp[0] as! String
                            napster.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            tidal.url = temp[0] as! String
                            tidal.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in content.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        song.officialVideo = temp[0] as! String
                                    }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                                if vidkey == "Lyric" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.lyricVideo = temp[0] as! String
                                }
                            }
                        }
                        
                    }
                    contentFeaturedArray.append(song)
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllInstrumentalsFromDatabase(completion: @escaping (([InstrumentalData]) -> Void)) {
        var contentFeaturedArray:[InstrumentalData] = []
        Database.database().reference().child("Music Content").child("Instrumentals").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if !key.contains("Instrumental IDs") {
                    let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    var ltemp:Array<Any> = []
                    let dvalue = data.value as! [String:Any]
                    ltemp.append(dvalue["Name"] as! String)
                    ltemp.append(dvalue["Producers"] as! Array<String>)
                    ltemp.append(dvalue["Audio URL"] as! String)
                    ltemp.append(dvalue["Time Uploaded To App"] as! String)
                    ltemp.append(dvalue["Date Uploaded To App"] as! String)
                    ltemp.append(dvalue["Duration"] as! String)
                    ltemp.append(dvalue["Number of Favorites"] as! Int)
                    ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                    ltemp.append(dvalue["Active Status"] as! Bool)
                    if let tval = (dvalue["Songs"] as? [String]) {
                        instrumental.songs = tval
                    }
                    if let tval = (dvalue["Albums"] as? [String]) {
                        instrumental.albums = tval
                    }
                    if let eval = (dvalue["Engineers"] as? NSDictionary) {
                        if let tval = (eval["Mix Engineer"] as? [String]) {
                            instrumental.mixEngineer = tval
                        }
                        if let tval = (eval["Mastering Engineer"] as? [String]) {
                            instrumental.masteringEngineer = tval
                        }
                    }
                    if let tval = (dvalue["Albums"] as? [String]) {
                        instrumental.albums = tval
                    }
                    if let tval = (dvalue["Videos"] as? [String]) {
                        instrumental.videos = tval
                    }
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        instrumental.merch = (merchandise)
                    }
                    if let tval = (dvalue["Artists"] as? [String]) {
                        instrumental.artist = tval
                    }
                    if let tval = (dvalue["Manual Image URL"] as? String) {
                        instrumental.manualImageURL = tval
                    }
                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                        instrumental.manualPreviewURL = tval
                    }
                    if let tval = (dvalue["Official Video"] as? String) {
                        instrumental.officialVideo = tval
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        instrumental.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        instrumental.verificationLevel = Character(tval)
                    }
                    for chi in data.children {
                        let da = chi as! DataSnapshot
                        let lilkey = da.key
                        if lilkey == "Store Info" {
                            let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                            let botval = da.value as! [String:Any]
                            
                            inststore.retailPrice = botval["Retail Price"] as! Double
                            inststore.merchType = botval["Merch Type"] as! String
                            inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                            let predate = botval["Date Uploaded"] as! String
                            guard predate != "" else {return}
                            let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                            inststore.dateUploaded = date
                            if let ite = botval["Sale Price"] as? Double {
                                inststore.salePrice = ite
                            }
                            if let ite = botval["Quantity"] as? Int {
                                inststore.quantity = ite
                            }
                            instrumental.storeInfo = inststore
                        }
                    }
                    instrumental.instrumentalName = ltemp[0] as! String
                    instrumental.producers = ltemp[1] as! Array<String>
                    instrumental.audioURL = ltemp[2] as! String
                    instrumental.timeRegisteredToApp = ltemp[3] as! String
                    instrumental.dateRegisteredToApp = ltemp[4] as! String
                    instrumental.duration = ltemp[5] as! String
                    instrumental.favoritesOverall = ltemp[6] as! Int
                    instrumental.toneDeafAppId = ltemp[7] as! String
                    instrumental.isActive = ltemp[8] as! Bool
                    let songname = ltemp[0] as! String
                    instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                    for val in data.children {
                        var temp:Array<Any> = []
                        let cont = val as! DataSnapshot
                        let chi = cont.key
                        if (chi).contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Spotify"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist 1"] as! String)
                            temp.append(svalue["Artist 1 URL"] as! String)
                            temp.append(svalue["Artist 2"] as! String)
                            temp.append(svalue["Artist 2 URL"] as! String)
                            temp.append(svalue["Artist 3"] as! String)
                            temp.append(svalue["Artist 3 URL"] as! String)
                            temp.append(svalue["Artist 4"] as! String)
                            temp.append(svalue["Artist 4 URL"] as! String)
                            temp.append(svalue["Artist 5"] as! String)
                            temp.append(svalue["Artist 5 URL"] as! String)
                            temp.append(svalue["Artist 6"] as! String)
                            temp.append(svalue["Artist 6 URL"] as! String)
                            temp.append(svalue["Album Type"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            instrumental.spotify = spotify
                        }
                        if (chi).contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Apple"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist"] as! String)
                            temp.append(svalue["Album Name"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Apple Music Id"] as! String)
                            ltemp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = ltemp[15] as! Bool
                            
                            instrumental.apple = apple
                        }
                        if chi.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                                soundcloud.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                instrumental.soundcloud = soundcloud
                            }
                            if chi.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                youtubeMusic.url = temp[0] as! String
                                youtubeMusic.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.youtubeMusic = youtubeMusic
                            }
                            if chi.contains(amazonMusicContentType) == true {
                                let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                amazon.url = temp[0] as! String
                                amazon.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.amazon = amazon
                            }
                            if chi.contains(deezerMusicContentType) == true {
                                let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String : Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["ISRC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Song URL"] as! String)
                                temp.append(dvalue["Preview URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String : Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.isrc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.previewURL = temp[7] as! String
                                deezer.timeIA = temp[8] as! String
                                deezer.deezerID = temp[9] as! Int
                                deezer.dateIA = temp[10] as! String
                                deezer.isActive = temp[11] as! Bool
                                
                                instrumental.deezer = deezer
                            }
                            if chi.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                spinrilla.url = temp[0] as! String
                                spinrilla.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                instrumental.spinrilla = spinrilla
                            }
                            if chi.contains(napsterMusicContentType) == true {
                                let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                napster.url = temp[0] as! String
                                napster.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.napster = napster
                            }
                            if chi.contains(tidalMusicContentType) == true {
                                let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                tidal.url = temp[0] as! String
                                tidal.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.tidal = tidal
                            }
                        }
                    contentFeaturedArray.append(instrumental)
                        
                }

                }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllAlbumsFromDatabase(completion: @escaping (([AlbumData]) -> Void)) {
        var contentFeaturedArray:[AlbumData] = []
        Database.database().reference().child("Music Content").child("Albums").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                if data.key != "All Album IDs" {
                    print("albdkey \(data.key)")
                    var youtubeAlts:[String] = []
                    let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                    for sub in data.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        //print(up.key)
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = up.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Main Artist"] as! Array<String>)
                            temp.append(dvalue["All Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Number Of Tracks"] as! Int)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            if let tval = (dvalue["All Artist"]) as? [String] {
                                album.allArtists = tval
                            }
                            if let tval = (dvalue["All Writers"]) as? [String] {
                                album.writers = tval
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mix Engineer"]) as? [String] {
                                    album.mixEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mastering Engineer"]) as? [String] {
                                    album.masteringEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Recording Engineer"]) as? [String] {
                                    album.recordingEngineers = tval
                                }
                            }
                            if let merchandise = (dvalue["Merch"]) {
                                album.merch = (merchandise as! [String])
                            }
                            if let tval = (dvalue["Songs"]) as? [String] {
                                album.songs = tval
                            }
                            if let tval = (dvalue["Instrumentals"]) as? [String] {
                                album.instrumentals = tval
                            }
                            if let tval = (dvalue["Videos"]) as? [String] {
                                album.videos = tval
                            }
                            if let tval = (dvalue["Tracks"]) as? [String:String] {
                                album.tracks = tval
                            }
                            if let tval = (dvalue["Manual Image URL"]) as? String {
                                album.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"]) as? String {
                                album.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                album.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                album.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Deluxes"] as? [String]) {
                                album.deluxes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                album.otherVersions = tval
                            }
                            if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                                let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                album.isDeluxe = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                album.isOtherVersion = deluxe
                            }
                            
                            
                            
                            album.name = temp[0] as! String
                            album.mainArtist = temp[1] as! Array<String>
                            album.producers = temp[2] as! Array<String>
                            album.favoritesOverall = temp[3] as! Int
                            album.toneDeafAppId = temp[4] as! String
                            album.numberofTracks = temp[5] as! Int
                            album.timeRegisteredToApp = temp[6] as! String
                            album.dateRegisteredToApp = temp[7] as! String
                            album.isActive = temp[8] as! Bool
                        }
                        if dkey.contains("APPL") == true {
                            let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            appleData.name = temp[0] as! String
                            appleData.artist = temp[1] as! String
                            appleData.dateReleasedApple = temp[2] as! String
                            appleData.timeIA = temp[3] as! String
                            appleData.dateIA = temp[4] as! String
                            appleData.imageURL = temp[5] as! String
                            appleData.url = temp[6] as! String
                            //appleData. = temp[6] as! Int
                            appleData.trackCount = temp[7] as! Int
                            appleData.appleId = temp[8] as! String
                            appleData.isActive = temp[9] as! Bool
                            
                            album.apple = appleData
                        }
                        if dkey.contains("SPTY") == true {
                            let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! [[String:String]])
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Album URI"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            
                            spotifyData.name = temp[0] as! String
                            spotifyData.artist = temp[1] as! [[String:String]]
                            spotifyData.upc = temp[2] as! String
                            spotifyData.dateReleasedSpotify = temp[3] as! String
                            spotifyData.timeIA = temp[4] as! String
                            spotifyData.dateIA = temp[5] as! String
                            spotifyData.imageURL = temp[6] as! String
                            spotifyData.url = temp[7] as! String
                            spotifyData.uri = temp[8] as! String
                            //spotifyData. = temp[10] as! Bool
                            spotifyData.trackNumberTotal = temp[9] as! Int
                            spotifyData.spotifyId = temp[10] as! String
                            
                            album.spotify = spotifyData
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            album.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            youtubeMusic.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            amazon.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String:Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String:Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.upc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.timeIA = temp[7] as! String
                            deezer.deezerID = temp[8] as! Int
                            deezer.dateIA = temp[9] as! String
                            
                            album.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            spinrilla.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            album.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            napster.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            tidal.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in up.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        album.officialAlbumVideo = temp[0] as! String
                                    }
                                }
                        }
                    }
                    contentFeaturedArray.append(album)
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllBeatsFromDatabase(completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
        Database.database().reference().child("Beats").observeSingleEvent(of: .value, with: { snapshot in
            for ry in snapshot.children {
                let cat = ry as! DataSnapshot
                let catkey = cat.key
                    if !catkey.contains("IDs") {
                        var temp:Array<Any> = []
                        let value = cat.value as! [String:Any]
                        var typeArray:[String] = []
                        var soundArray:[String] = []
                        var time:String!
                        var date:String!
                        if let tval = value["Duration"] as? String {
                            beat.duration = tval
                        }
                        if let tval = value["Name"] as? String {
                            beat.name = tval
                        }
                        if let tval = value["Date"] as? String {
                            beat.date = tval
                            date = tval
                        }
                        if let tval = value["Number of Downloads"] as? Int {
                            beat.downloads = tval
                        }
                        if let tval = value["Wav Price"] as? Double {
                            beat.wavPrice = tval
                        }
                        if let tval = value["Lease Price"] as? Double {
                            beat.mp3Price = tval
                        }
                        if let tval = value["Exclusive Price"] as? Double {
                            beat.exclusivePrice = tval
                        }
                        if let tval = value["Time"] as? String {
                            beat.time = tval
                            time = tval
                        }
                        if let tval = value["Types"] as? [String] {
                            beat.types = tval
                        }
                        if let tval = value["Sounds"] as? [String] {
                            beat.sounds = tval
                        }
                        if let tval = value["Tempo"] as? Int {
                            beat.tempo = tval
                        }
                        if let tval = value["Audio"] as? String {
                            beat.audioURL = tval
                        }
                        if let tval = value["Image"] as? String {
                            beat.imageURL = tval
                        }
                        if let tval = value["beatId"] as? String {
                            beat.beatID = tval
                        }
                        if let tval = value["Price Type"] as? String {
                            beat.priceType = tval
                        }
                        if let tval = value["Producers"] as? [String] {
                            beat.producers = tval
                        }
                        if let tval = value["Tone Deaf App Id"] as? String {
                            beat.toneDeafAppId = tval
                        }
                        if let tval = value["Exclusive Files URL"] as? String {
                            beat.exclusiveFilesURL = tval
                        }
                        if let tval = value["Wav URL"] as? String {
                            beat.wavURL = tval
                        }
                        if let tval = value["Official Video"] as? String {
                            beat.officialVideo = tval
                        }
                        if let tval = value["Videos"] as? [String] {
                            beat.videos = tval
                        }
                        if let tval = value["Key"] as? String {
                            beat.key = tval
                        }
                        if let tval = value["Active Status"] as? Bool {
                            beat.isActive = tval
                        }
                        if let merchandise = (value["Merch"] as? [String]) {
                            beat.merch = (merchandise)
                        }
                        beat.datetime = "\(date)\(time)"
                        let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        for kiddo in cat.children {
                            let dada = kiddo as! DataSnapshot
                            if dada.key.contains(soundcloudMusicContentType) == true {
                                var temp:Array<Any> = []
                                let dvalue = dada.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                soundcloud.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                beat.soundcloud = soundcloud
                            }
                        }
                        contentFeaturedArray.append(beat)
                        
                    }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllVideosFromDatabase(completion: @escaping (([VideoData]) -> Void)) {
        var contentFeaturedArray:[VideoData] = []
        Database.database().reference().child("Music Content").child("Videos").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            var tick = 0
            for child in snapshot.children {
                let video = VideoData(title: "", toneDeafAppId: "", persons: nil, videographers: nil, albums: nil, instrumentals: nil, merch: nil, songs: nil, beats: nil, favorites: 0, type: "", timeIA: "", dateIA: "", viewsIA: 0, manualThumbnailURL: nil, isActive: false, youtube: nil, igtv: nil, instagramPost: nil, facebookPost: nil, worldstar: nil, twitter: nil, appleMusic: nil, tikTok: nil, industryCerified: nil, verificationLevel: nil)
                let bdata = child as! DataSnapshot
                let akey = bdata.key
                tick += 1
                if akey != "All Video IDs" {
                    for chi in bdata.children {
                        let data = chi as! DataSnapshot
                        let key = data.key
                        if key == "Active Status" {
                            video.isActive = data.value  as! Bool
                        }
                        if key == "Albums" {
                            video.albums = data.value as? [String]
                        }
                        if key == "Instrumentals" {
                            if data.value as! [String] != [""] {
                                video.instrumentals = data.value as? [String]
                            }
                        }
                        if key == "Beats" {
                            if data.value as! [String] != [""] {
                                video.beats = data.value as? [String]
                            }
                        }
                        if key == "Songs" {
                            if data.value as! [String] != [""] {
                                video.songs = data.value as? [String]
                            }
                        }
                        if key == "Persons" {
                            if data.value as! [String] != [""] {
                                video.persons = data.value as? [String]
                            }
                        }
                        if key == "Videographers" {
                            if data.value as! [String] != [""] {
                                video.videographers = data.value as? [String]
                            }
                        }
                        if key == "Date Uploaded To App" {
                            video.dateIA = data.value as! String
                        }
                        if key == "Time Uploaded To App" {
                            video.timeIA = data.value as! String
                        }
                        if key == "Number of Favorites" {
                            video.favorites = data.value as! Int
                        }
                        if key == "Views In App" {
                            video.viewsIA = data.value as! Int
                        }
                        if key == "Title" {
                            video.title = data.value as! String
                        }
                        if key == "Type" {
                            video.type = data.value as! String
                        }
                        if key == "Tone Deaf App Video Id" {
                            video.toneDeafAppId = data.value as! String
                        }
                        if key == "Manual Thumbnail URL" {
                            video.manualThumbnailURL = (data.value as! String)
                        }
                        if key == "Industry Certified" {
                            
                            video.industryCerified = (data.value as? Bool)
                        }
                        if key == "Verification Level" {
                            video.verificationLevel = Character(data.value as! String)
                        }
                        
                        if key == "Youtube" {
                            for shi in data.children {
                                let odata = shi as! DataSnapshot
                                let okey = odata.key
                                
                                if okey.contains("YT") == true && !okey.contains("YTPL")  {
                                    if video.youtube == nil {
                                        video.youtube = []
                                    }
                                    let avideo = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Channel Title"] as! String)
                                    temp.append(ovalue["Duration"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                    temp.append(ovalue["Description"] as! String)
                                    temp.append(ovalue["Thumbnail URL"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                    temp.append(ovalue["Title"] as! String)
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(avalue["Views In App"] as! Int)
                                    temp.append(ovalue["Views on Youtube"] as! Int)
                                    temp.append(ovalue["Youtube Id"] as! String)
                                    temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                    temp.append(ovalue["Type"] as! String)
                                    
                                    avideo.channelTitle = temp[0] as! String
                                    avideo.duration = temp[1] as! String
                                    avideo.dateIA = temp[2] as! String
                                    avideo.dateYT = temp[3] as! String
                                    avideo.description = temp[4] as! String
                                    //                        video.favorites = temp[5] as! Int
                                    avideo.thumbnailURL = temp[5] as! String
                                    avideo.timeIA = temp[6] as! String
                                    avideo.timeYT = temp[7] as! String
                                    avideo.title = temp[8] as! String
                                    avideo.url = temp[9] as! String
                                    avideo.viewsIA = temp[10] as! Int
                                    avideo.viewsYT = temp[11] as! Int
                                    avideo.youtubeId = temp[12] as! String
                                    avideo.toneDeafAppId = temp[13] as! String
                                    avideo.type = temp[14] as! String
                                    video.youtube!.append(avideo)
                                    
                                    
                                }
                                
                                if okey.contains("YTPL") == true {
                                    if video.youtube == nil {
                                        video.youtube = []
                                    }
                                    let avideo = YouTubeData(duration: nil, url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Channel Title"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                    temp.append(ovalue["Description"] as! String)
                                    temp.append(ovalue["Thumbnail URL"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                    temp.append(ovalue["Title"] as! String)
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(avalue["Views In App"] as! Int)
                                    temp.append(ovalue["Youtube Id"] as! String)
                                    temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                    temp.append(ovalue["Type"] as! String)
                                    
                                    avideo.channelTitle = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.dateYT = temp[2] as! String
                                    avideo.description = temp[3] as! String
                                    avideo.thumbnailURL = temp[4] as! String
                                    avideo.timeIA = temp[5] as! String
                                    avideo.timeYT = temp[6] as! String
                                    avideo.title = temp[7] as! String
                                    avideo.url = temp[8] as! String
                                    avideo.viewsIA = temp[9] as! Int
                                    avideo.youtubeId = temp[10] as! String
                                    avideo.toneDeafAppId = temp[11] as! String
                                    avideo.type = temp[12] as! String
                                    video.youtube!.append(avideo)
                                }
                            }
                        }
                        
                        if key == "Twitter" {
                            for shi in data.children {
                                let odata = shi as! DataSnapshot
                                let okey = odata.key
                                if video.twitter == nil {
                                    video.twitter = []
                                }
                                let avideo = TwitterTweetData(url: "", media: nil, twitterId: "", text: nil, dateTwitter: "", dateIA: "", timeIA: "", viewsIA: 0, isActive: false)
                                //print(key)
                                
                                var temp:Array<Any> = []
                                let avalue = bdata.value as! [String:Any]
                                let ovalue = odata.value as! [String:Any]
                                temp.append(ovalue["Video URL"] as! String)
                                temp.append(ovalue["Twitter Id"] as! String)
                                temp.append(ovalue["Text"] as? String)
                                temp.append(ovalue["Date Uploaded To App"] as! String)
                                temp.append(ovalue["Date Uploaded To Twitter"] as! String)
                                temp.append(ovalue["Time Uploaded To App"] as! String)
                                temp.append(ovalue["Views In App"] as! Int)
                                temp.append(ovalue["Active Status"] as! Bool)
                                
                                if let med = ovalue["Media"] as? [NSDictionary] {
                                    var medArr:[MediaDataForTwitter] = []
                                    for puppy in med {
                                        let tMed = MediaDataForTwitter(url: nil, mediaKey: nil, previewURL: nil, type: nil, contentType: nil)
                                        if let valval = puppy["Preview URL"] as? String {
                                            tMed.previewURL = valval
                                        }
                                        if let valval = puppy["Media Key"] as? String {
                                            tMed.mediaKey = valval
                                        }
                                        if let valval = puppy["Type"] as? String {
                                            tMed.type = valval
                                        }
                                        medArr.append(tMed)
                                    }
                                    avideo.media = medArr
                                }
                                
                                avideo.url = temp[0] as! String
                                avideo.twitterId = temp[1] as! String
                                avideo.text = temp[2] as? String
                                avideo.dateIA = temp[3] as! String
                                avideo.dateTwitter = temp[4] as! String
                                avideo.timeIA = temp[5] as! String
                                avideo.viewsIA = temp[6] as! Int
                                avideo.isActive = temp[7] as! Bool
                                
                                
                                
                                video.twitter!.append(avideo)
                                
                            }
                        }
                        
                    }
                    contentFeaturedArray.append(video)
                }
            }
            completion(contentFeaturedArray)
        })
    }
    
    
    
    
    
    func fetchAllPersonsFromDatabase(page: Int, completion: @escaping (([PersonData]) -> Void)) {
        var contentFeaturedArray:[PersonData] = []
        
        Database.database().reference().child("Registered Persons").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let perso = PersonData(name: "", legalName: nil, toneDeafAppId: "", mainRole: "", roles: nil, songs: nil, videos: nil, beats: nil, instrumentals: nil, albums: nil, merch: nil, alternateNames: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, youtube: nil, instagram: nil, twitter: nil, facebook: nil, tikTok: nil, manualImageURL: nil,followers: 0, industryCerified: false, verificationLevel: nil, isActive: nil)
                let up = child as! DataSnapshot
                let key = up.key
                
                if key != "All Person IDs" {
                var temp:Array<Any> = []
                let dvalue = up.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Main Role"] as! String)
                    temp.append(dvalue["Active Status"] as! Bool)
                    if let tval = dvalue["Alternate Names"] as? [String] {
                        perso.alternateNames = tval
                    }
                    if let tval = dvalue["Linked To Account"] as? String {
                        perso.linkedToAccount = tval
                    }
                    if let tval = dvalue["Songs"] as? [String] {
                        perso.songs = tval.sorted()
                    }
                    if let tval = dvalue["Albums"] as? [String] {
                        perso.albums = tval.sorted()
                    }
                    if let tval = dvalue["Beats"] as? [String] {
                        perso.beats = tval.sorted()
                    }
                    if let tval = dvalue["Videos"] as? [String] {
                        perso.videos = tval.sorted()
                    }
                    if let tval = dvalue["Instrumentals"] as? [String] {
                        perso.instrumentals = tval.sorted()
                    }
                    if let merchandise = (dvalue["Merch"]) {
                        perso.merch = (merchandise as! [String]).sorted()
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        perso.legalName = (lname as! String)
                    }
                    if let rolesarr = (dvalue["Roles"]) {
                        perso.roles = (rolesarr as! NSMutableDictionary)
                    }
                    if let tval = dvalue["Manual Image URL"] as? String {
                        perso.manualImageURL = tval
                    }
                    if let data = dvalue["Apple Music"] as? NSDictionary {
                        let togo = AppleMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, allAlbumIDs: nil)
                        if let aaid = data["All Album IDs"] as? [String] {
                            togo.allAlbumIDs = aaid
                        }
                        perso.apple = togo
                    }
                    if let data = dvalue["Spotify"] as? NSDictionary {
                        let togo = SpotifyPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.spotify = togo
                    }
                    if let data = dvalue["Soundcloud"] as? NSDictionary {
                        let togo = SoundcloudPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.soundcloud = togo
                    }
                    if let data = dvalue["Youtube Music"] as? NSDictionary {
                        let togo = YoutubeMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtubeMusic = togo
                    }
                    if let data = dvalue["Amazon Music"] as? NSDictionary {
                        let togo = AmazonPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.amazon = togo
                    }
                    if let data = dvalue["Deezer"] as? NSDictionary {
                        let togo = DeezerPersonData(url: data["URL"] as! String, profileImageURL: data["Profile Image URL"] as! String, id: data["id"] as! String, name: data["Name"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.deezer = togo
                    }
                    if let data = dvalue["Spinrilla"] as? NSDictionary {
                        let togo = SpinrillaPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.spinrilla = togo
                    }
                    if let data = dvalue["Napster"] as? NSDictionary {
                        let togo = NapsterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.napster = togo
                    }
                    if let data = dvalue["Tidal"] as? NSDictionary {
                        let togo = TidalPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tidal = togo
                    }
                    if let data = dvalue["Youtube"] as? NSDictionary {
                        let togo = YoutubePersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtube = togo
                    }
                    if let data = dvalue["Instagram"] as? NSDictionary {
                        let togo = InstagramPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.instagram = togo
                    }
                    if let data = dvalue["Twitter"] as? NSDictionary {
                        let togo = TwitterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, dateCreated: data["Date Created"] as! String, name: data["Name"] as! String, userName: data["Username"] as! String, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.twitter = togo
                    }
                    if let data = dvalue["Facebook"] as? NSDictionary {
                        let togo = FacebookPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.facebook = togo
                    }
                    if let data = dvalue["TikTok"] as? NSDictionary {
                        let togo = TikTokPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tikTok = togo
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        perso.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        perso.verificationLevel = Character(tval)
                    }
                    
                    perso.name = temp[0] as! String
                    perso.dateRegisteredToApp = temp[1] as! String
                    perso.timeRegisteredToApp = temp[2] as! String
                    perso.followers = temp[3] as! Int
                    perso.toneDeafAppId = (temp[4] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                    perso.mainRole = temp[5] as! String
                    perso.isActive = temp[6] as! Bool
                    contentFeaturedArray.append(perso)
                }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllPersonsFromDatabase(page: Int, exceptions: [PersonData], completion: @escaping (([PersonData]) -> Void)) {
        var contentFeaturedArray:[PersonData] = []
        Database.database().reference().child("Registered Persons").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            for child in snapshot.children {
                let up = child as! DataSnapshot
                let key = up.key
                if key != "All Person IDs" {
                    let split = up.key.components(separatedBy: "--")
                    //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                    if !(cepArr.contains(String("\(split[3])"))) {
                        let perso = PersonData(name: "", legalName: nil, toneDeafAppId: "", mainRole: "", roles: nil, songs: nil, videos: nil, beats: nil, instrumentals: nil, albums: nil, merch: nil, alternateNames: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, youtube: nil, instagram: nil, twitter: nil, facebook: nil, tikTok: nil, manualImageURL: nil,followers: 0, industryCerified: false, verificationLevel: nil, isActive: nil)
                        var temp:Array<Any> = []
                        let dvalue = up.value as! [String:Any]
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Date Registered To App"] as! String)
                        temp.append(dvalue["Time Registered To App"] as! String)
                        temp.append(dvalue["Followers"] as! Int)
                        temp.append(dvalue["Tone Deaf App Id"] as! String)
                        temp.append(dvalue["Main Role"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        if let tval = dvalue["Alternate Names"] as? [String] {
                            perso.alternateNames = tval
                        }
                        if let tval = dvalue["Linked To Account"] as? String {
                            perso.linkedToAccount = tval
                        }
                        if let tval = dvalue["Songs"] as? [String] {
                            perso.songs = tval.sorted()
                        }
                        if let tval = dvalue["Albums"] as? [String] {
                            perso.albums = tval.sorted()
                        }
                        if let tval = dvalue["Beats"] as? [String] {
                            perso.beats = tval.sorted()
                        }
                        if let tval = dvalue["Videos"] as? [String] {
                            perso.videos = tval.sorted()
                        }
                        if let tval = dvalue["Instrumentals"] as? [String] {
                            perso.instrumentals = tval.sorted()
                        }
                        if let merchandise = (dvalue["Merch"]) {
                            perso.merch = (merchandise as! [String]).sorted()
                        }
                        if let lname = (dvalue["Legal Name"]) {
                            perso.legalName = (lname as! String)
                        }
                        if let rolesarr = (dvalue["Roles"]) {
                            perso.roles = (rolesarr as! NSMutableDictionary)
                        }
                        if let tval = dvalue["Manual Image URL"] as? String {
                            perso.manualImageURL = tval
                        }
                        if let data = dvalue["Apple Music"] as? NSDictionary {
                            let togo = AppleMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, allAlbumIDs: nil)
                            if let aaid = data["All Album IDs"] as? [String] {
                                togo.allAlbumIDs = aaid
                            }
                            perso.apple = togo
                        }
                        if let data = dvalue["Spotify"] as? NSDictionary {
                            let togo = SpotifyPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                            perso.spotify = togo
                        }
                        if let data = dvalue["Soundcloud"] as? NSDictionary {
                            let togo = SoundcloudPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.soundcloud = togo
                        }
                        if let data = dvalue["Youtube Music"] as? NSDictionary {
                            let togo = YoutubeMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.youtubeMusic = togo
                        }
                        if let data = dvalue["Amazon Music"] as? NSDictionary {
                            let togo = AmazonPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.amazon = togo
                        }
                        if let data = dvalue["Deezer"] as? NSDictionary {
                            let togo = DeezerPersonData(url: data["URL"] as! String, profileImageURL: data["Profile Image URL"] as! String, id: data["id"] as! String, name: data["Name"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.deezer = togo
                        }
                        if let data = dvalue["Spinrilla"] as? NSDictionary {
                            let togo = SpinrillaPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.spinrilla = togo
                        }
                        if let data = dvalue["Napster"] as? NSDictionary {
                            let togo = NapsterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.napster = togo
                        }
                        if let data = dvalue["Tidal"] as? NSDictionary {
                            let togo = TidalPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.tidal = togo
                        }
                        if let data = dvalue["Youtube"] as? NSDictionary {
                            let togo = YoutubePersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.youtube = togo
                        }
                        if let data = dvalue["Instagram"] as? NSDictionary {
                            let togo = InstagramPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.instagram = togo
                        }
                        if let data = dvalue["Twitter"] as? NSDictionary {
                            let togo = TwitterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, dateCreated: data["Date Created"] as! String, name: data["Name"] as! String, userName: data["Username"] as! String, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                            perso.twitter = togo
                        }
                        if let data = dvalue["Facebook"] as? NSDictionary {
                            let togo = FacebookPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.facebook = togo
                        }
                        if let data = dvalue["TikTok"] as? NSDictionary {
                            let togo = TikTokPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                            perso.tikTok = togo
                        }
                        if let tval = (dvalue["Industry Certified"] as? Bool) {
                            perso.industryCerified = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            perso.verificationLevel = Character(tval)
                        }
                        
                        perso.name = temp[0] as! String
                        perso.dateRegisteredToApp = temp[1] as! String
                        perso.timeRegisteredToApp = temp[2] as! String
                        perso.followers = temp[3] as! Int
                        perso.toneDeafAppId = (temp[4] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                        perso.mainRole = temp[5] as! String
                        perso.isActive = temp[6] as! Bool
                        
                        contentFeaturedArray.append(perso)
                    }
                }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllPersonsFromDatabase(page: Int, end:String, completion: @escaping (([PersonData]) -> Void)) {
        var contentFeaturedArray:[PersonData] = []
        Database.database().reference().child("Registered Persons").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let up = child as! DataSnapshot
                let key = up.key
                if key != "All Person IDs" {
                let perso = PersonData(name: "", legalName: nil, toneDeafAppId: "", mainRole: "", roles: nil, songs: nil, videos: nil, beats: nil, instrumentals: nil, albums: nil, merch: nil, alternateNames: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, youtube: nil, instagram: nil, twitter: nil, facebook: nil, tikTok: nil, manualImageURL: nil,followers: 0, industryCerified: false, verificationLevel: nil, isActive: nil)
                var temp:Array<Any> = []
                let dvalue = up.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Main Role"] as! String)
                    temp.append(dvalue["Active Status"] as! Bool)
                    if let tval = dvalue["Alternate Names"] as? [String] {
                        perso.alternateNames = tval
                    }
                    if let tval = dvalue["Linked To Account"] as? String {
                        perso.linkedToAccount = tval
                    }
                    if let tval = dvalue["Songs"] as? [String] {
                        perso.songs = tval.sorted()
                    }
                    if let tval = dvalue["Albums"] as? [String] {
                        perso.albums = tval.sorted()
                    }
                    if let tval = dvalue["Beats"] as? [String] {
                        perso.beats = tval.sorted()
                    }
                    if let tval = dvalue["Videos"] as? [String] {
                        perso.videos = tval.sorted()
                    }
                    if let tval = dvalue["Instrumentals"] as? [String] {
                        perso.instrumentals = tval.sorted()
                    }
                    if let merchandise = (dvalue["Merch"]) {
                        perso.merch = (merchandise as! [String]).sorted()
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        perso.legalName = (lname as! String)
                    }
                    if let rolesarr = (dvalue["Roles"]) {
                        perso.roles = (rolesarr as! NSMutableDictionary)
                    }
                    if let tval = dvalue["Manual Image URL"] as? String {
                        perso.manualImageURL = tval
                    }
                    if let data = dvalue["Apple Music"] as? NSDictionary {
                        let togo = AppleMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, allAlbumIDs: nil)
                        if let aaid = data["All Album IDs"] as? [String] {
                            togo.allAlbumIDs = aaid
                        }
                        perso.apple = togo
                    }
                    if let data = dvalue["Spotify"] as? NSDictionary {
                        let togo = SpotifyPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.spotify = togo
                    }
                    if let data = dvalue["Soundcloud"] as? NSDictionary {
                        let togo = SoundcloudPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.soundcloud = togo
                    }
                    if let data = dvalue["Youtube Music"] as? NSDictionary {
                        let togo = YoutubeMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtubeMusic = togo
                    }
                    if let data = dvalue["Amazon Music"] as? NSDictionary {
                        let togo = AmazonPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.amazon = togo
                    }
                    if let data = dvalue["Deezer"] as? NSDictionary {
                        let togo = DeezerPersonData(url: data["URL"] as! String, profileImageURL: data["Profile Image URL"] as! String, id: data["id"] as! String, name: data["Name"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.deezer = togo
                    }
                    if let data = dvalue["Spinrilla"] as? NSDictionary {
                        let togo = SpinrillaPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.spinrilla = togo
                    }
                    if let data = dvalue["Napster"] as? NSDictionary {
                        let togo = NapsterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.napster = togo
                    }
                    if let data = dvalue["Tidal"] as? NSDictionary {
                        let togo = TidalPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tidal = togo
                    }
                    if let data = dvalue["Youtube"] as? NSDictionary {
                        let togo = YoutubePersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtube = togo
                    }
                    if let data = dvalue["Instagram"] as? NSDictionary {
                        let togo = InstagramPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.instagram = togo
                    }
                    if let data = dvalue["Twitter"] as? NSDictionary {
                        let togo = TwitterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, dateCreated: data["Date Created"] as! String, name: data["Name"] as! String, userName: data["Username"] as! String, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.twitter = togo
                    }
                    if let data = dvalue["Facebook"] as? NSDictionary {
                        let togo = FacebookPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.facebook = togo
                    }
                    if let data = dvalue["TikTok"] as? NSDictionary {
                        let togo = TikTokPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tikTok = togo
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        perso.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        perso.verificationLevel = Character(tval)
                    }
                    
                    perso.name = temp[0] as! String
                    perso.dateRegisteredToApp = temp[1] as! String
                    perso.timeRegisteredToApp = temp[2] as! String
                    perso.followers = temp[3] as! Int
                    perso.toneDeafAppId = (temp[4] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                    perso.mainRole = temp[5] as! String
                    perso.isActive = temp[6] as! Bool
                
                contentFeaturedArray.append(perso)
                }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllPersonsFromDatabase(page: Int, end:String, exceptions: [PersonData], completion: @escaping (([PersonData]) -> Void)) {
        var contentFeaturedArray:[PersonData] = []
        Database.database().reference().child("Registered Persons").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            for child in snapshot.children {
                let up = child as! DataSnapshot
                let key = up.key
                if key != "All Person IDs" {
                let split = up.key.components(separatedBy: "--")
                //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                if !(cepArr.contains(String("\(split[3])"))){
                    let perso = PersonData(name: "", legalName: nil, toneDeafAppId: "", mainRole: "", roles: nil, songs: nil, videos: nil, beats: nil, instrumentals: nil, albums: nil, merch: nil, alternateNames: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, youtube: nil, instagram: nil, twitter: nil, facebook: nil, tikTok: nil, manualImageURL: nil,followers: 0, industryCerified: false, verificationLevel: nil, isActive: nil)
                    var temp:Array<Any> = []
                    let dvalue = up.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Main Role"] as! String)
                    temp.append(dvalue["Active Status"] as! Bool)
                    if let tval = dvalue["Alternate Names"] as? [String] {
                        perso.alternateNames = tval
                    }
                    if let tval = dvalue["Linked To Account"] as? String {
                        perso.linkedToAccount = tval
                    }
                    if let tval = dvalue["Songs"] as? [String] {
                        perso.songs = tval.sorted()
                    }
                    if let tval = dvalue["Albums"] as? [String] {
                        perso.albums = tval.sorted()
                    }
                    if let tval = dvalue["Beats"] as? [String] {
                        perso.beats = tval.sorted()
                    }
                    if let tval = dvalue["Videos"] as? [String] {
                        perso.videos = tval.sorted()
                    }
                    if let tval = dvalue["Instrumentals"] as? [String] {
                        perso.instrumentals = tval.sorted()
                    }
                    if let merchandise = (dvalue["Merch"]) {
                        perso.merch = (merchandise as! [String]).sorted()
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        perso.legalName = (lname as! String)
                    }
                    if let rolesarr = (dvalue["Roles"]) {
                        perso.roles = (rolesarr as! NSMutableDictionary)
                    }
                    if let tval = dvalue["Manual Image URL"] as? String {
                        perso.manualImageURL = tval
                    }
                    if let data = dvalue["Apple Music"] as? NSDictionary {
                        let togo = AppleMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, allAlbumIDs: nil)
                        if let aaid = data["All Album IDs"] as? [String] {
                            togo.allAlbumIDs = aaid
                        }
                        perso.apple = togo
                    }
                    if let data = dvalue["Spotify"] as? NSDictionary {
                        let togo = SpotifyPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.spotify = togo
                    }
                    if let data = dvalue["Soundcloud"] as? NSDictionary {
                        let togo = SoundcloudPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.soundcloud = togo
                    }
                    if let data = dvalue["Youtube Music"] as? NSDictionary {
                        let togo = YoutubeMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtubeMusic = togo
                    }
                    if let data = dvalue["Amazon Music"] as? NSDictionary {
                        let togo = AmazonPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.amazon = togo
                    }
                    if let data = dvalue["Deezer"] as? NSDictionary {
                        let togo = DeezerPersonData(url: data["URL"] as! String, profileImageURL: data["Profile Image URL"] as! String, id: data["id"] as! String, name: data["Name"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.deezer = togo
                    }
                    if let data = dvalue["Spinrilla"] as? NSDictionary {
                        let togo = SpinrillaPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.spinrilla = togo
                    }
                    if let data = dvalue["Napster"] as? NSDictionary {
                        let togo = NapsterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.napster = togo
                    }
                    if let data = dvalue["Tidal"] as? NSDictionary {
                        let togo = TidalPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tidal = togo
                    }
                    if let data = dvalue["Youtube"] as? NSDictionary {
                        let togo = YoutubePersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtube = togo
                    }
                    if let data = dvalue["Instagram"] as? NSDictionary {
                        let togo = InstagramPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.instagram = togo
                    }
                    if let data = dvalue["Twitter"] as? NSDictionary {
                        let togo = TwitterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, dateCreated: data["Date Created"] as! String, name: data["Name"] as! String, userName: data["Username"] as! String, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.twitter = togo
                    }
                    if let data = dvalue["Facebook"] as? NSDictionary {
                        let togo = FacebookPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.facebook = togo
                    }
                    if let data = dvalue["TikTok"] as? NSDictionary {
                        let togo = TikTokPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tikTok = togo
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        perso.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        perso.verificationLevel = Character(tval)
                    }
                    
                    perso.name = temp[0] as! String
                    perso.dateRegisteredToApp = temp[1] as! String
                    perso.timeRegisteredToApp = temp[2] as! String
                    perso.followers = temp[3] as! Int
                    perso.toneDeafAppId = (temp[4] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                    perso.mainRole = temp[5] as! String
                    perso.isActive = temp[6] as! Bool
                    contentFeaturedArray.append(perso)
                }
            }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    
    
    func fetchAllSongsFromDatabase(page: Int, completion: @escaping (([SongData]) -> Void)) {
        var contentFeaturedArray:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                var youtubeAlts:[String] = []
                let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                let content = child as! DataSnapshot
                let skey = content.key
                if skey != "All Song IDs" {
                for kid in content.children {
                    let sub = kid as! DataSnapshot
                    let dkey = sub.key
                    if dkey == "REQUIRED" {
                        var temp:Array<Any> = []
                        let dvalue = sub.value as! [String:Any]
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Artist"] as! Array<String>)
                        temp.append(dvalue["Producers"] as! Array<String>)
                        temp.append(dvalue["Number of Favorites Overall"] as! Int)
                        temp.append(dvalue["Tone Deaf App Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        if let engies1 = dvalue["Engineers"] as? NSDictionary {
                            if let eng = engies1["Mix Engineer"] as? Array<String> {
                                song.songMixEngineer = eng
                            }
                            if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                song.songMasteringEngineer = eng
                            }
                            if let eng = engies1["Recording Engineer"] as? Array<String> {
                                song.songRecordingEngineer = eng
                            }
                        }
                        if let merchandise = (dvalue["Merch"] as? [String]) {
                            song.merch = (merchandise)
                        }
                        if let tval = (dvalue["Instrumentals"] as? [String]) {
                            song.instrumentals = tval
                        }
                        if let tval = (dvalue["Albums"] as? [String]) {
                            song.albums = tval
                        }
                        if let tval = (dvalue["Videos"] as? [String]) {
                            song.videos = tval
                        }
                        if let tval = (dvalue["Writers"] as? [String]) {
                            song.songWriters = tval
                        }
                        if let tval = (dvalue["Manual Image URL"] as? String) {
                            song.manualImageURL = tval
                        }
                        if let tval = (dvalue["Manual Preview URL"] as? String) {
                            song.manualPreviewURL = tval
                        }
                        if let tval = (dvalue["Industry Certified"] as? Bool) {
                            song.industryCerified = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            song.verificationLevel = Character(tval)
                        }
                        if let tval = (dvalue["Explicit"] as? Bool) {
                            song.explicit = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            song.verificationLevel = Character(tval)
                        }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                        
                        song.name = temp[0] as! String
                        song.songArtist = temp[1] as! Array<String>
                        song.songProducers = temp[2] as! Array<String>
                        song.favoritesOverall = temp[3] as! Int
                        song.toneDeafAppId = temp[4] as! String
                        song.isActive = temp[5] as! Bool
                    }
                    if dkey.contains(appleMusicContentType) == true {
                        let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Date Released On Apple"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Explicity"] as! Bool)
                        temp.append(dvalue["Artist"] as! String)
                        temp.append(dvalue["Album Name"] as! String)
                        temp.append(dvalue["Track Number"] as! Int)
                        temp.append(dvalue["Apple Music Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        apple.appleName = temp[0] as! String
                        apple.appleDuration = temp[1] as! String
                        apple.appleDateIA = temp[2] as! String
                        apple.appleDateAPPL = temp[3] as! String
                        apple.applePreviewURL = temp[4] as! String
                        apple.appleISRC = temp[5] as! String
                        apple.appleFavorites = temp[6] as! Int
                        apple.appleArtworkURL = temp[7] as! String
                        apple.appleTimeIA = temp[8] as! String
                        apple.appleSongURL = temp[9] as! String
                        apple.appleExplicity = temp[10] as! Bool
                        apple.appleArtist = temp[11] as! String
                        apple.appleAlbumName = temp[12] as! String
                        apple.appleTrackNumber = temp[13] as! Int
                        apple.appleMusicId = temp[14] as! String
                        apple.isActive = temp[15] as! Bool
                        
                        song.apple = apple
                        
                    }
                    if dkey.contains(spotifyMusicContentType) == true {
                        let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Date Released On Spotify"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Explicity"] as! Bool)
                        temp.append(dvalue["Artist 1"] as! String)
                        temp.append(dvalue["Artist 1 URL"] as! String)
                        temp.append(dvalue["Artist 2"] as! String)
                        temp.append(dvalue["Artist 2 URL"] as! String)
                        temp.append(dvalue["Artist 3"] as! String)
                        temp.append(dvalue["Artist 3 URL"] as! String)
                        temp.append(dvalue["Artist 4"] as! String)
                        temp.append(dvalue["Artist 4 URL"] as! String)
                        temp.append(dvalue["Artist 5"] as! String)
                        temp.append(dvalue["Artist 5 URL"] as! String)
                        temp.append(dvalue["Artist 6"] as! String)
                        temp.append(dvalue["Artist 6 URL"] as! String)
                        temp.append(dvalue["Album Type"] as! String)
                        temp.append(dvalue["Track Number"] as! Int)
                        temp.append(dvalue["Spotify Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        spotify.spotifyName = temp[0] as! String
                        spotify.spotifyDuration = temp[1] as! String
                        spotify.spotifyDateIA = temp[2] as! String
                        spotify.spotifyDateSPT = temp[3] as! String
                        spotify.spotifyPreviewURL = temp[4] as! String
                        spotify.spotifyISRC = temp[5] as! String
                        spotify.spotifyFavorites = temp[6] as! Int
                        spotify.spotifyArtworkURL = temp[7] as! String
                        spotify.spotifyTimeIA = temp[8] as! String
                        spotify.spotifySongURL = temp[9] as! String
                        spotify.spotifyExplicity = temp[10] as! Bool
                        spotify.spotifyArtist1 = temp[11] as! String
                        spotify.spotifyArtist1URL = temp[12] as! String
                        spotify.spotifyArtist2 = temp[13] as! String
                        spotify.spotifyArtist2URL = temp[14] as! String
                        spotify.spotifyArtist3 = temp[15] as! String
                        spotify.spotifyArtist3URL = temp[16] as! String
                        spotify.spotifyArtist4 = temp[17] as! String
                        spotify.spotifyArtist4URL = temp[18] as! String
                        spotify.spotifyArtist5 = temp[19] as! String
                        spotify.spotifyArtist5URL = temp[20] as! String
                        spotify.spotifyArtist6 = temp[21] as! String
                        spotify.spotifyArtis6URL = temp[22] as! String
                        spotify.spotifyAlbumType = temp[23] as! String
                        spotify.spotifyTrackNumber = temp[24] as! Int
                        spotify.spotifyId = temp[25] as! String
                        spotify.isActive = temp[26] as! Bool
                        
                        song.spotify = spotify
                        
                    }
                    if dkey.contains(soundcloudMusicContentType) == true {
                        let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        soundcloud.url = temp[0] as! String
                        soundcloud.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Soundcloud"] != nil {
                            soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                        }
                        song.soundcloud = soundcloud
                    }
                    if dkey.contains(youtubeMusicContentType) == true {
                        let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        youtubeMusic.url = temp[0] as! String
                        youtubeMusic.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.youtubeMusic = youtubeMusic
                    }
                    if dkey.contains(amazonMusicContentType) == true {
                        let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        amazon.url = temp[0] as! String
                        amazon.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            amazon.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.amazon = amazon
                    }
                    if dkey.contains(deezerMusicContentType) == true {
                        let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Date Released On Deezer"] as! String)
                        temp.append(dvalue["Artist"] as! [[String : Any]])
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["Time Registered To App"] as! String)
                        temp.append(dvalue["Deezer Music Id"] as! Int)
                        temp.append(dvalue["Date Registered To App"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        deezer.deezerDate = temp[0] as! String
                        deezer.artist = temp[1] as! [[String : Any]]
                        deezer.imageurl = temp[2] as! String
                        deezer.duration = temp[3] as! String
                        deezer.isrc = temp[4] as! String
                        deezer.name = temp[5] as! String
                        deezer.url = temp[6] as! String
                        deezer.previewURL = temp[7] as! String
                        deezer.timeIA = temp[8] as! String
                        deezer.deezerID = temp[9] as! Int
                        deezer.dateIA = temp[10] as! String
                        deezer.isActive = temp[11] as! Bool
                        
                        song.deezer = deezer
                    }
                    if dkey.contains(spinrillaMusicContentType) == true {
                        let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        spinrilla.url = temp[0] as! String
                        spinrilla.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Spinrilla"] != nil {
                            spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                        }
                        song.spinrilla = spinrilla
                    }
                    if dkey.contains(napsterMusicContentType) == true {
                        let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        napster.url = temp[0] as! String
                        napster.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            napster.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.napster = napster
                    }
                    if dkey.contains(tidalMusicContentType) == true {
                        let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        tidal.url = temp[0] as! String
                        tidal.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            tidal.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.tidal = tidal
                    }
                    if dkey == "Videos" {
                            for diva in sub.children {
                                let lsat = diva as! DataSnapshot
                                let vidkey = lsat.key
                                if vidkey == "Official" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.officialVideo = temp[0] as! String
                                }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                                if vidkey == "Lyric" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.lyricVideo = temp[0] as! String
                                }
                            }
                    }
                    
                }
                contentFeaturedArray.append(song)
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllSongsFromDatabase(page: Int, exceptions: [String], completion: @escaping (([SongData]) -> Void)) {
        var contentFeaturedArray:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                var youtubeAlts:[String] = []
                let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                let content = child as! DataSnapshot
                let skey = content.key
                    if skey != "All Song IDs" {
                        let split = skey.components(separatedBy: "--")
                        //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                        if !(exceptions.contains(String("\(split[2])"))){
//                        print(content.key)
                            for kid in content.children {
                                let sub = kid as! DataSnapshot
                                let dkey = sub.key
                                if dkey == "REQUIRED" {
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value as! [String:Any]
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Artist"] as! Array<String>)
                                    temp.append(dvalue["Producers"] as! Array<String>)
                                    temp.append(dvalue["Number of Favorites Overall"] as! Int)
                                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                        if let eng = engies1["Mix Engineer"] as? Array<String> {
                                            song.songMixEngineer = eng
                                        }
                                        if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                            song.songMasteringEngineer = eng
                                        }
                                        if let eng = engies1["Recording Engineer"] as? Array<String> {
                                            song.songRecordingEngineer = eng
                                        }
                                    }
                                    if let merchandise = (dvalue["Merch"] as? [String]) {
                                        song.merch = (merchandise)
                                    }
                                    if let tval = (dvalue["Instrumentals"] as? [String]) {
                                        song.instrumentals = tval
                                    }
                                    if let tval = (dvalue["Albums"] as? [String]) {
                                        song.albums = tval
                                    }
                                    if let tval = (dvalue["Videos"] as? [String]) {
                                        song.videos = tval
                                    }
                                    if let tval = (dvalue["Writers"] as? [String]) {
                                        song.songWriters = tval
                                    }
                                    if let tval = (dvalue["Manual Image URL"] as? String) {
                                        song.manualImageURL = tval
                                    }
                                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                                        song.manualPreviewURL = tval
                                    }
                                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                                        song.industryCerified = tval
                                    }
                                    if let tval = (dvalue["Verification Level"] as? String) {
                                        song.verificationLevel = Character(tval)
                                    }
                                    if let tval = (dvalue["Explicit"] as? Bool) {
                                        song.explicit = tval
                                    }
                                    if let tval = (dvalue["Date Registered To App"] as? String) {
                                        song.dateRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Time Registered To App"] as? String) {
                                        song.timeRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Remixes"] as? [String]) {
                                        song.remixes = tval
                                    }
                                    if let tval = (dvalue["Other Versions"] as? [String]) {
                                        song.otherVersions = tval
                                    }
                                    if let taval = (dvalue["Remix"] as? NSDictionary) {
                                        let deluxe = SongRemixData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isRemix = deluxe
                                    }
                                    if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                        let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isOtherVersion = deluxe
                                    }
                                    
                                    song.name = temp[0] as! String
                                    song.songArtist = temp[1] as! Array<String>
                                    song.songProducers = temp[2] as! Array<String>
                                    song.favoritesOverall = temp[3] as! Int
                                    song.toneDeafAppId = temp[4] as! String
                                    song.isActive = temp[5] as! Bool
                                }
                                if dkey.contains(appleMusicContentType) == true {
                                    let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Apple"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist"] as! String)
                                    temp.append(dvalue["Album Name"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Apple Music Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    apple.appleName = temp[0] as! String
                                    apple.appleDuration = temp[1] as! String
                                    apple.appleDateIA = temp[2] as! String
                                    apple.appleDateAPPL = temp[3] as! String
                                    apple.applePreviewURL = temp[4] as! String
                                    apple.appleISRC = temp[5] as! String
                                    apple.appleFavorites = temp[6] as! Int
                                    apple.appleArtworkURL = temp[7] as! String
                                    apple.appleTimeIA = temp[8] as! String
                                    apple.appleSongURL = temp[9] as! String
                                    apple.appleExplicity = temp[10] as! Bool
                                    apple.appleArtist = temp[11] as! String
                                    apple.appleAlbumName = temp[12] as! String
                                    apple.appleTrackNumber = temp[13] as! Int
                                    apple.appleMusicId = temp[14] as! String
                                    apple.isActive = temp[15] as! Bool
                                    
                                    song.apple = apple
                                    
                                }
                                if dkey.contains(spotifyMusicContentType) == true {
                                    let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Spotify"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist 1"] as! String)
                                    temp.append(dvalue["Artist 1 URL"] as! String)
                                    temp.append(dvalue["Artist 2"] as! String)
                                    temp.append(dvalue["Artist 2 URL"] as! String)
                                    temp.append(dvalue["Artist 3"] as! String)
                                    temp.append(dvalue["Artist 3 URL"] as! String)
                                    temp.append(dvalue["Artist 4"] as! String)
                                    temp.append(dvalue["Artist 4 URL"] as! String)
                                    temp.append(dvalue["Artist 5"] as! String)
                                    temp.append(dvalue["Artist 5 URL"] as! String)
                                    temp.append(dvalue["Artist 6"] as! String)
                                    temp.append(dvalue["Artist 6 URL"] as! String)
                                    temp.append(dvalue["Album Type"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Spotify Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    spotify.spotifyName = temp[0] as! String
                                    spotify.spotifyDuration = temp[1] as! String
                                    spotify.spotifyDateIA = temp[2] as! String
                                    spotify.spotifyDateSPT = temp[3] as! String
                                    spotify.spotifyPreviewURL = temp[4] as! String
                                    spotify.spotifyISRC = temp[5] as! String
                                    spotify.spotifyFavorites = temp[6] as! Int
                                    spotify.spotifyArtworkURL = temp[7] as! String
                                    spotify.spotifyTimeIA = temp[8] as! String
                                    spotify.spotifySongURL = temp[9] as! String
                                    spotify.spotifyExplicity = temp[10] as! Bool
                                    spotify.spotifyArtist1 = temp[11] as! String
                                    spotify.spotifyArtist1URL = temp[12] as! String
                                    spotify.spotifyArtist2 = temp[13] as! String
                                    spotify.spotifyArtist2URL = temp[14] as! String
                                    spotify.spotifyArtist3 = temp[15] as! String
                                    spotify.spotifyArtist3URL = temp[16] as! String
                                    spotify.spotifyArtist4 = temp[17] as! String
                                    spotify.spotifyArtist4URL = temp[18] as! String
                                    spotify.spotifyArtist5 = temp[19] as! String
                                    spotify.spotifyArtist5URL = temp[20] as! String
                                    spotify.spotifyArtist6 = temp[21] as! String
                                    spotify.spotifyArtis6URL = temp[22] as! String
                                    spotify.spotifyAlbumType = temp[23] as! String
                                    spotify.spotifyTrackNumber = temp[24] as! Int
                                    spotify.spotifyId = temp[25] as! String
                                    spotify.isActive = temp[26] as! Bool
                                    
                                    song.spotify = spotify
                                    
                                }
                                if dkey.contains(soundcloudMusicContentType) == true {
                                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    soundcloud.url = temp[0] as! String
                                    soundcloud.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    song.soundcloud = soundcloud
                                }
                                if dkey.contains(youtubeMusicContentType) == true {
                                    let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    youtubeMusic.url = temp[0] as! String
                                    youtubeMusic.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.youtubeMusic = youtubeMusic
                                }
                                if dkey.contains(amazonMusicContentType) == true {
                                    let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    amazon.url = temp[0] as! String
                                    amazon.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.amazon = amazon
                                }
                                if dkey.contains(deezerMusicContentType) == true {
                                    let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Date Released On Deezer"] as! String)
                                    temp.append(dvalue["Artist"] as! [[String : Any]])
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Deezer Music Id"] as! Int)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    deezer.deezerDate = temp[0] as! String
                                    deezer.artist = temp[1] as! [[String : Any]]
                                    deezer.imageurl = temp[2] as! String
                                    deezer.duration = temp[3] as! String
                                    deezer.isrc = temp[4] as! String
                                    deezer.name = temp[5] as! String
                                    deezer.url = temp[6] as! String
                                    deezer.previewURL = temp[7] as! String
                                    deezer.timeIA = temp[8] as! String
                                    deezer.deezerID = temp[9] as! Int
                                    deezer.dateIA = temp[10] as! String
                                    deezer.isActive = temp[11] as! Bool
                                    
                                    song.deezer = deezer
                                }
                                if dkey.contains(spinrillaMusicContentType) == true {
                                    let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    spinrilla.url = temp[0] as! String
                                    spinrilla.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Spinrilla"] != nil {
                                        spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                    }
                                    song.spinrilla = spinrilla
                                }
                                if dkey.contains(napsterMusicContentType) == true {
                                    let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    napster.url = temp[0] as! String
                                    napster.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        napster.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.napster = napster
                                }
                                if dkey.contains(tidalMusicContentType) == true {
                                    let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    tidal.url = temp[0] as! String
                                    tidal.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.tidal = tidal
                                }
                                if dkey == "Videos" {
                                        for diva in sub.children {
                                            let lsat = diva as! DataSnapshot
                                            let vidkey = lsat.key
                                            if vidkey == "Official" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.officialVideo = temp[0] as! String
                                            }
                                            if vidkey == "Audio" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.audioVideo = temp[0] as! String
                                            }
                                        }
                                }
                                
                            }
                        
                        contentFeaturedArray.append(song)
                    }
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllSongsFromDatabase(page: Int, exceptions: [SongData], completion: @escaping (([SongData]) -> Void)) {
        var contentFeaturedArray:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            for child in snapshot.children {
                var youtubeAlts:[String] = []
                let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                let content = child as! DataSnapshot
                let skey = content.key
                    if skey != "All Song IDs" {
                        let split = skey.components(separatedBy: "--")
                        //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                        if !(cepArr.contains(String("\(split[2])"))) {
//                        print(content.key)
                            for kid in content.children {
                                let sub = kid as! DataSnapshot
                                let dkey = sub.key
                                if dkey == "REQUIRED" {
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value as! [String:Any]
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Artist"] as! Array<String>)
                                    temp.append(dvalue["Producers"] as! Array<String>)
                                    temp.append(dvalue["Number of Favorites Overall"] as! Int)
                                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                        if let eng = engies1["Mix Engineer"] as? Array<String> {
                                            song.songMixEngineer = eng
                                        }
                                        if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                            song.songMasteringEngineer = eng
                                        }
                                        if let eng = engies1["Recording Engineer"] as? Array<String> {
                                            song.songRecordingEngineer = eng
                                        }
                                    }
                                    if let merchandise = (dvalue["Merch"] as? [String]) {
                                        song.merch = (merchandise)
                                    }
                                    if let tval = (dvalue["Instrumentals"] as? [String]) {
                                        song.instrumentals = tval
                                    }
                                    if let tval = (dvalue["Albums"] as? [String]) {
                                        song.albums = tval
                                    }
                                    if let tval = (dvalue["Videos"] as? [String]) {
                                        song.videos = tval
                                    }
                                    if let tval = (dvalue["Writers"] as? [String]) {
                                        song.songWriters = tval
                                    }
                                    if let tval = (dvalue["Manual Image URL"] as? String) {
                                        song.manualImageURL = tval
                                    }
                                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                                        song.manualPreviewURL = tval
                                    }
                                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                                        song.industryCerified = tval
                                    }
                                    if let tval = (dvalue["Verification Level"] as? String) {
                                        song.verificationLevel = Character(tval)
                                    }
                                    if let tval = (dvalue["Explicit"] as? Bool) {
                                        song.explicit = tval
                                    }
                                    if let tval = (dvalue["Date Registered To App"] as? String) {
                                        song.dateRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Time Registered To App"] as? String) {
                                        song.timeRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Remixes"] as? [String]) {
                                        song.remixes = tval
                                    }
                                    if let tval = (dvalue["Other Versions"] as? [String]) {
                                        song.otherVersions = tval
                                    }
                                    if let taval = (dvalue["Remix"] as? NSDictionary) {
                                        let deluxe = SongRemixData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isRemix = deluxe
                                    }
                                    if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                        let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isOtherVersion = deluxe
                                    }
                                    
                                    song.name = temp[0] as! String
                                    song.songArtist = temp[1] as! Array<String>
                                    song.songProducers = temp[2] as! Array<String>
                                    song.favoritesOverall = temp[3] as! Int
                                    song.toneDeafAppId = temp[4] as! String
                                    song.isActive = temp[5] as! Bool
                                }
                                if dkey.contains(appleMusicContentType) == true {
                                    let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Apple"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist"] as! String)
                                    temp.append(dvalue["Album Name"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Apple Music Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    apple.appleName = temp[0] as! String
                                    apple.appleDuration = temp[1] as! String
                                    apple.appleDateIA = temp[2] as! String
                                    apple.appleDateAPPL = temp[3] as! String
                                    apple.applePreviewURL = temp[4] as! String
                                    apple.appleISRC = temp[5] as! String
                                    apple.appleFavorites = temp[6] as! Int
                                    apple.appleArtworkURL = temp[7] as! String
                                    apple.appleTimeIA = temp[8] as! String
                                    apple.appleSongURL = temp[9] as! String
                                    apple.appleExplicity = temp[10] as! Bool
                                    apple.appleArtist = temp[11] as! String
                                    apple.appleAlbumName = temp[12] as! String
                                    apple.appleTrackNumber = temp[13] as! Int
                                    apple.appleMusicId = temp[14] as! String
                                    apple.isActive = temp[15] as! Bool
                                    
                                    song.apple = apple
                                    
                                }
                                if dkey.contains(spotifyMusicContentType) == true {
                                    let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Spotify"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist 1"] as! String)
                                    temp.append(dvalue["Artist 1 URL"] as! String)
                                    temp.append(dvalue["Artist 2"] as! String)
                                    temp.append(dvalue["Artist 2 URL"] as! String)
                                    temp.append(dvalue["Artist 3"] as! String)
                                    temp.append(dvalue["Artist 3 URL"] as! String)
                                    temp.append(dvalue["Artist 4"] as! String)
                                    temp.append(dvalue["Artist 4 URL"] as! String)
                                    temp.append(dvalue["Artist 5"] as! String)
                                    temp.append(dvalue["Artist 5 URL"] as! String)
                                    temp.append(dvalue["Artist 6"] as! String)
                                    temp.append(dvalue["Artist 6 URL"] as! String)
                                    temp.append(dvalue["Album Type"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Spotify Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    spotify.spotifyName = temp[0] as! String
                                    spotify.spotifyDuration = temp[1] as! String
                                    spotify.spotifyDateIA = temp[2] as! String
                                    spotify.spotifyDateSPT = temp[3] as! String
                                    spotify.spotifyPreviewURL = temp[4] as! String
                                    spotify.spotifyISRC = temp[5] as! String
                                    spotify.spotifyFavorites = temp[6] as! Int
                                    spotify.spotifyArtworkURL = temp[7] as! String
                                    spotify.spotifyTimeIA = temp[8] as! String
                                    spotify.spotifySongURL = temp[9] as! String
                                    spotify.spotifyExplicity = temp[10] as! Bool
                                    spotify.spotifyArtist1 = temp[11] as! String
                                    spotify.spotifyArtist1URL = temp[12] as! String
                                    spotify.spotifyArtist2 = temp[13] as! String
                                    spotify.spotifyArtist2URL = temp[14] as! String
                                    spotify.spotifyArtist3 = temp[15] as! String
                                    spotify.spotifyArtist3URL = temp[16] as! String
                                    spotify.spotifyArtist4 = temp[17] as! String
                                    spotify.spotifyArtist4URL = temp[18] as! String
                                    spotify.spotifyArtist5 = temp[19] as! String
                                    spotify.spotifyArtist5URL = temp[20] as! String
                                    spotify.spotifyArtist6 = temp[21] as! String
                                    spotify.spotifyArtis6URL = temp[22] as! String
                                    spotify.spotifyAlbumType = temp[23] as! String
                                    spotify.spotifyTrackNumber = temp[24] as! Int
                                    spotify.spotifyId = temp[25] as! String
                                    spotify.isActive = temp[26] as! Bool
                                    
                                    song.spotify = spotify
                                    
                                }
                                if dkey.contains(soundcloudMusicContentType) == true {
                                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    soundcloud.url = temp[0] as! String
                                    soundcloud.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    song.soundcloud = soundcloud
                                }
                                if dkey.contains(youtubeMusicContentType) == true {
                                    let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    youtubeMusic.url = temp[0] as! String
                                    youtubeMusic.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.youtubeMusic = youtubeMusic
                                }
                                if dkey.contains(amazonMusicContentType) == true {
                                    let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    amazon.url = temp[0] as! String
                                    amazon.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.amazon = amazon
                                }
                                if dkey.contains(deezerMusicContentType) == true {
                                    let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Date Released On Deezer"] as! String)
                                    temp.append(dvalue["Artist"] as! [[String : Any]])
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["Time Registered To App"] as! String)
                                    temp.append(dvalue["Deezer Music Id"] as! Int)
                                    temp.append(dvalue["Date Registered To App"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    deezer.deezerDate = temp[0] as! String
                                    deezer.artist = temp[1] as! [[String : Any]]
                                    deezer.imageurl = temp[2] as! String
                                    deezer.duration = temp[3] as! String
                                    deezer.isrc = temp[4] as! String
                                    deezer.name = temp[5] as! String
                                    deezer.url = temp[6] as! String
                                    deezer.previewURL = temp[7] as! String
                                    deezer.timeIA = temp[8] as! String
                                    deezer.deezerID = temp[9] as! Int
                                    deezer.dateIA = temp[10] as! String
                                    deezer.isActive = temp[11] as! Bool
                                    
                                    song.deezer = deezer
                                }
                                if dkey.contains(spinrillaMusicContentType) == true {
                                    let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    spinrilla.url = temp[0] as! String
                                    spinrilla.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Spinrilla"] != nil {
                                        spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                    }
                                    song.spinrilla = spinrilla
                                }
                                if dkey.contains(napsterMusicContentType) == true {
                                    let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    napster.url = temp[0] as! String
                                    napster.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        napster.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.napster = napster
                                }
                                if dkey.contains(tidalMusicContentType) == true {
                                    let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    tidal.url = temp[0] as! String
                                    tidal.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.tidal = tidal
                                }
                                if dkey == "Videos" {
                                        for diva in sub.children {
                                            let lsat = diva as! DataSnapshot
                                            let vidkey = lsat.key
                                            if vidkey == "Official" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.officialVideo = temp[0] as! String
                                            }
                                            if vidkey == "Audio" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.audioVideo = temp[0] as! String
                                            }
                                        }
                                }
                                
                            }
                        
                        contentFeaturedArray.append(song)
                    }
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllSongsFromDatabase(page: Int, end:String, completion: @escaping (([SongData]) -> Void)) {
        var contentFeaturedArray:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                var youtubeAlts:[String] = []
                let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                let content = child as! DataSnapshot
                for kid in content.children {
                    let sub = kid as! DataSnapshot
                    let dkey = sub.key
                    if dkey == "REQUIRED" {
                        var temp:Array<Any> = []
                        let dvalue = sub.value as! [String:Any]
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Artist"] as! Array<String>)
                        temp.append(dvalue["Producers"] as! Array<String>)
                        temp.append(dvalue["Number of Favorites Overall"] as! Int)
                        temp.append(dvalue["Tone Deaf App Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        if let engies1 = dvalue["Engineers"] as? NSDictionary {
                            if let eng = engies1["Mix Engineer"] as? Array<String> {
                                song.songMixEngineer = eng
                            }
                            if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                song.songMasteringEngineer = eng
                            }
                            if let eng = engies1["Recording Engineer"] as? Array<String> {
                                song.songRecordingEngineer = eng
                            }
                        }
                        if let merchandise = (dvalue["Merch"] as? [String]) {
                            song.merch = (merchandise)
                        }
                        if let tval = (dvalue["Instrumentals"] as? [String]) {
                            song.instrumentals = tval
                        }
                        if let tval = (dvalue["Albums"] as? [String]) {
                            song.albums = tval
                        }
                        if let tval = (dvalue["Videos"] as? [String]) {
                            song.videos = tval
                        }
                        if let tval = (dvalue["Writers"] as? [String]) {
                            song.songWriters = tval
                        }
                        if let tval = (dvalue["Manual Image URL"] as? String) {
                            song.manualImageURL = tval
                        }
                        if let tval = (dvalue["Manual Preview URL"] as? String) {
                            song.manualPreviewURL = tval
                        }
                        if let tval = (dvalue["Industry Certified"] as? Bool) {
                            song.industryCerified = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            song.verificationLevel = Character(tval)
                        }
                        if let tval = (dvalue["Explicit"] as? Bool) {
                            song.explicit = tval
                        }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                        
                        song.name = temp[0] as! String
                        song.songArtist = temp[1] as! Array<String>
                        song.songProducers = temp[2] as! Array<String>
                        song.favoritesOverall = temp[3] as! Int
                        song.toneDeafAppId = temp[4] as! String
                        song.isActive = temp[5] as! Bool
                    }
                    if dkey.contains(appleMusicContentType) == true {
                        let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Date Released On Apple"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Explicity"] as! Bool)
                        temp.append(dvalue["Artist"] as! String)
                        temp.append(dvalue["Album Name"] as! String)
                        temp.append(dvalue["Track Number"] as! Int)
                        temp.append(dvalue["Apple Music Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        apple.appleName = temp[0] as! String
                        apple.appleDuration = temp[1] as! String
                        apple.appleDateIA = temp[2] as! String
                        apple.appleDateAPPL = temp[3] as! String
                        apple.applePreviewURL = temp[4] as! String
                        apple.appleISRC = temp[5] as! String
                        apple.appleFavorites = temp[6] as! Int
                        apple.appleArtworkURL = temp[7] as! String
                        apple.appleTimeIA = temp[8] as! String
                        apple.appleSongURL = temp[9] as! String
                        apple.appleExplicity = temp[10] as! Bool
                        apple.appleArtist = temp[11] as! String
                        apple.appleAlbumName = temp[12] as! String
                        apple.appleTrackNumber = temp[13] as! Int
                        apple.appleMusicId = temp[14] as! String
                        apple.isActive = temp[15] as! Bool
                        
                        song.apple = apple
                        
                    }
                    if dkey.contains(spotifyMusicContentType) == true {
                        let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Date Released On Spotify"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Explicity"] as! Bool)
                        temp.append(dvalue["Artist 1"] as! String)
                        temp.append(dvalue["Artist 1 URL"] as! String)
                        temp.append(dvalue["Artist 2"] as! String)
                        temp.append(dvalue["Artist 2 URL"] as! String)
                        temp.append(dvalue["Artist 3"] as! String)
                        temp.append(dvalue["Artist 3 URL"] as! String)
                        temp.append(dvalue["Artist 4"] as! String)
                        temp.append(dvalue["Artist 4 URL"] as! String)
                        temp.append(dvalue["Artist 5"] as! String)
                        temp.append(dvalue["Artist 5 URL"] as! String)
                        temp.append(dvalue["Artist 6"] as! String)
                        temp.append(dvalue["Artist 6 URL"] as! String)
                        temp.append(dvalue["Album Type"] as! String)
                        temp.append(dvalue["Track Number"] as! Int)
                        temp.append(dvalue["Spotify Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        spotify.spotifyName = temp[0] as! String
                        spotify.spotifyDuration = temp[1] as! String
                        spotify.spotifyDateIA = temp[2] as! String
                        spotify.spotifyDateSPT = temp[3] as! String
                        spotify.spotifyPreviewURL = temp[4] as! String
                        spotify.spotifyISRC = temp[5] as! String
                        spotify.spotifyFavorites = temp[6] as! Int
                        spotify.spotifyArtworkURL = temp[7] as! String
                        spotify.spotifyTimeIA = temp[8] as! String
                        spotify.spotifySongURL = temp[9] as! String
                        spotify.spotifyExplicity = temp[10] as! Bool
                        spotify.spotifyArtist1 = temp[11] as! String
                        spotify.spotifyArtist1URL = temp[12] as! String
                        spotify.spotifyArtist2 = temp[13] as! String
                        spotify.spotifyArtist2URL = temp[14] as! String
                        spotify.spotifyArtist3 = temp[15] as! String
                        spotify.spotifyArtist3URL = temp[16] as! String
                        spotify.spotifyArtist4 = temp[17] as! String
                        spotify.spotifyArtist4URL = temp[18] as! String
                        spotify.spotifyArtist5 = temp[19] as! String
                        spotify.spotifyArtist5URL = temp[20] as! String
                        spotify.spotifyArtist6 = temp[21] as! String
                        spotify.spotifyArtis6URL = temp[22] as! String
                        spotify.spotifyAlbumType = temp[23] as! String
                        spotify.spotifyTrackNumber = temp[24] as! Int
                        spotify.spotifyId = temp[25] as! String
                        spotify.isActive = temp[26] as! Bool
                        
                        song.spotify = spotify
                        
                    }
                    if dkey.contains(soundcloudMusicContentType) == true {
                        let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        soundcloud.url = temp[0] as! String
                        soundcloud.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Soundcloud"] != nil {
                            soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                        }
                        song.soundcloud = soundcloud
                    }
                    if dkey.contains(youtubeMusicContentType) == true {
                        let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        youtubeMusic.url = temp[0] as! String
                        youtubeMusic.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.youtubeMusic = youtubeMusic
                    }
                    if dkey.contains(amazonMusicContentType) == true {
                        let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        amazon.url = temp[0] as! String
                        amazon.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            amazon.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.amazon = amazon
                    }
                    if dkey.contains(deezerMusicContentType) == true {
                        let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Date Released On Deezer"] as! String)
                        temp.append(dvalue["Artist"] as! [[String : Any]])
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["Time Registered To App"] as! String)
                        temp.append(dvalue["Deezer Music Id"] as! Int)
                        temp.append(dvalue["Date Registered To App"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        deezer.deezerDate = temp[0] as! String
                        deezer.artist = temp[1] as! [[String : Any]]
                        deezer.imageurl = temp[2] as! String
                        deezer.duration = temp[3] as! String
                        deezer.isrc = temp[4] as! String
                        deezer.name = temp[5] as! String
                        deezer.url = temp[6] as! String
                        deezer.previewURL = temp[7] as! String
                        deezer.timeIA = temp[8] as! String
                        deezer.deezerID = temp[9] as! Int
                        deezer.dateIA = temp[10] as! String
                        deezer.isActive = temp[11] as! Bool
                        
                        song.deezer = deezer
                    }
                    if dkey.contains(spinrillaMusicContentType) == true {
                        let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        spinrilla.url = temp[0] as! String
                        spinrilla.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Spinrilla"] != nil {
                            spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                        }
                        song.spinrilla = spinrilla
                    }
                    if dkey.contains(napsterMusicContentType) == true {
                        let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        napster.url = temp[0] as! String
                        napster.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            napster.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.napster = napster
                    }
                    if dkey.contains(tidalMusicContentType) == true {
                        let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        tidal.url = temp[0] as! String
                        tidal.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            tidal.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.tidal = tidal
                    }
                    if dkey == "Videos" {
                            for diva in sub.children {
                                let lsat = diva as! DataSnapshot
                                let vidkey = lsat.key
                                if vidkey == "Official" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.officialVideo = temp[0] as! String
                                }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                                if vidkey == "Lyric" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.lyricVideo = temp[0] as! String
                                }
                            }
                    }
                    
                }
                contentFeaturedArray.append(song)
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllSongsFromDatabase(page: Int, end:String,  exceptions: [String], completion: @escaping (([SongData]) -> Void)) {
        var contentFeaturedArray:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                var youtubeAlts:[String] = []
                let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                let content = child as! DataSnapshot
                let skey = content.key
                    if skey != "All Song IDs" {
                        let split = skey.components(separatedBy: "--")
                        //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                        if !(exceptions.contains(String("\(split[2])"))){
//                        print(content.key)
                            for kid in content.children {
                                let sub = kid as! DataSnapshot
                                let dkey = sub.key
                                if dkey == "REQUIRED" {
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value as! [String:Any]
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Artist"] as! Array<String>)
                                    temp.append(dvalue["Producers"] as! Array<String>)
                                    temp.append(dvalue["Number of Favorites Overall"] as! Int)
                                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                        if let eng = engies1["Mix Engineer"] as? Array<String> {
                                            song.songMixEngineer = eng
                                        }
                                        if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                            song.songMasteringEngineer = eng
                                        }
                                        if let eng = engies1["Recording Engineer"] as? Array<String> {
                                            song.songRecordingEngineer = eng
                                        }
                                    }
                                    if let merchandise = (dvalue["Merch"] as? [String]) {
                                        song.merch = (merchandise)
                                    }
                                    if let tval = (dvalue["Instrumentals"] as? [String]) {
                                        song.instrumentals = tval
                                    }
                                    if let tval = (dvalue["Albums"] as? [String]) {
                                        song.albums = tval
                                    }
                                    if let tval = (dvalue["Videos"] as? [String]) {
                                        song.videos = tval
                                    }
                                    if let tval = (dvalue["Writers"] as? [String]) {
                                        song.songWriters = tval
                                    }
                                    if let tval = (dvalue["Manual Image URL"] as? String) {
                                        song.manualImageURL = tval
                                    }
                                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                                        song.manualPreviewURL = tval
                                    }
                                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                                        song.industryCerified = tval
                                    }
                                    if let tval = (dvalue["Verification Level"] as? String) {
                                        song.verificationLevel = Character(tval)
                                    }
                                    if let tval = (dvalue["Explicit"] as? Bool) {
                                        song.explicit = tval
                                    }
                                    if let tval = (dvalue["Date Registered To App"] as? String) {
                                        song.dateRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Time Registered To App"] as? String) {
                                        song.timeRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Remixes"] as? [String]) {
                                        song.remixes = tval
                                    }
                                    if let tval = (dvalue["Other Versions"] as? [String]) {
                                        song.otherVersions = tval
                                    }
                                    if let taval = (dvalue["Remix"] as? NSDictionary) {
                                        let deluxe = SongRemixData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isRemix = deluxe
                                    }
                                    if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                        let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isOtherVersion = deluxe
                                    }
                                    
                                    song.name = temp[0] as! String
                                    song.songArtist = temp[1] as! Array<String>
                                    song.songProducers = temp[2] as! Array<String>
                                    song.favoritesOverall = temp[3] as! Int
                                    song.toneDeafAppId = temp[4] as! String
                                    song.isActive = temp[5] as! Bool
                                }
                                if dkey.contains(appleMusicContentType) == true {
                                    let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Apple"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist"] as! String)
                                    temp.append(dvalue["Album Name"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Apple Music Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    apple.appleName = temp[0] as! String
                                    apple.appleDuration = temp[1] as! String
                                    apple.appleDateIA = temp[2] as! String
                                    apple.appleDateAPPL = temp[3] as! String
                                    apple.applePreviewURL = temp[4] as! String
                                    apple.appleISRC = temp[5] as! String
                                    apple.appleFavorites = temp[6] as! Int
                                    apple.appleArtworkURL = temp[7] as! String
                                    apple.appleTimeIA = temp[8] as! String
                                    apple.appleSongURL = temp[9] as! String
                                    apple.appleExplicity = temp[10] as! Bool
                                    apple.appleArtist = temp[11] as! String
                                    apple.appleAlbumName = temp[12] as! String
                                    apple.appleTrackNumber = temp[13] as! Int
                                    apple.appleMusicId = temp[14] as! String
                                    apple.isActive = temp[15] as! Bool
                                    
                                    song.apple = apple
                                    
                                }
                                if dkey.contains(spotifyMusicContentType) == true {
                                    let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Spotify"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist 1"] as! String)
                                    temp.append(dvalue["Artist 1 URL"] as! String)
                                    temp.append(dvalue["Artist 2"] as! String)
                                    temp.append(dvalue["Artist 2 URL"] as! String)
                                    temp.append(dvalue["Artist 3"] as! String)
                                    temp.append(dvalue["Artist 3 URL"] as! String)
                                    temp.append(dvalue["Artist 4"] as! String)
                                    temp.append(dvalue["Artist 4 URL"] as! String)
                                    temp.append(dvalue["Artist 5"] as! String)
                                    temp.append(dvalue["Artist 5 URL"] as! String)
                                    temp.append(dvalue["Artist 6"] as! String)
                                    temp.append(dvalue["Artist 6 URL"] as! String)
                                    temp.append(dvalue["Album Type"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Spotify Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    spotify.spotifyName = temp[0] as! String
                                    spotify.spotifyDuration = temp[1] as! String
                                    spotify.spotifyDateIA = temp[2] as! String
                                    spotify.spotifyDateSPT = temp[3] as! String
                                    spotify.spotifyPreviewURL = temp[4] as! String
                                    spotify.spotifyISRC = temp[5] as! String
                                    spotify.spotifyFavorites = temp[6] as! Int
                                    spotify.spotifyArtworkURL = temp[7] as! String
                                    spotify.spotifyTimeIA = temp[8] as! String
                                    spotify.spotifySongURL = temp[9] as! String
                                    spotify.spotifyExplicity = temp[10] as! Bool
                                    spotify.spotifyArtist1 = temp[11] as! String
                                    spotify.spotifyArtist1URL = temp[12] as! String
                                    spotify.spotifyArtist2 = temp[13] as! String
                                    spotify.spotifyArtist2URL = temp[14] as! String
                                    spotify.spotifyArtist3 = temp[15] as! String
                                    spotify.spotifyArtist3URL = temp[16] as! String
                                    spotify.spotifyArtist4 = temp[17] as! String
                                    spotify.spotifyArtist4URL = temp[18] as! String
                                    spotify.spotifyArtist5 = temp[19] as! String
                                    spotify.spotifyArtist5URL = temp[20] as! String
                                    spotify.spotifyArtist6 = temp[21] as! String
                                    spotify.spotifyArtis6URL = temp[22] as! String
                                    spotify.spotifyAlbumType = temp[23] as! String
                                    spotify.spotifyTrackNumber = temp[24] as! Int
                                    spotify.spotifyId = temp[25] as! String
                                    spotify.isActive = temp[26] as! Bool
                                    
                                    song.spotify = spotify
                                    
                                }
                                if dkey.contains(soundcloudMusicContentType) == true {
                                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    soundcloud.url = temp[0] as! String
                                    soundcloud.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    song.soundcloud = soundcloud
                                }
                                if dkey.contains(youtubeMusicContentType) == true {
                                    let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    youtubeMusic.url = temp[0] as! String
                                    youtubeMusic.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.youtubeMusic = youtubeMusic
                                }
                                if dkey.contains(amazonMusicContentType) == true {
                                    let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    amazon.url = temp[0] as! String
                                    amazon.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.amazon = amazon
                                }
                                if dkey.contains(deezerMusicContentType) == true {
                                    let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Date Released On Deezer"] as! String)
                                    temp.append(dvalue["Artist"] as! [[String : Any]])
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Deezer Music Id"] as! Int)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    deezer.deezerDate = temp[0] as! String
                                    deezer.artist = temp[1] as! [[String : Any]]
                                    deezer.imageurl = temp[2] as! String
                                    deezer.duration = temp[3] as! String
                                    deezer.isrc = temp[4] as! String
                                    deezer.name = temp[5] as! String
                                    deezer.url = temp[6] as! String
                                    deezer.previewURL = temp[7] as! String
                                    deezer.timeIA = temp[8] as! String
                                    deezer.deezerID = temp[9] as! Int
                                    deezer.dateIA = temp[10] as! String
                                    deezer.isActive = temp[11] as! Bool
                                    
                                    song.deezer = deezer
                                }
                                if dkey.contains(spinrillaMusicContentType) == true {
                                    let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    spinrilla.url = temp[0] as! String
                                    spinrilla.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Spinrilla"] != nil {
                                        spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                    }
                                    song.spinrilla = spinrilla
                                }
                                if dkey.contains(napsterMusicContentType) == true {
                                    let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    napster.url = temp[0] as! String
                                    napster.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        napster.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.napster = napster
                                }
                                if dkey.contains(tidalMusicContentType) == true {
                                    let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    tidal.url = temp[0] as! String
                                    tidal.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.tidal = tidal
                                }
                                if dkey == "Videos" {
                                        for diva in sub.children {
                                            let lsat = diva as! DataSnapshot
                                            let vidkey = lsat.key
                                            if vidkey == "Official" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.officialVideo = temp[0] as! String
                                            }
                                            if vidkey == "Audio" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.audioVideo = temp[0] as! String
                                            }
                                            if vidkey == "Lyric" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.lyricVideo = temp[0] as! String
                                            }
                                        }
                                }
                                
                            }
                contentFeaturedArray.append(song)
                        }
                    }
                    
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllSongsFromDatabase(page: Int, end:String,  exceptions: [SongData], completion: @escaping (([SongData]) -> Void)) {
        var contentFeaturedArray:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            for child in snapshot.children {
                var youtubeAlts:[String] = []
                
                let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                let content = child as! DataSnapshot
                let skey = content.key
                    if skey != "All Song IDs" {
                        let split = skey.components(separatedBy: "--")
                        //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                        if !(cepArr.contains(String("\(split[2])"))){
//                        print(content.key)
                            for kid in content.children {
                                let sub = kid as! DataSnapshot
                                let dkey = sub.key
                                if dkey == "REQUIRED" {
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value as! [String:Any]
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Artist"] as! Array<String>)
                                    temp.append(dvalue["Producers"] as! Array<String>)
                                    temp.append(dvalue["Number of Favorites Overall"] as! Int)
                                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                        if let eng = engies1["Mix Engineer"] as? Array<String> {
                                            song.songMixEngineer = eng
                                        }
                                        if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                            song.songMasteringEngineer = eng
                                        }
                                        if let eng = engies1["Recording Engineer"] as? Array<String> {
                                            song.songRecordingEngineer = eng
                                        }
                                    }
                                    if let merchandise = (dvalue["Merch"] as? [String]) {
                                        song.merch = (merchandise)
                                    }
                                    if let tval = (dvalue["Instrumentals"] as? [String]) {
                                        song.instrumentals = tval
                                    }
                                    if let tval = (dvalue["Albums"] as? [String]) {
                                        song.albums = tval
                                    }
                                    if let tval = (dvalue["Videos"] as? [String]) {
                                        song.videos = tval
                                    }
                                    if let tval = (dvalue["Writers"] as? [String]) {
                                        song.songWriters = tval
                                    }
                                    if let tval = (dvalue["Manual Image URL"] as? String) {
                                        song.manualImageURL = tval
                                    }
                                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                                        song.manualPreviewURL = tval
                                    }
                                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                                        song.industryCerified = tval
                                    }
                                    if let tval = (dvalue["Verification Level"] as? String) {
                                        song.verificationLevel = Character(tval)
                                    }
                                    if let tval = (dvalue["Explicit"] as? Bool) {
                                        song.explicit = tval
                                    }
                                    if let tval = (dvalue["Date Registered To App"] as? String) {
                                        song.dateRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Time Registered To App"] as? String) {
                                        song.timeRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Remixes"] as? [String]) {
                                        song.remixes = tval
                                    }
                                    if let tval = (dvalue["Other Versions"] as? [String]) {
                                        song.otherVersions = tval
                                    }
                                    if let taval = (dvalue["Remix"] as? NSDictionary) {
                                        let deluxe = SongRemixData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isRemix = deluxe
                                    }
                                    if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                        let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isOtherVersion = deluxe
                                    }
                                    
                                    song.name = temp[0] as! String
                                    song.songArtist = temp[1] as! Array<String>
                                    song.songProducers = temp[2] as! Array<String>
                                    song.favoritesOverall = temp[3] as! Int
                                    song.toneDeafAppId = temp[4] as! String
                                    song.isActive = temp[5] as! Bool
                                }
                                if dkey.contains(appleMusicContentType) == true {
                                    let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Apple"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist"] as! String)
                                    temp.append(dvalue["Album Name"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Apple Music Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    apple.appleName = temp[0] as! String
                                    apple.appleDuration = temp[1] as! String
                                    apple.appleDateIA = temp[2] as! String
                                    apple.appleDateAPPL = temp[3] as! String
                                    apple.applePreviewURL = temp[4] as! String
                                    apple.appleISRC = temp[5] as! String
                                    apple.appleFavorites = temp[6] as! Int
                                    apple.appleArtworkURL = temp[7] as! String
                                    apple.appleTimeIA = temp[8] as! String
                                    apple.appleSongURL = temp[9] as! String
                                    apple.appleExplicity = temp[10] as! Bool
                                    apple.appleArtist = temp[11] as! String
                                    apple.appleAlbumName = temp[12] as! String
                                    apple.appleTrackNumber = temp[13] as! Int
                                    apple.appleMusicId = temp[14] as! String
                                    apple.isActive = temp[15] as! Bool
                                    
                                    song.apple = apple
                                    
                                }
                                if dkey.contains(spotifyMusicContentType) == true {
                                    let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Spotify"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist 1"] as! String)
                                    temp.append(dvalue["Artist 1 URL"] as! String)
                                    temp.append(dvalue["Artist 2"] as! String)
                                    temp.append(dvalue["Artist 2 URL"] as! String)
                                    temp.append(dvalue["Artist 3"] as! String)
                                    temp.append(dvalue["Artist 3 URL"] as! String)
                                    temp.append(dvalue["Artist 4"] as! String)
                                    temp.append(dvalue["Artist 4 URL"] as! String)
                                    temp.append(dvalue["Artist 5"] as! String)
                                    temp.append(dvalue["Artist 5 URL"] as! String)
                                    temp.append(dvalue["Artist 6"] as! String)
                                    temp.append(dvalue["Artist 6 URL"] as! String)
                                    temp.append(dvalue["Album Type"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Spotify Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    spotify.spotifyName = temp[0] as! String
                                    spotify.spotifyDuration = temp[1] as! String
                                    spotify.spotifyDateIA = temp[2] as! String
                                    spotify.spotifyDateSPT = temp[3] as! String
                                    spotify.spotifyPreviewURL = temp[4] as! String
                                    spotify.spotifyISRC = temp[5] as! String
                                    spotify.spotifyFavorites = temp[6] as! Int
                                    spotify.spotifyArtworkURL = temp[7] as! String
                                    spotify.spotifyTimeIA = temp[8] as! String
                                    spotify.spotifySongURL = temp[9] as! String
                                    spotify.spotifyExplicity = temp[10] as! Bool
                                    spotify.spotifyArtist1 = temp[11] as! String
                                    spotify.spotifyArtist1URL = temp[12] as! String
                                    spotify.spotifyArtist2 = temp[13] as! String
                                    spotify.spotifyArtist2URL = temp[14] as! String
                                    spotify.spotifyArtist3 = temp[15] as! String
                                    spotify.spotifyArtist3URL = temp[16] as! String
                                    spotify.spotifyArtist4 = temp[17] as! String
                                    spotify.spotifyArtist4URL = temp[18] as! String
                                    spotify.spotifyArtist5 = temp[19] as! String
                                    spotify.spotifyArtist5URL = temp[20] as! String
                                    spotify.spotifyArtist6 = temp[21] as! String
                                    spotify.spotifyArtis6URL = temp[22] as! String
                                    spotify.spotifyAlbumType = temp[23] as! String
                                    spotify.spotifyTrackNumber = temp[24] as! Int
                                    spotify.spotifyId = temp[25] as! String
                                    spotify.isActive = temp[26] as! Bool
                                    
                                    song.spotify = spotify
                                    
                                }
                                if dkey.contains(soundcloudMusicContentType) == true {
                                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    soundcloud.url = temp[0] as! String
                                    soundcloud.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    song.soundcloud = soundcloud
                                }
                                if dkey.contains(youtubeMusicContentType) == true {
                                    let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    youtubeMusic.url = temp[0] as! String
                                    youtubeMusic.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.youtubeMusic = youtubeMusic
                                }
                                if dkey.contains(amazonMusicContentType) == true {
                                    let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    amazon.url = temp[0] as! String
                                    amazon.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.amazon = amazon
                                }
                                if dkey.contains(deezerMusicContentType) == true {
                                    let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Date Released On Deezer"] as! String)
                                    temp.append(dvalue["Artist"] as! [[String : Any]])
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["Time Registered To App"] as! String)
                                    temp.append(dvalue["Deezer Music Id"] as! Int)
                                    temp.append(dvalue["Date Registered To App"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    deezer.deezerDate = temp[0] as! String
                                    deezer.artist = temp[1] as! [[String : Any]]
                                    deezer.imageurl = temp[2] as! String
                                    deezer.duration = temp[3] as! String
                                    deezer.isrc = temp[4] as! String
                                    deezer.name = temp[5] as! String
                                    deezer.url = temp[6] as! String
                                    deezer.previewURL = temp[7] as! String
                                    deezer.timeIA = temp[8] as! String
                                    deezer.deezerID = temp[9] as! Int
                                    deezer.dateIA = temp[10] as! String
                                    deezer.isActive = temp[11] as! Bool
                                    
                                    song.deezer = deezer
                                }
                                if dkey.contains(spinrillaMusicContentType) == true {
                                    let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    spinrilla.url = temp[0] as! String
                                    spinrilla.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Spinrilla"] != nil {
                                        spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                    }
                                    song.spinrilla = spinrilla
                                }
                                if dkey.contains(napsterMusicContentType) == true {
                                    let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    napster.url = temp[0] as! String
                                    napster.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        napster.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.napster = napster
                                }
                                if dkey.contains(tidalMusicContentType) == true {
                                    let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    tidal.url = temp[0] as! String
                                    tidal.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.tidal = tidal
                                }
                                if dkey == "Videos" {
                                        for diva in sub.children {
                                            let lsat = diva as! DataSnapshot
                                            let vidkey = lsat.key
                                            if vidkey == "Official" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.officialVideo = temp[0] as! String
                                            }
                                            if vidkey == "Audio" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.audioVideo = temp[0] as! String
                                            }
                                        }
                                }
                                
                            }
                contentFeaturedArray.append(song)
                        }
                    }
                    
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    
    
    func fetchAllVideosFromDatabase(page: Int, exceptions: [VideoData], completion: @escaping (([VideoData]) -> Void)) {
        var contentFeaturedArray:[VideoData] = []
        Database.database().reference().child("Music Content").child("Videos").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
        //print("ðŸ““\(snapshot)")
            var tick = 0
            
            for child in snapshot.children {
                let video = VideoData(title: "", toneDeafAppId: "", persons: nil, videographers: nil, albums: nil, instrumentals: nil, merch: nil, songs: nil, beats: nil, favorites: 0, type: "", timeIA: "", dateIA: "", viewsIA: 0, manualThumbnailURL: nil, isActive: false, youtube: nil, igtv: nil, instagramPost: nil, facebookPost: nil, worldstar: nil, twitter: nil, appleMusic: nil, tikTok: nil, industryCerified: nil, verificationLevel: nil)
                let bdata = child as! DataSnapshot
                let akey = bdata.key
                tick += 1
                if akey != "All Video IDs" {
                    let split = akey.components(separatedBy: "--")
                    //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                    if !(cepArr.contains(String("\(split[2])"))){
                        for chi in bdata.children {
                            let data = chi as! DataSnapshot
                            let key = data.key
                            if key == "Active Status" {
                                video.isActive = data.value  as! Bool
                            }
                            if key == "Albums" {
                                video.albums = data.value as? [String]
                            }
                            if key == "Instrumentals" {
                                if data.value as! [String] != [""] {
                                    video.instrumentals = data.value as? [String]
                                }
                            }
                            if key == "Beats" {
                                if data.value as! [String] != [""] {
                                    video.beats = data.value as? [String]
                                }
                            }
                            if key == "Songs" {
                                if data.value as! [String] != [""] {
                                    video.songs = data.value as? [String]
                                }
                            }
                            if key == "Persons" {
                                if data.value as! [String] != [""] {
                                    video.persons = data.value as? [String]
                                }
                            }
                            if key == "Videographers" {
                                if data.value as! [String] != [""] {
                                    video.videographers = data.value as? [String]
                                }
                            }
                            if key == "Date Uploaded To App" {
                                video.dateIA = data.value as! String
                            }
                            if key == "Time Uploaded To App" {
                                video.timeIA = data.value as! String
                            }
                            if key == "Number of Favorites" {
                                video.favorites = data.value as! Int
                            }
                            if key == "Views In App" {
                                video.viewsIA = data.value as! Int
                            }
                            if key == "Title" {
                                video.title = data.value as! String
                            }
                            if key == "Type" {
                                video.type = data.value as! String
                            }
                            if key == "Tone Deaf App Video Id" {
                                video.toneDeafAppId = data.value as! String
                            }
                            if key == "Manual Thumbnail URL" {
                                video.manualThumbnailURL = (data.value as! String)
                            }
                            if key == "Industry Certified" {
                                video.industryCerified = (data.value as? Bool)
                            }
                            if key == "Verification Level" {
                                video.verificationLevel = Character(data.value as! String)
                            }
                            
                            if key == "Youtube" {
                                
                                
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    
                                    if okey.contains("YT") == true && !okey.contains("YTPL")  {
                                        if video.youtube == nil {
                                            video.youtube = []
                                        }
                                        let avideo = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = bdata.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Channel Title"] as! String)
                                        temp.append(ovalue["Duration"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Description"] as! String)
                                        temp.append(ovalue["Thumbnail URL"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Title"] as! String)
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(avalue["Views In App"] as! Int)
                                        temp.append(ovalue["Youtube Id"] as! String)
                                        temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                        temp.append(ovalue["Type"] as! String)
                                        if let vid = (avalue["Views on Youtube"] as? Int) {
                                            avideo.viewsYT = vid
                                        }
                                        
                                        avideo.channelTitle = temp[0] as! String
                                        avideo.duration = temp[1] as! String
                                        avideo.dateIA = temp[2] as! String
                                        avideo.dateYT = temp[3] as! String
                                        avideo.description = temp[4] as! String
                                        //                        video.favorites = temp[5] as! Int
                                        avideo.thumbnailURL = temp[5] as! String
                                        avideo.timeIA = temp[6] as! String
                                        avideo.timeYT = temp[7] as! String
                                        avideo.title = temp[8] as! String
                                        avideo.url = temp[9] as! String
                                        avideo.viewsIA = temp[10] as! Int
                                        avideo.youtubeId = temp[11] as! String
                                        avideo.toneDeafAppId = temp[12] as! String
                                        avideo.type = temp[13] as! String
                                        video.youtube!.append(avideo)
                                        
                                        
                                    }
                                    
                                    if okey.contains("YTPL") == true {
                                        if video.youtube == nil {
                                            video.youtube = []
                                        }
                                        let avideo = YouTubeData(duration: nil, url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = bdata.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Channel Title"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Description"] as! String)
                                        temp.append(ovalue["Thumbnail URL"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Title"] as! String)
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(avalue["Views In App"] as! Int)
                                        temp.append(ovalue["Youtube Id"] as! String)
                                        temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                        temp.append(ovalue["Type"] as! String)
                                        
                                        avideo.channelTitle = temp[0] as! String
                                        avideo.dateIA = temp[1] as! String
                                        avideo.dateYT = temp[2] as! String
                                        avideo.description = temp[3] as! String
                                        avideo.thumbnailURL = temp[4] as! String
                                        avideo.timeIA = temp[5] as! String
                                        avideo.timeYT = temp[6] as! String
                                        avideo.title = temp[7] as! String
                                        avideo.url = temp[8] as! String
                                        avideo.viewsIA = temp[9] as! Int
                                        avideo.youtubeId = temp[10] as! String
                                        avideo.toneDeafAppId = temp[11] as! String
                                        avideo.type = temp[12] as! String
                                        video.youtube!.append(avideo)
                                    }
                                }
                            }
                            
                            if key == "Twitter" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.twitter == nil {
                                        video.twitter = []
                                    }
                                    let avideo = TwitterTweetData(url: "", media: nil, twitterId: "", text: nil, dateTwitter: "", dateIA: "", timeIA: "", viewsIA: 0, isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Twitter Id"] as! String)
                                    temp.append(ovalue["Text"] as? String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Date Uploaded To Twitter"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Views In App"] as! Int)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    if let med = ovalue["Media"] as? [NSDictionary] {
                                        var medArr:[MediaDataForTwitter] = []
                                        for puppy in med {
                                            let tMed = MediaDataForTwitter(url: nil, mediaKey: nil, previewURL: nil, type: nil, contentType: nil)
                                            if let valval = puppy["Preview URL"] as? String {
                                                tMed.previewURL = valval
                                            }
                                            if let valval = puppy["Media Key"] as? String {
                                                tMed.mediaKey = valval
                                            }
                                            if let valval = puppy["Type"] as? String {
                                                tMed.type = valval
                                            }
                                            medArr.append(tMed)
                                        }
                                        avideo.media = medArr
                                    }
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.twitterId = temp[1] as! String
                                    avideo.text = temp[2] as? String
                                    avideo.dateIA = temp[3] as! String
                                    avideo.dateTwitter = temp[4] as! String
                                    avideo.timeIA = temp[5] as! String
                                    avideo.viewsIA = temp[6] as! Int
                                    avideo.isActive = temp[7] as! Bool
                                    
                                    
                                    
                                    video.twitter!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Tik Tok" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.tikTok == nil {
                                        video.tikTok = []
                                    }
                                    let avideo = TikTokData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.tikTok!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Instagram" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.instagramPost == nil {
                                        video.instagramPost = []
                                    }
                                    let avideo = InstagramPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.instagramPost!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Facebook" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.facebookPost == nil {
                                        video.facebookPost = []
                                    }
                                    let avideo = FacebookPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.facebookPost!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Worldstar" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.worldstar == nil {
                                        video.worldstar = []
                                    }
                                    let avideo = WorldstarData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.worldstar!.append(avideo)
                                    
                                }
                            }
                            
                        }
                        contentFeaturedArray.append(video)
                    }
                }
            }
            completion(contentFeaturedArray)
        })
    }
    
    func fetchAllVideosFromDatabase(page: Int, completion: @escaping (([VideoData]) -> Void)) {
        var contentFeaturedArray:[VideoData] = []
        Database.database().reference().child("Music Content").child("Videos").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            var tick = 0
            
            for child in snapshot.children {
                let video = VideoData(title: "", toneDeafAppId: "", persons: nil, videographers: nil, albums: nil, instrumentals: nil, merch: nil, songs: nil, beats: nil, favorites: 0, type: "", timeIA: "", dateIA: "", viewsIA: 0, manualThumbnailURL: nil, isActive: false, youtube: nil, igtv: nil, instagramPost: nil, facebookPost: nil, worldstar: nil, twitter: nil, appleMusic: nil, tikTok: nil, industryCerified: nil, verificationLevel: nil)
                let bdata = child as! DataSnapshot
                let akey = bdata.key
                tick += 1
                if akey != "All Video IDs" {
                        for chi in bdata.children {
                            let data = chi as! DataSnapshot
                            let key = data.key
                            if key == "Active Status" {
                                video.isActive = data.value  as! Bool
                            }
                            if key == "Albums" {
                                video.albums = data.value as? [String]
                            }
                            if key == "Instrumentals" {
                                if data.value as! [String] != [""] {
                                    video.instrumentals = data.value as? [String]
                                }
                            }
                            if key == "Beats" {
                                if data.value as! [String] != [""] {
                                    video.beats = data.value as? [String]
                                }
                            }
                            if key == "Songs" {
                                if data.value as! [String] != [""] {
                                    video.songs = data.value as? [String]
                                }
                            }
                            if key == "Persons" {
                                if data.value as! [String] != [""] {
                                    video.persons = data.value as? [String]
                                }
                            }
                            if key == "Videographers" {
                                if data.value as! [String] != [""] {
                                    video.videographers = data.value as? [String]
                                }
                            }
                            if key == "Date Uploaded To App" {
                                video.dateIA = data.value as! String
                            }
                            if key == "Time Uploaded To App" {
                                video.timeIA = data.value as! String
                            }
                            if key == "Number of Favorites" {
                                video.favorites = data.value as! Int
                            }
                            if key == "Views In App" {
                                video.viewsIA = data.value as! Int
                            }
                            if key == "Title" {
                                video.title = data.value as! String
                            }
                            if key == "Type" {
                                video.type = data.value as! String
                            }
                            if key == "Tone Deaf App Video Id" {
                                video.toneDeafAppId = data.value as! String
                            }
                            if key == "Manual Thumbnail URL" {
                                video.manualThumbnailURL = (data.value as! String)
                            }
                            if key == "Industry Certified" {
                                video.industryCerified = (data.value as? Bool)
                            }
                            if key == "Verification Level" {
                                video.verificationLevel = Character(data.value as! String)
                            }
                            
                            if key == "Youtube" {
                                
                                
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    
                                    if okey.contains("YT") == true && !okey.contains("YTPL")  {
                                        if video.youtube == nil {
                                            video.youtube = []
                                        }
                                        let avideo = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = bdata.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Channel Title"] as! String)
                                        temp.append(ovalue["Duration"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Description"] as! String)
                                        temp.append(ovalue["Thumbnail URL"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Title"] as! String)
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(avalue["Views In App"] as! Int)
                                        temp.append(ovalue["Views on Youtube"] as! Int)
                                        temp.append(ovalue["Youtube Id"] as! String)
                                        temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                        temp.append(ovalue["Type"] as! String)
                                        
                                        avideo.channelTitle = temp[0] as! String
                                        avideo.duration = temp[1] as! String
                                        avideo.dateIA = temp[2] as! String
                                        avideo.dateYT = temp[3] as! String
                                        avideo.description = temp[4] as! String
                                        //                        video.favorites = temp[5] as! Int
                                        avideo.thumbnailURL = temp[5] as! String
                                        avideo.timeIA = temp[6] as! String
                                        avideo.timeYT = temp[7] as! String
                                        avideo.title = temp[8] as! String
                                        avideo.url = temp[9] as! String
                                        avideo.viewsIA = temp[10] as! Int
                                        avideo.viewsYT = temp[11] as! Int
                                        avideo.youtubeId = temp[12] as! String
                                        avideo.toneDeafAppId = temp[13] as! String
                                        avideo.type = temp[14] as! String
                                        video.youtube!.append(avideo)
                                        
                                        
                                    }
                                    
                                    if okey.contains("YTPL") == true {
                                        if video.youtube == nil {
                                            video.youtube = []
                                        }
                                        let avideo = YouTubeData(duration: nil, url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = bdata.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Channel Title"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Description"] as! String)
                                        temp.append(ovalue["Thumbnail URL"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Title"] as! String)
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(avalue["Views In App"] as! Int)
                                        temp.append(ovalue["Youtube Id"] as! String)
                                        temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                        temp.append(ovalue["Type"] as! String)
                                        
                                        avideo.channelTitle = temp[0] as! String
                                        avideo.dateIA = temp[1] as! String
                                        avideo.dateYT = temp[2] as! String
                                        avideo.description = temp[3] as! String
                                        avideo.thumbnailURL = temp[4] as! String
                                        avideo.timeIA = temp[5] as! String
                                        avideo.timeYT = temp[6] as! String
                                        avideo.title = temp[7] as! String
                                        avideo.url = temp[8] as! String
                                        avideo.viewsIA = temp[9] as! Int
                                        avideo.youtubeId = temp[10] as! String
                                        avideo.toneDeafAppId = temp[11] as! String
                                        avideo.type = temp[12] as! String
                                        video.youtube!.append(avideo)
                                    }
                                }
                            }
                            
                            if key == "Twitter" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.twitter == nil {
                                        video.twitter = []
                                    }
                                    let avideo = TwitterTweetData(url: "", media: nil, twitterId: "", text: nil, dateTwitter: "", dateIA: "", timeIA: "", viewsIA: 0, isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Twitter Id"] as! String)
                                    temp.append(ovalue["Text"] as? String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Date Uploaded To Twitter"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Views In App"] as! Int)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    if let med = ovalue["Media"] as? [NSDictionary] {
                                        var medArr:[MediaDataForTwitter] = []
                                        for puppy in med {
                                            let tMed = MediaDataForTwitter(url: nil, mediaKey: nil, previewURL: nil, type: nil, contentType: nil)
                                            if let valval = puppy["Preview URL"] as? String {
                                                tMed.previewURL = valval
                                            }
                                            if let valval = puppy["Media Key"] as? String {
                                                tMed.mediaKey = valval
                                            }
                                            if let valval = puppy["Type"] as? String {
                                                tMed.type = valval
                                            }
                                            medArr.append(tMed)
                                        }
                                        avideo.media = medArr
                                    }
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.twitterId = temp[1] as! String
                                    avideo.text = temp[2] as? String
                                    avideo.dateIA = temp[3] as! String
                                    avideo.dateTwitter = temp[4] as! String
                                    avideo.timeIA = temp[5] as! String
                                    avideo.viewsIA = temp[6] as! Int
                                    avideo.isActive = temp[7] as! Bool
                                    
                                    
                                    
                                    video.twitter!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Tik Tok" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.tikTok == nil {
                                        video.tikTok = []
                                    }
                                    let avideo = TikTokData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.tikTok!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Instagram" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.instagramPost == nil {
                                        video.instagramPost = []
                                    }
                                    let avideo = InstagramPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.instagramPost!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Facebook" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.facebookPost == nil {
                                        video.facebookPost = []
                                    }
                                    let avideo = FacebookPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.facebookPost!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Worldstar" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.worldstar == nil {
                                        video.worldstar = []
                                    }
                                    let avideo = WorldstarData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.worldstar!.append(avideo)
                                    
                                }
                            }
                            
                        }
                        contentFeaturedArray.append(video)
                }
            }
            completion(contentFeaturedArray)
        })
    }
    
    func fetchAllVideosFromDatabase(page: Int, end:String, completion: @escaping (([VideoData]) -> Void)) {
        var contentFeaturedArray:[VideoData] = []
        Database.database().reference().child("Music Content").child("Videos").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            var tick = 0
            
            for child in snapshot.children {
                let video = VideoData(title: "", toneDeafAppId: "", persons: nil, videographers: nil, albums: nil, instrumentals: nil, merch: nil, songs: nil, beats: nil, favorites: 0, type: "", timeIA: "", dateIA: "", viewsIA: 0, manualThumbnailURL: nil, isActive: false, youtube: nil, igtv: nil, instagramPost: nil, facebookPost: nil, worldstar: nil, twitter: nil, appleMusic: nil, tikTok: nil, industryCerified: nil, verificationLevel: nil)
                let bdata = child as! DataSnapshot
                let akey = bdata.key
                tick += 1
                if akey != "All Video IDs" {
                        for chi in bdata.children {
                            let data = chi as! DataSnapshot
                            let key = data.key
                            if key == "Active Status" {
                                video.isActive = data.value  as! Bool
                            }
                            if key == "Albums" {
                                video.albums = data.value as? [String]
                            }
                            if key == "Instrumentals" {
                                if data.value as! [String] != [""] {
                                    video.instrumentals = data.value as? [String]
                                }
                            }
                            if key == "Beats" {
                                if data.value as! [String] != [""] {
                                    video.beats = data.value as? [String]
                                }
                            }
                            if key == "Songs" {
                                if data.value as! [String] != [""] {
                                    video.songs = data.value as? [String]
                                }
                            }
                            if key == "Persons" {
                                if data.value as! [String] != [""] {
                                    video.persons = data.value as? [String]
                                }
                            }
                            if key == "Videographers" {
                                if data.value as! [String] != [""] {
                                    video.videographers = data.value as? [String]
                                }
                            }
                            if key == "Date Uploaded To App" {
                                video.dateIA = data.value as! String
                            }
                            if key == "Time Uploaded To App" {
                                video.timeIA = data.value as! String
                            }
                            if key == "Number of Favorites" {
                                video.favorites = data.value as! Int
                            }
                            if key == "Views In App" {
                                video.viewsIA = data.value as! Int
                            }
                            if key == "Title" {
                                video.title = data.value as! String
                            }
                            if key == "Type" {
                                video.type = data.value as! String
                            }
                            if key == "Tone Deaf App Video Id" {
                                video.toneDeafAppId = data.value as! String
                            }
                            if key == "Manual Thumbnail URL" {
                                video.manualThumbnailURL = (data.value as! String)
                            }
                            if key == "Industry Certified" {
                                video.industryCerified = (data.value as? Bool)
                            }
                            if key == "Verification Level" {
                                video.verificationLevel = Character(data.value as! String)
                            }
                            
                            if key == "Youtube" {
                                
                                
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    
                                    if okey.contains("YT") == true && !okey.contains("YTPL")  {
                                        if video.youtube == nil {
                                            video.youtube = []
                                        }
                                        let avideo = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = bdata.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Channel Title"] as! String)
                                        temp.append(ovalue["Duration"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Description"] as! String)
                                        temp.append(ovalue["Thumbnail URL"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Title"] as! String)
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(avalue["Views In App"] as! Int)
                                        temp.append(ovalue["Views on Youtube"] as! Int)
                                        temp.append(ovalue["Youtube Id"] as! String)
                                        temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                        temp.append(ovalue["Type"] as! String)
                                        
                                        avideo.channelTitle = temp[0] as! String
                                        avideo.duration = temp[1] as! String
                                        avideo.dateIA = temp[2] as! String
                                        avideo.dateYT = temp[3] as! String
                                        avideo.description = temp[4] as! String
                                        //                        video.favorites = temp[5] as! Int
                                        avideo.thumbnailURL = temp[5] as! String
                                        avideo.timeIA = temp[6] as! String
                                        avideo.timeYT = temp[7] as! String
                                        avideo.title = temp[8] as! String
                                        avideo.url = temp[9] as! String
                                        avideo.viewsIA = temp[10] as! Int
                                        avideo.viewsYT = temp[11] as! Int
                                        avideo.youtubeId = temp[12] as! String
                                        avideo.toneDeafAppId = temp[13] as! String
                                        avideo.type = temp[14] as! String
                                        video.youtube!.append(avideo)
                                        
                                        
                                    }
                                    
                                    if okey.contains("YTPL") == true {
                                        if video.youtube == nil {
                                            video.youtube = []
                                        }
                                        let avideo = YouTubeData(duration: nil, url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = bdata.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Channel Title"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Description"] as! String)
                                        temp.append(ovalue["Thumbnail URL"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Title"] as! String)
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(avalue["Views In App"] as! Int)
                                        temp.append(ovalue["Youtube Id"] as! String)
                                        temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                        temp.append(ovalue["Type"] as! String)
                                        
                                        avideo.channelTitle = temp[0] as! String
                                        avideo.dateIA = temp[1] as! String
                                        avideo.dateYT = temp[2] as! String
                                        avideo.description = temp[3] as! String
                                        avideo.thumbnailURL = temp[4] as! String
                                        avideo.timeIA = temp[5] as! String
                                        avideo.timeYT = temp[6] as! String
                                        avideo.title = temp[7] as! String
                                        avideo.url = temp[8] as! String
                                        avideo.viewsIA = temp[9] as! Int
                                        avideo.youtubeId = temp[10] as! String
                                        avideo.toneDeafAppId = temp[11] as! String
                                        avideo.type = temp[12] as! String
                                        video.youtube!.append(avideo)
                                    }
                                }
                            }
                            
                            if key == "Twitter" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.twitter == nil {
                                        video.twitter = []
                                    }
                                    let avideo = TwitterTweetData(url: "", media: nil, twitterId: "", text: nil, dateTwitter: "", dateIA: "", timeIA: "", viewsIA: 0, isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Twitter Id"] as! String)
                                    temp.append(ovalue["Text"] as? String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Date Uploaded To Twitter"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Views In App"] as! Int)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    if let med = ovalue["Media"] as? [NSDictionary] {
                                        var medArr:[MediaDataForTwitter] = []
                                        for puppy in med {
                                            let tMed = MediaDataForTwitter(url: nil, mediaKey: nil, previewURL: nil, type: nil, contentType: nil)
                                            if let valval = puppy["Preview URL"] as? String {
                                                tMed.previewURL = valval
                                            }
                                            if let valval = puppy["Media Key"] as? String {
                                                tMed.mediaKey = valval
                                            }
                                            if let valval = puppy["Type"] as? String {
                                                tMed.type = valval
                                            }
                                            medArr.append(tMed)
                                        }
                                        avideo.media = medArr
                                    }
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.twitterId = temp[1] as! String
                                    avideo.text = temp[2] as? String
                                    avideo.dateIA = temp[3] as! String
                                    avideo.dateTwitter = temp[4] as! String
                                    avideo.timeIA = temp[5] as! String
                                    avideo.viewsIA = temp[6] as! Int
                                    avideo.isActive = temp[7] as! Bool
                                    
                                    
                                    
                                    video.twitter!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Tik Tok" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.tikTok == nil {
                                        video.tikTok = []
                                    }
                                    let avideo = TikTokData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.tikTok!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Instagram" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.instagramPost == nil {
                                        video.instagramPost = []
                                    }
                                    let avideo = InstagramPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.instagramPost!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Facebook" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.facebookPost == nil {
                                        video.facebookPost = []
                                    }
                                    let avideo = FacebookPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.facebookPost!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Worldstar" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.worldstar == nil {
                                        video.worldstar = []
                                    }
                                    let avideo = WorldstarData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.worldstar!.append(avideo)
                                    
                                }
                            }
                            
                        }
                        contentFeaturedArray.append(video)
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllVideosFromDatabase(page: Int, end:String, exceptions: [VideoData], completion: @escaping (([VideoData]) -> Void)) {
        var contentFeaturedArray:[VideoData] = []
        Database.database().reference().child("Music Content").child("Videos").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
        //print("ðŸ““\(snapshot)")
            var tick = 0
            
            for child in snapshot.children {
                let video = VideoData(title: "", toneDeafAppId: "", persons: nil, videographers: nil, albums: nil, instrumentals: nil, merch: nil, songs: nil, beats: nil, favorites: 0, type: "", timeIA: "", dateIA: "", viewsIA: 0, manualThumbnailURL: nil, isActive: false, youtube: nil, igtv: nil, instagramPost: nil, facebookPost: nil, worldstar: nil, twitter: nil, appleMusic: nil, tikTok: nil, industryCerified: nil, verificationLevel: nil)
                let bdata = child as! DataSnapshot
                let akey = bdata.key
                tick += 1
                if akey != "All Video IDs" {
                    let split = akey.components(separatedBy: "--")
                    //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                    if !(cepArr.contains(String("\(split[2])"))){
                        for chi in bdata.children {
                            let data = chi as! DataSnapshot
                            let key = data.key
                            if key == "Active Status" {
                                video.isActive = data.value  as! Bool
                            }
                            if key == "Albums" {
                                video.albums = data.value as? [String]
                            }
                            if key == "Instrumentals" {
                                if data.value as! [String] != [""] {
                                    video.instrumentals = data.value as? [String]
                                }
                            }
                            if key == "Beats" {
                                if data.value as! [String] != [""] {
                                    video.beats = data.value as? [String]
                                }
                            }
                            if key == "Songs" {
                                if data.value as! [String] != [""] {
                                    video.songs = data.value as? [String]
                                }
                            }
                            if key == "Persons" {
                                if data.value as! [String] != [""] {
                                    video.persons = data.value as? [String]
                                }
                            }
                            if key == "Videographers" {
                                if data.value as! [String] != [""] {
                                    video.videographers = data.value as? [String]
                                }
                            }
                            if key == "Date Uploaded To App" {
                                video.dateIA = data.value as! String
                            }
                            if key == "Time Uploaded To App" {
                                video.timeIA = data.value as! String
                            }
                            if key == "Number of Favorites" {
                                video.favorites = data.value as! Int
                            }
                            if key == "Views In App" {
                                video.viewsIA = data.value as! Int
                            }
                            if key == "Title" {
                                video.title = data.value as! String
                            }
                            if key == "Type" {
                                video.type = data.value as! String
                            }
                            if key == "Tone Deaf App Video Id" {
                                video.toneDeafAppId = data.value as! String
                            }
                            if key == "Industry Certified" {
                                video.industryCerified = (data.value as? Bool)
                            }
                            if key == "Verification Level" {
                                video.verificationLevel = Character(data.value as! String)
                            }
                            if key == "Manual Thumbnail URL" {
                                video.manualThumbnailURL = (data.value as! String)
                            }
                            
                            if key == "Youtube" {
                                
                                
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    
                                    if okey.contains("YT") == true && !okey.contains("YTPL")  {
                                        if video.youtube == nil {
                                            video.youtube = []
                                        }
                                        let avideo = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = bdata.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Channel Title"] as! String)
                                        temp.append(ovalue["Duration"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Description"] as! String)
                                        temp.append(ovalue["Thumbnail URL"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Title"] as! String)
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(avalue["Views In App"] as! Int)
                                        temp.append(ovalue["Views on Youtube"] as! Int)
                                        temp.append(ovalue["Youtube Id"] as! String)
                                        temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                        temp.append(ovalue["Type"] as! String)
                                        
                                        avideo.channelTitle = temp[0] as! String
                                        avideo.duration = temp[1] as! String
                                        avideo.dateIA = temp[2] as! String
                                        avideo.dateYT = temp[3] as! String
                                        avideo.description = temp[4] as! String
                                        //                        video.favorites = temp[5] as! Int
                                        avideo.thumbnailURL = temp[5] as! String
                                        avideo.timeIA = temp[6] as! String
                                        avideo.timeYT = temp[7] as! String
                                        avideo.title = temp[8] as! String
                                        avideo.url = temp[9] as! String
                                        avideo.viewsIA = temp[10] as! Int
                                        avideo.viewsYT = temp[11] as! Int
                                        avideo.youtubeId = temp[12] as! String
                                        avideo.toneDeafAppId = temp[13] as! String
                                        avideo.type = temp[14] as! String
                                        video.youtube!.append(avideo)
                                        
                                        
                                    }
                                    
                                    if okey.contains("YTPL") == true {
                                        if video.youtube == nil {
                                            video.youtube = []
                                        }
                                        let avideo = YouTubeData(duration: nil, url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = bdata.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Channel Title"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Description"] as! String)
                                        temp.append(ovalue["Thumbnail URL"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                        temp.append(ovalue["Title"] as! String)
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(avalue["Views In App"] as! Int)
                                        temp.append(ovalue["Youtube Id"] as! String)
                                        temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                        temp.append(ovalue["Type"] as! String)
                                        
                                        avideo.channelTitle = temp[0] as! String
                                        avideo.dateIA = temp[1] as! String
                                        avideo.dateYT = temp[2] as! String
                                        avideo.description = temp[3] as! String
                                        avideo.thumbnailURL = temp[4] as! String
                                        avideo.timeIA = temp[5] as! String
                                        avideo.timeYT = temp[6] as! String
                                        avideo.title = temp[7] as! String
                                        avideo.url = temp[8] as! String
                                        avideo.viewsIA = temp[9] as! Int
                                        avideo.youtubeId = temp[10] as! String
                                        avideo.toneDeafAppId = temp[11] as! String
                                        avideo.type = temp[12] as! String
                                        video.youtube!.append(avideo)
                                    }
                                }
                            }
                            
                            if key == "Twitter" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.twitter == nil {
                                        video.twitter = []
                                    }
                                    let avideo = TwitterTweetData(url: "", media: nil, twitterId: "", text: nil, dateTwitter: "", dateIA: "", timeIA: "", viewsIA: 0, isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Twitter Id"] as! String)
                                    temp.append(ovalue["Text"] as? String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Date Uploaded To Twitter"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Views In App"] as! Int)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    if let med = ovalue["Media"] as? [NSDictionary] {
                                        var medArr:[MediaDataForTwitter] = []
                                        for puppy in med {
                                            let tMed = MediaDataForTwitter(url: nil, mediaKey: nil, previewURL: nil, type: nil, contentType: nil)
                                            if let valval = puppy["Preview URL"] as? String {
                                                tMed.previewURL = valval
                                            }
                                            if let valval = puppy["Media Key"] as? String {
                                                tMed.mediaKey = valval
                                            }
                                            if let valval = puppy["Type"] as? String {
                                                tMed.type = valval
                                            }
                                            medArr.append(tMed)
                                        }
                                        avideo.media = medArr
                                    }
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.twitterId = temp[1] as! String
                                    avideo.text = temp[2] as? String
                                    avideo.dateIA = temp[3] as! String
                                    avideo.dateTwitter = temp[4] as! String
                                    avideo.timeIA = temp[5] as! String
                                    avideo.viewsIA = temp[6] as! Int
                                    avideo.isActive = temp[7] as! Bool
                                    
                                    
                                    
                                    video.twitter!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Tik Tok" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.tikTok == nil {
                                        video.tikTok = []
                                    }
                                    let avideo = TikTokData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.tikTok!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Instagram" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.instagramPost == nil {
                                        video.instagramPost = []
                                    }
                                    let avideo = InstagramPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.instagramPost!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Facebook" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.facebookPost == nil {
                                        video.facebookPost = []
                                    }
                                    let avideo = FacebookPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.facebookPost!.append(avideo)
                                    
                                }
                            }
                            
                            if key == "Worldstar" {
                                for shi in data.children {
                                    let odata = shi as! DataSnapshot
                                    let okey = odata.key
                                    if video.worldstar == nil {
                                        video.worldstar = []
                                    }
                                    let avideo = WorldstarData(url: "", dateIA: "", timeIa: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Active Status"] as! Bool)
                                    
                                    avideo.url = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.timeIa = temp[2] as! String
                                    avideo.isActive = temp[3] as! Bool
                                    
                                    
                                    
                                    video.worldstar!.append(avideo)
                                    
                                }
                            }
                            
                        }
                        contentFeaturedArray.append(video)
                    }
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
   
    
    
    func fetchAllBeatsFromDatabase(page: Int, price:String, completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        Database.database().reference().child("Beats").child(price).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for item in snapshot.children {
                let bea = item as! DataSnapshot
                let key = bea.key
                let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                    var temp:Array<Any> = []
                    let value = bea.value as! [String:Any]
                var typeArray:[String] = []
                var soundArray:[String] = []
                var time:String!
                var date:String!
                if let tval = value["Duration"] as? String {
                    beat.duration = tval
                }
                if let tval = value["Name"] as? String {
                    beat.name = tval
                }
                if let tval = value["Date"] as? String {
                    beat.date = tval
                    date = tval
                }
                if let tval = value["Number of Downloads"] as? Int {
                    beat.downloads = tval
                }
                if let tval = value["Wav Price"] as? Double {
                    beat.wavPrice = tval
                }
                if let tval = value["Lease Price"] as? Double {
                    beat.mp3Price = tval
                }
                if let tval = value["Exclusive Price"] as? Double {
                    beat.exclusivePrice = tval
                }
                if let tval = value["Time"] as? String {
                    beat.time = tval
                    time = tval
                }
                if let tval = value["Types"] as? [String] {
                    beat.types = tval
                }
                if let tval = value["Sounds"] as? [String] {
                    beat.sounds = tval
                }
                if let tval = value["Tempo"] as? Int {
                    beat.tempo = tval
                }
                if let tval = value["Audio"] as? String {
                    beat.audioURL = tval
                }
                if let tval = value["Image"] as? String {
                    beat.imageURL = tval
                }
                if let tval = value["beatId"] as? String {
                    beat.beatID = tval
                }
                if let tval = value["Price Type"] as? String {
                    beat.priceType = tval
                }
                if let tval = value["Producers"] as? [String] {
                    beat.producers = tval
                }
                if let tval = value["Tone Deaf App Id"] as? String {
                    beat.toneDeafAppId = tval
                }
                if let tval = value["Exclusive Files URL"] as? String {
                    beat.exclusiveFilesURL = tval
                }
                if let tval = value["Wav URL"] as? String {
                    beat.wavURL = tval
                }
                if let tval = value["Official Video"] as? String {
                    beat.officialVideo = tval
                }
                if let tval = value["Videos"] as? [String] {
                    beat.videos = tval
                }
                if let tval = value["Key"] as? String {
                    beat.key = tval
                }
                if let tval = value["Active Status"] as? Bool {
                    beat.isActive = tval
                }
                if let merchandise = (value["Merch"] as? [String]) {
                    beat.merch = (merchandise)
                }
                beat.datetime = "\(date)\(time)"
                let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                for kiddo in bea.children {
                    let dada = kiddo as! DataSnapshot
                    if dada.key.contains(soundcloudMusicContentType) == true {
                        var temp:Array<Any> = []
                        let dvalue = dada.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        soundcloud.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Soundcloud"] != nil {
                            soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                        }
                        beat.soundcloud = soundcloud
                    }
                }
                
                    contentFeaturedArray.append(beat)
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllBeatsFromDatabase(page: Int, price:String, end:String, completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        Database.database().reference().child("Beats").child(price).queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for item in snapshot.children {
                let bea = item as! DataSnapshot
                let key = bea.key
                let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                    var temp:Array<Any> = []
                    let value = bea.value as! [String:Any]
                var typeArray:[String] = []
                var soundArray:[String] = []
                var time:String!
                var date:String!
                if let tval = value["Duration"] as? String {
                    beat.duration = tval
                }
                if let tval = value["Name"] as? String {
                    beat.name = tval
                }
                if let tval = value["Date"] as? String {
                    beat.date = tval
                    date = tval
                }
                if let tval = value["Number of Downloads"] as? Int {
                    beat.downloads = tval
                }
                if let tval = value["Wav Price"] as? Double {
                    beat.wavPrice = tval
                }
                if let tval = value["Lease Price"] as? Double {
                    beat.mp3Price = tval
                }
                if let tval = value["Exclusive Price"] as? Double {
                    beat.exclusivePrice = tval
                }
                if let tval = value["Time"] as? String {
                    beat.time = tval
                    time = tval
                }
                if let tval = value["Types"] as? [String] {
                    beat.types = tval
                }
                if let tval = value["Sounds"] as? [String] {
                    beat.sounds = tval
                }
                if let tval = value["Tempo"] as? Int {
                    beat.tempo = tval
                }
                if let tval = value["Audio"] as? String {
                    beat.audioURL = tval
                }
                if let tval = value["Image"] as? String {
                    beat.imageURL = tval
                }
                if let tval = value["beatId"] as? String {
                    beat.beatID = tval
                }
                if let tval = value["Price Type"] as? String {
                    beat.priceType = tval
                }
                if let tval = value["Producers"] as? [String] {
                    beat.producers = tval
                }
                if let tval = value["Tone Deaf App Id"] as? String {
                    beat.toneDeafAppId = tval
                }
                if let tval = value["Exclusive Files URL"] as? String {
                    beat.exclusiveFilesURL = tval
                }
                if let tval = value["Wav URL"] as? String {
                    beat.wavURL = tval
                }
                if let tval = value["Official Video"] as? String {
                    beat.officialVideo = tval
                }
                if let tval = value["Videos"] as? [String] {
                    beat.videos = tval
                }
                if let tval = value["Key"] as? String {
                    beat.key = tval
                }
                if let tval = value["Active Status"] as? Bool {
                    beat.isActive = tval
                }
                if let merchandise = (value["Merch"] as? [String]) {
                    beat.merch = (merchandise)
                }
                beat.datetime = "\(date)\(time)"
                let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                for kiddo in bea.children {
                    let dada = kiddo as! DataSnapshot
                    if dada.key.contains(soundcloudMusicContentType) == true {
                        var temp:Array<Any> = []
                        let dvalue = dada.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        soundcloud.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Soundcloud"] != nil {
                            soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                        }
                        beat.soundcloud = soundcloud
                    }
                }
                    //print("ðŸ“™ beat \(beat)")
                    contentFeaturedArray.append(beat)
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllBeatsFromDatabase(page: Int, completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        Database.database().reference().child("Beats").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let price = data.key
                let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                for item in data.children {
                    let bea = item as! DataSnapshot
                        var temp:Array<Any> = []
                        let value = bea.value as! [String:Any]
                    var typeArray:[String] = []
                    var soundArray:[String] = []
                    var time:String!
                    var date:String!
                    if let tval = value["Duration"] as? String {
                        beat.duration = tval
                    }
                    if let tval = value["Name"] as? String {
                        beat.name = tval
                    }
                    if let tval = value["Date"] as? String {
                        beat.date = tval
                        date = tval
                    }
                    if let tval = value["Number of Downloads"] as? Int {
                        beat.downloads = tval
                    }
                    if let tval = value["Wav Price"] as? Double {
                        beat.wavPrice = tval
                    }
                    if let tval = value["Lease Price"] as? Double {
                        beat.mp3Price = tval
                    }
                    if let tval = value["Exclusive Price"] as? Double {
                        beat.exclusivePrice = tval
                    }
                    if let tval = value["Time"] as? String {
                        beat.time = tval
                        time = tval
                    }
                    if let tval = value["Types"] as? [String] {
                        beat.types = tval
                    }
                    if let tval = value["Sounds"] as? [String] {
                        beat.sounds = tval
                    }
                    if let tval = value["Tempo"] as? Int {
                        beat.tempo = tval
                    }
                    if let tval = value["Audio"] as? String {
                        beat.audioURL = tval
                    }
                    if let tval = value["Image"] as? String {
                        beat.imageURL = tval
                    }
                    if let tval = value["beatId"] as? String {
                        beat.beatID = tval
                    }
                    if let tval = value["Price Type"] as? String {
                        beat.priceType = tval
                    }
                    if let tval = value["Producers"] as? [String] {
                        beat.producers = tval
                    }
                    if let tval = value["Tone Deaf App Id"] as? String {
                        beat.toneDeafAppId = tval
                    }
                    if let tval = value["Exclusive Files URL"] as? String {
                        beat.exclusiveFilesURL = tval
                    }
                    if let tval = value["Wav URL"] as? String {
                        beat.wavURL = tval
                    }
                    if let tval = value["Official Video"] as? String {
                        beat.officialVideo = tval
                    }
                    if let tval = value["Videos"] as? [String] {
                        beat.videos = tval
                    }
                    if let tval = value["Key"] as? String {
                        beat.key = tval
                    }
                    if let tval = value["Active Status"] as? Bool {
                        beat.isActive = tval
                    }
                    if let merchandise = (value["Merch"] as? [String]) {
                        beat.merch = (merchandise)
                    }
                    beat.datetime = "\(date)\(time)"
                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                    for kiddo in bea.children {
                        let dada = kiddo as! DataSnapshot
                        if dada.key.contains(soundcloudMusicContentType) == true {
                            var temp:Array<Any> = []
                            let dvalue = dada.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            beat.soundcloud = soundcloud
                        }
                    }
                        //print("ðŸ“™ beat \(beat)")
                        contentFeaturedArray.append(beat)
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllBeatsFromDatabase(page: Int, exceptions: [BeatData], completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        Database.database().reference().child("Beats").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if key != "All Beat IDs" {
                    let split = key.components(separatedBy: "--")
                    //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                    if !(cepArr.contains(String("\(split[2])"))) {
                        let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                            
                                let value = data.value as! [String:Any]
                            var time:String!
                            var date:String!
                            if let tval = value["Duration"] as? String {
                                beat.duration = tval
                            }
                            if let tval = value["Name"] as? String {
                                beat.name = tval
                            }
                            if let tval = value["Date"] as? String {
                                beat.date = tval
                                date = tval
                            }
                            if let tval = value["Number of Downloads"] as? Int {
                                beat.downloads = tval
                            }
                            if let tval = value["Wav Price"] as? Double {
                                beat.wavPrice = tval
                            }
                            if let tval = value["Lease Price"] as? Double {
                                beat.mp3Price = tval
                            }
                            if let tval = value["Exclusive Price"] as? Double {
                                beat.exclusivePrice = tval
                            }
                            if let tval = value["Time"] as? String {
                                beat.time = tval
                                time = tval
                            }
                            if let tval = value["Types"] as? [String] {
                                beat.types = tval
                            }
                            if let tval = value["Sounds"] as? [String] {
                                beat.sounds = tval
                            }
                            if let tval = value["Tempo"] as? Int {
                                beat.tempo = tval
                            }
                            if let tval = value["Audio"] as? String {
                                beat.audioURL = tval
                            }
                            if let tval = value["Image"] as? String {
                                beat.imageURL = tval
                            }
                            if let tval = value["beatId"] as? String {
                                beat.beatID = tval
                            }
                            if let tval = value["Price Type"] as? String {
                                beat.priceType = tval
                            }
                            if let tval = value["Producers"] as? [String] {
                                beat.producers = tval
                            }
                            if let tval = value["Tone Deaf App Id"] as? String {
                                beat.toneDeafAppId = tval
                            }
                            if let tval = value["Exclusive Files URL"] as? String {
                                beat.exclusiveFilesURL = tval
                            }
                            if let tval = value["Wav URL"] as? String {
                                beat.wavURL = tval
                            }
                            if let tval = value["Official Video"] as? String {
                                beat.officialVideo = tval
                            }
                            if let tval = value["Videos"] as? [String] {
                                beat.videos = tval
                            }
                            if let tval = value["Key"] as? String {
                                beat.key = tval
                            }
                            if let tval = value["Active Status"] as? Bool {
                                beat.isActive = tval
                            }
                            if let merchandise = (value["Merch"] as? [String]) {
                                beat.merch = (merchandise)
                            }
                            beat.datetime = "\(date!)\(time!)"
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            for kiddo in data.children {
                                let dada = kiddo as! DataSnapshot
                                if dada.key.contains(soundcloudMusicContentType) == true {
                                    var temp:Array<Any> = []
                                    let dvalue = dada.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    soundcloud.url = temp[0] as! String
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    beat.soundcloud = soundcloud
                                }
                            }
                        contentFeaturedArray.append(beat)
                    }
                }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllBeatsFromDatabase(page: Int, end:String, completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        Database.database().reference().child("Beats").child("$key").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let price = data.key
                let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                for item in data.children {
                    let bea = item as! DataSnapshot
                        var temp:Array<Any> = []
                        let value = bea.value as! [String:Any]
                    var typeArray:[String] = []
                    var soundArray:[String] = []
                    var time:String!
                    var date:String!
                    if let tval = value["Duration"] as? String {
                        beat.duration = tval
                    }
                    if let tval = value["Name"] as? String {
                        beat.name = tval
                    }
                    if let tval = value["Date"] as? String {
                        beat.date = tval
                        date = tval
                    }
                    if let tval = value["Number of Downloads"] as? Int {
                        beat.downloads = tval
                    }
                    if let tval = value["Wav Price"] as? Double {
                        beat.wavPrice = tval
                    }
                    if let tval = value["Lease Price"] as? Double {
                        beat.mp3Price = tval
                    }
                    if let tval = value["Exclusive Price"] as? Double {
                        beat.exclusivePrice = tval
                    }
                    if let tval = value["Time"] as? String {
                        beat.time = tval
                        time = tval
                    }
                    if let tval = value["Types"] as? [String] {
                        beat.types = tval
                    }
                    if let tval = value["Sounds"] as? [String] {
                        beat.sounds = tval
                    }
                    if let tval = value["Tempo"] as? Int {
                        beat.tempo = tval
                    }
                    if let tval = value["Audio"] as? String {
                        beat.audioURL = tval
                    }
                    if let tval = value["Image"] as? String {
                        beat.imageURL = tval
                    }
                    if let tval = value["beatId"] as? String {
                        beat.beatID = tval
                    }
                    if let tval = value["Price Type"] as? String {
                        beat.priceType = tval
                    }
                    if let tval = value["Producers"] as? [String] {
                        beat.producers = tval
                    }
                    if let tval = value["Tone Deaf App Id"] as? String {
                        beat.toneDeafAppId = tval
                    }
                    if let tval = value["Exclusive Files URL"] as? String {
                        beat.exclusiveFilesURL = tval
                    }
                    if let tval = value["Wav URL"] as? String {
                        beat.wavURL = tval
                    }
                    if let tval = value["Official Video"] as? String {
                        beat.officialVideo = tval
                    }
                    if let tval = value["Videos"] as? [String] {
                        beat.videos = tval
                    }
                    if let tval = value["Key"] as? String {
                        beat.key = tval
                    }
                    if let tval = value["Active Status"] as? Bool {
                        beat.isActive = tval
                    }
                    if let merchandise = (value["Merch"] as? [String]) {
                        beat.merch = (merchandise)
                    }
                    beat.datetime = "\(date)\(time)"
                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                    for kiddo in bea.children {
                        let dada = kiddo as! DataSnapshot
                        if dada.key.contains(soundcloudMusicContentType) == true {
                            var temp:Array<Any> = []
                            let dvalue = dada.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            beat.soundcloud = soundcloud
                        }
                    }
                        //print("ðŸ“™ beat \(beat)")
                        contentFeaturedArray.append(beat)
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllBeatsFromDatabase(page: Int, end:String, exceptions: [BeatData], completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        Database.database().reference().child("Beats").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if data.key != "All Beat IDs" {
                    let split = data.key.components(separatedBy: "--")
                    //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                    if !(cepArr.contains(String("\(split[2])"))){
                        let data = child as! DataSnapshot
                        let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                                var temp:Array<Any> = []
                                let value = data.value as! [String:Any]
                            var time:String!
                            var date:String!
                            if let tval = value["Duration"] as? String {
                                beat.duration = tval
                            }
                            if let tval = value["Name"] as? String {
                                beat.name = tval
                            }
                            if let tval = value["Date"] as? String {
                                beat.date = tval
                                date = tval
                            }
                            if let tval = value["Number of Downloads"] as? Int {
                                beat.downloads = tval
                            }
                            if let tval = value["Wav Price"] as? Double {
                                beat.wavPrice = tval
                            }
                            if let tval = value["Lease Price"] as? Double {
                                beat.mp3Price = tval
                            }
                            if let tval = value["Exclusive Price"] as? Double {
                                beat.exclusivePrice = tval
                            }
                            if let tval = value["Time"] as? String {
                                beat.time = tval
                                time = tval
                            }
                            if let tval = value["Types"] as? [String] {
                                beat.types = tval
                            }
                            if let tval = value["Sounds"] as? [String] {
                                beat.sounds = tval
                            }
                            if let tval = value["Tempo"] as? Int {
                                beat.tempo = tval
                            }
                            if let tval = value["Audio"] as? String {
                                beat.audioURL = tval
                            }
                            if let tval = value["Image"] as? String {
                                beat.imageURL = tval
                            }
                            if let tval = value["beatId"] as? String {
                                beat.beatID = tval
                            }
                            if let tval = value["Price Type"] as? String {
                                beat.priceType = tval
                            }
                            if let tval = value["Producers"] as? [String] {
                                beat.producers = tval
                            }
                            if let tval = value["Tone Deaf App Id"] as? String {
                                beat.toneDeafAppId = tval
                            }
                            if let tval = value["Exclusive Files URL"] as? String {
                                beat.exclusiveFilesURL = tval
                            }
                            if let tval = value["Wav URL"] as? String {
                                beat.wavURL = tval
                            }
                            if let tval = value["Official Video"] as? String {
                                beat.officialVideo = tval
                            }
                            if let tval = value["Videos"] as? [String] {
                                beat.videos = tval
                            }
                            if let tval = value["Key"] as? String {
                                beat.key = tval
                            }
                            if let tval = value["Active Status"] as? Bool {
                                beat.isActive = tval
                            }
                            if let merchandise = (value["Merch"] as? [String]) {
                                beat.merch = (merchandise)
                            }
                            beat.datetime = "\(date!)\(time!)"
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            for kiddo in data.children {
                                let dada = kiddo as! DataSnapshot
                                if dada.key.contains(soundcloudMusicContentType) == true {
                                    var temp:Array<Any> = []
                                    let dvalue = dada.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    soundcloud.url = temp[0] as! String
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    beat.soundcloud = soundcloud
                                }
                            }
                        contentFeaturedArray.append(beat)
                    }
                }
    
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    
    func fetchAllAlbumsFromDatabase(page: Int, completion: @escaping (([AlbumData]) -> Void)) {
        var contentFeaturedArray:[AlbumData] = []
        Database.database().reference().child("Music Content").child("Albums").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if data.key != "All Album IDs" {
                    var youtubeAlts:[String] = []
                    let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                    for sub in data.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        //print(up.key)
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = up.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Main Artist"] as! Array<String>)
                            temp.append(dvalue["All Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Number Of Tracks"] as! Int)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            if let tval = (dvalue["All Artist"]) as? [String] {
                                album.allArtists = tval
                            }
                            if let tval = (dvalue["All Writers"]) as? [String] {
                                album.writers = tval
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mix Engineer"]) as? [String] {
                                    album.mixEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mastering Engineer"]) as? [String] {
                                    album.masteringEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Recording Engineer"]) as? [String] {
                                    album.recordingEngineers = tval
                                }
                            }
                            if let merchandise = (dvalue["Merch"]) {
                                album.merch = (merchandise as! [String])
                            }
                            if let tval = (dvalue["Songs"]) as? [String] {
                                album.songs = tval
                            }
                            if let tval = (dvalue["Instrumentals"]) as? [String] {
                                album.instrumentals = tval
                            }
                            if let tval = (dvalue["Videos"]) as? [String] {
                                album.videos = tval
                            }
                            if let tval = (dvalue["Tracks"]) as? [String:String] {
                                album.tracks = tval
                            }
                            if let tval = (dvalue["Manual Image URL"]) as? String {
                                album.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"]) as? String {
                                album.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                album.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                album.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Deluxes"] as? [String]) {
                                album.deluxes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                album.otherVersions = tval
                            }
                        if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                            let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isDeluxe = deluxe
                        }
                        if let taval = (dvalue["Other Version"] as? NSDictionary) {
                            let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isOtherVersion = deluxe
                        }
                            
                            
                            
                            album.name = temp[0] as! String
                            album.mainArtist = temp[1] as! Array<String>
                            album.producers = temp[2] as! Array<String>
                            album.favoritesOverall = temp[3] as! Int
                            album.toneDeafAppId = temp[4] as! String
                            album.numberofTracks = temp[5] as! Int
                            album.timeRegisteredToApp = temp[6] as! String
                            album.dateRegisteredToApp = temp[7] as! String
                            album.isActive = temp[8] as! Bool
                        }
                        if dkey.contains("APPL") == true {
                            let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            appleData.name = temp[0] as! String
                            appleData.artist = temp[1] as! String
                            appleData.dateReleasedApple = temp[2] as! String
                            appleData.timeIA = temp[3] as! String
                            appleData.dateIA = temp[4] as! String
                            appleData.imageURL = temp[5] as! String
                            appleData.url = temp[6] as! String
                            //appleData. = temp[6] as! Int
                            appleData.trackCount = temp[7] as! Int
                            appleData.appleId = temp[8] as! String
                            appleData.isActive = temp[9] as! Bool
                            
                            album.apple = appleData
                        }
                        if dkey.contains("SPTY") == true {
                            let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! [[String:String]])
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Album URI"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotifyData.name = temp[0] as! String
                            spotifyData.artist = temp[1] as! [[String:String]]
                            spotifyData.upc = temp[2] as! String
                            spotifyData.dateReleasedSpotify = temp[3] as! String
                            spotifyData.timeIA = temp[4] as! String
                            spotifyData.dateIA = temp[5] as! String
                            spotifyData.imageURL = temp[6] as! String
                            spotifyData.url = temp[7] as! String
                            spotifyData.uri = temp[8] as! String
                            //spotifyData. = temp[10] as! Bool
                            spotifyData.trackNumberTotal = temp[9] as! Int
                            spotifyData.spotifyId = temp[10] as! String
                            spotifyData.isActive = temp[11] as! Bool
                            
                            album.spotify = spotifyData
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            if dvalue["Active Status"] != nil {
                                soundcloud.isActive = (dvalue["Active Status"] as! Bool)
                            }
                            album.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            youtubeMusic.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Active Status"] != nil {
                                youtubeMusic.isActive = (dvalue["Active Status"] as! Bool)
                            }
                            album.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            amazon.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Active Status"] != nil {
                                amazon.isActive = (dvalue["Active Status"] as! Bool)
                            }
                            album.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String:Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            if dvalue["Active Status"] != nil {
                                deezer.isActive = (dvalue["Active Status"] as! Bool)
                            }
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String:Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.upc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.timeIA = temp[7] as! String
                            deezer.deezerID = temp[8] as! Int
                            deezer.dateIA = temp[9] as! String
                            
                            album.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            spinrilla.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            if dvalue["Active Status"] != nil {
                                spinrilla.isActive = (dvalue["Active Status"] as! Bool)
                            }
                            album.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            napster.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Active Status"] != nil {
                                napster.isActive = (dvalue["Active Status"] as! Bool)
                            }
                            album.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            tidal.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Active Status"] != nil {
                                tidal.isActive = (dvalue["Active Status"] as! Bool)
                            }
                            album.tidal = tidal
                        }
                        if dkey == "Videos" {
                            for diva in up.children {
                                let lsat = diva as! DataSnapshot
                                let vidkey = lsat.key
                                if vidkey == "Official" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    album.officialAlbumVideo = temp[0] as! String
                                }
                            }
                        }
                    }
                    contentFeaturedArray.append(album)
                }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllAlbumsFromDatabase(page: Int, exceptions: [AlbumData], completion: @escaping (([AlbumData]) -> Void)) {
        var contentFeaturedArray:[AlbumData] = []
        Database.database().reference().child("Music Content").child("Albums").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if data.key != "All Album IDs" {
                    let split = data.key.components(separatedBy: "--")
                    //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                    if !(cepArr.contains(String("\(split[2])"))) {
                        var youtubeAlts:[String] = []
                        let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                        for sub in data.children {
                            let up = sub as! DataSnapshot
                            let dkey = up.key
                            //print(up.key)
                            if dkey == "REQUIRED" {
                                var temp:Array<Any> = []
                                let dvalue = up.value as! [String:Any]
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Main Artist"] as! Array<String>)
                                temp.append(dvalue["All Producers"] as! Array<String>)
                                temp.append(dvalue["Number of Favorites Overall"] as! Int)
                                temp.append(dvalue["Tone Deaf App Id"] as! String)
                                temp.append(dvalue["Number Of Tracks"] as! Int)
                                temp.append(dvalue["Time Registered To App"] as! String)
                                temp.append(dvalue["Date Registered To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                if let tval = (dvalue["All Artist"]) as? [String] {
                                    album.allArtists = tval
                                }
                                if let tval = (dvalue["All Writers"]) as? [String] {
                                    album.writers = tval
                                }
                                if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                    if let tval = (trval["Mix Engineer"]) as? [String] {
                                        album.mixEngineers = tval
                                    }
                                }
                                if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                    if let tval = (trval["Mastering Engineer"]) as? [String] {
                                        album.masteringEngineers = tval
                                    }
                                }
                                if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                    if let tval = (trval["Recording Engineer"]) as? [String] {
                                        album.recordingEngineers = tval
                                    }
                                }
                                if let merchandise = (dvalue["Merch"]) {
                                    album.merch = (merchandise as! [String])
                                }
                                if let tval = (dvalue["Songs"]) as? [String] {
                                    album.songs = tval
                                }
                                if let tval = (dvalue["Instrumentals"]) as? [String] {
                                    album.instrumentals = tval
                                }
                                if let tval = (dvalue["Videos"]) as? [String] {
                                    album.videos = tval
                                }
                                if let tval = (dvalue["Tracks"]) as? [String:String] {
                                    album.tracks = tval
                                }
                                if let tval = (dvalue["Manual Image URL"]) as? String {
                                    album.manualImageURL = tval
                                }
                                if let tval = (dvalue["Manual Preview URL"]) as? String {
                                    album.manualPreviewURL = tval
                                }
                                if let tval = (dvalue["Industry Certified"] as? Bool) {
                                    album.industryCerified = tval
                                }
                                if let tval = (dvalue["Verification Level"] as? String) {
                                    album.verificationLevel = Character(tval)
                                }
                                if let tval = (dvalue["Deluxes"] as? [String]) {
                                    album.deluxes = tval
                                }
                                if let tval = (dvalue["Other Versions"] as? [String]) {
                                    album.otherVersions = tval
                                }
                                if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                                    let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                                    if let tval = (taval["Standard Edition"] as? String) {
                                        deluxe.standardEdition = tval
                                    }
                                    if let tval = (taval["Status"] as? Bool) {
                                        deluxe.status = tval
                                    }
                                    album.isDeluxe = deluxe
                                }
                                if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                    let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                                    if let tval = (taval["Standard Edition"] as? String) {
                                        deluxe.standardEdition = tval
                                    }
                                    if let tval = (taval["Status"] as? Bool) {
                                        deluxe.status = tval
                                    }
                                    album.isOtherVersion = deluxe
                                }
                                
                                
                                album.name = temp[0] as! String
                                album.mainArtist = temp[1] as! Array<String>
                                album.producers = temp[2] as! Array<String>
                                album.favoritesOverall = temp[3] as! Int
                                album.toneDeafAppId = temp[4] as! String
                                album.numberofTracks = temp[5] as! Int
                                album.timeRegisteredToApp = temp[6] as! String
                                album.dateRegisteredToApp = temp[7] as! String
                                album.isActive = temp[8] as! Bool
                            }
                            if dkey.contains("APPL") == true {
                                let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Artists"] as! String)
                                temp.append(dvalue["Date Released On Apple"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Album URL"] as! String)
                                //temp.append(dvalue["Number of Favorites"] as! Int)
                                temp.append(dvalue["Number of Tracks"] as! Int)
                                temp.append(dvalue["Apple Music Id"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                appleData.name = temp[0] as! String
                                appleData.artist = temp[1] as! String
                                appleData.dateReleasedApple = temp[2] as! String
                                appleData.timeIA = temp[3] as! String
                                appleData.dateIA = temp[4] as! String
                                appleData.imageURL = temp[5] as! String
                                appleData.url = temp[6] as! String
                                //appleData. = temp[6] as! Int
                                appleData.trackCount = temp[7] as! Int
                                appleData.appleId = temp[8] as! String
                                appleData.isActive = temp[9] as! Bool
                                
                                album.apple = appleData
                            }
                            if dkey.contains("SPTY") == true {
                                let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Artists"] as! [[String:String]])
                                temp.append(dvalue["UPC"] as! String)
                                temp.append(dvalue["Date Released On Spotify"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Album URL"] as! String)
                                temp.append(dvalue["Album URI"] as! String)
                                //temp.append(dvalue["Number of Favorites"] as! Int)
                                temp.append(dvalue["Number of Tracks"] as! Int)
                                temp.append(dvalue["Spotify Id"] as! String)
                                
                                spotifyData.name = temp[0] as! String
                                spotifyData.artist = temp[1] as! [[String:String]]
                                spotifyData.upc = temp[2] as! String
                                spotifyData.dateReleasedSpotify = temp[3] as! String
                                spotifyData.timeIA = temp[4] as! String
                                spotifyData.dateIA = temp[5] as! String
                                spotifyData.imageURL = temp[6] as! String
                                spotifyData.url = temp[7] as! String
                                spotifyData.uri = temp[8] as! String
                                //spotifyData. = temp[10] as! Bool
                                spotifyData.trackNumberTotal = temp[9] as! Int
                                spotifyData.spotifyId = temp[10] as! String
                                
                                album.spotify = spotifyData
                                
                            }
                            if dkey.contains(soundcloudMusicContentType) == true {
                                let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                soundcloud.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                album.soundcloud = soundcloud
                            }
                            if dkey.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                youtubeMusic.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                album.youtubeMusic = youtubeMusic
                            }
                            if dkey.contains(amazonMusicContentType) == true {
                                let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                amazon.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                album.amazon = amazon
                            }
                            if dkey.contains(deezerMusicContentType) == true {
                                let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String:Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["UPC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Album URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String:Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.upc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.timeIA = temp[7] as! String
                                deezer.deezerID = temp[8] as! Int
                                deezer.dateIA = temp[9] as! String
                                
                                album.deezer = deezer
                            }
                            if dkey.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                spinrilla.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                album.spinrilla = spinrilla
                            }
                            if dkey.contains(napsterMusicContentType) == true {
                                let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                napster.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                album.napster = napster
                            }
                            if dkey.contains(tidalMusicContentType) == true {
                                let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                tidal.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                album.tidal = tidal
                            }
                            if dkey == "Videos" {
                                    for diva in up.children {
                                        let lsat = diva as! DataSnapshot
                                        let vidkey = lsat.key
                                        if vidkey == "Official" {
                                            var temp:Array<Any> = []
                                            let vvalue = lsat.value! as! [String:Any]
                                            temp.append(vvalue["id"] as! String)
                                            album.officialAlbumVideo = temp[0] as! String
                                        }
                                    }
                            }
                        }
                        contentFeaturedArray.append(album)
                    }
                }
                
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllAlbumsFromDatabase(page: Int, end:String, completion: @escaping (([AlbumData]) -> Void)) {
        var contentFeaturedArray:[AlbumData] = []
        Database.database().reference().child("Music Content").child("Albums").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if data.key != "All Album IDs" {
                    var youtubeAlts:[String] = []
                    let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                    for sub in data.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        //print(up.key)
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = up.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Main Artist"] as! Array<String>)
                            temp.append(dvalue["All Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Number Of Tracks"] as! Int)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            if let tval = (dvalue["All Artist"]) as? [String] {
                                album.allArtists = tval
                            }
                            if let tval = (dvalue["All Writers"]) as? [String] {
                                album.writers = tval
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mix Engineer"]) as? [String] {
                                    album.mixEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mastering Engineer"]) as? [String] {
                                    album.masteringEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Recording Engineer"]) as? [String] {
                                    album.recordingEngineers = tval
                                }
                            }
                            if let merchandise = (dvalue["Merch"]) {
                                album.merch = (merchandise as! [String])
                            }
                            if let tval = (dvalue["Songs"]) as? [String] {
                                album.songs = tval
                            }
                            if let tval = (dvalue["Instrumentals"]) as? [String] {
                                album.instrumentals = tval
                            }
                            if let tval = (dvalue["Videos"]) as? [String] {
                                album.videos = tval
                            }
                            if let tval = (dvalue["Tracks"]) as? [String:String] {
                                album.tracks = tval
                            }
                            if let tval = (dvalue["Manual Image URL"]) as? String {
                                album.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"]) as? String {
                                album.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                album.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                album.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Deluxes"] as? [String]) {
                                album.deluxes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                album.otherVersions = tval
                            }
                        if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                            let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isDeluxe = deluxe
                        }
                        if let taval = (dvalue["Other Version"] as? NSDictionary) {
                            let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isOtherVersion = deluxe
                        }
                            
                            
                            
                            album.name = temp[0] as! String
                            album.mainArtist = temp[1] as! Array<String>
                            album.producers = temp[2] as! Array<String>
                            album.favoritesOverall = temp[3] as! Int
                            album.toneDeafAppId = temp[4] as! String
                            album.numberofTracks = temp[5] as! Int
                            album.timeRegisteredToApp = temp[6] as! String
                            album.dateRegisteredToApp = temp[7] as! String
                            album.isActive = temp[8] as! Bool
                        }
                        if dkey.contains("APPL") == true {
                            let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            appleData.name = temp[0] as! String
                            appleData.artist = temp[1] as! String
                            appleData.dateReleasedApple = temp[2] as! String
                            appleData.timeIA = temp[3] as! String
                            appleData.dateIA = temp[4] as! String
                            appleData.imageURL = temp[5] as! String
                            appleData.url = temp[6] as! String
                            //appleData. = temp[6] as! Int
                            appleData.trackCount = temp[7] as! Int
                            appleData.appleId = temp[8] as! String
                            appleData.isActive = temp[9] as! Bool
                            
                            album.apple = appleData
                        }
                        if dkey.contains("SPTY") == true {
                            let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! [[String:String]])
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Album URI"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            
                            spotifyData.name = temp[0] as! String
                            spotifyData.artist = temp[1] as! [[String:String]]
                            spotifyData.upc = temp[2] as! String
                            spotifyData.dateReleasedSpotify = temp[3] as! String
                            spotifyData.timeIA = temp[4] as! String
                            spotifyData.dateIA = temp[5] as! String
                            spotifyData.imageURL = temp[6] as! String
                            spotifyData.url = temp[7] as! String
                            spotifyData.uri = temp[8] as! String
                            //spotifyData. = temp[10] as! Bool
                            spotifyData.trackNumberTotal = temp[9] as! Int
                            spotifyData.spotifyId = temp[10] as! String
                            
                            album.spotify = spotifyData
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            album.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            youtubeMusic.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            amazon.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String:Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String:Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.upc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.timeIA = temp[7] as! String
                            deezer.deezerID = temp[8] as! Int
                            deezer.dateIA = temp[9] as! String
                            
                            album.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            spinrilla.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            album.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            napster.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            tidal.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in up.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        album.officialAlbumVideo = temp[0] as! String
                                    }
                                }
                        }
                    }
                    contentFeaturedArray.append(album)
                }
    
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllAlbumsFromDatabase(page: Int, end:String, exceptions: [AlbumData], completion: @escaping (([AlbumData]) -> Void)) {
        var contentFeaturedArray:[AlbumData] = []
        Database.database().reference().child("Music Content").child("Albums").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if data.key != "All Album IDs" {
                    let split = data.key.components(separatedBy: "--")
                    //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                    if !(cepArr.contains(String("\(split[2])"))){
                        var youtubeAlts:[String] = []
                        let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                        for sub in data.children {
                            let up = sub as! DataSnapshot
                            let dkey = up.key
                            //print(up.key)
                            if dkey == "REQUIRED" {
                                var temp:Array<Any> = []
                                let dvalue = up.value as! [String:Any]
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Main Artist"] as! Array<String>)
                                temp.append(dvalue["All Producers"] as! Array<String>)
                                temp.append(dvalue["Number of Favorites Overall"] as! Int)
                                temp.append(dvalue["Tone Deaf App Id"] as! String)
                                temp.append(dvalue["Number Of Tracks"] as! Int)
                                temp.append(dvalue["Time Registered To App"] as! String)
                                temp.append(dvalue["Date Registered To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                if let tval = (dvalue["All Artist"]) as? [String] {
                                    album.allArtists = tval
                                }
                                if let tval = (dvalue["All Writers"]) as? [String] {
                                    album.writers = tval
                                }
                                if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                    if let tval = (trval["Mix Engineer"]) as? [String] {
                                        album.mixEngineers = tval
                                    }
                                }
                                if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                    if let tval = (trval["Mastering Engineer"]) as? [String] {
                                        album.masteringEngineers = tval
                                    }
                                }
                                if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                    if let tval = (trval["Recording Engineer"]) as? [String] {
                                        album.recordingEngineers = tval
                                    }
                                }
                                if let merchandise = (dvalue["Merch"]) {
                                    album.merch = (merchandise as! [String])
                                }
                                if let tval = (dvalue["Songs"]) as? [String] {
                                    album.songs = tval
                                }
                                if let tval = (dvalue["Instrumentals"]) as? [String] {
                                    album.instrumentals = tval
                                }
                                if let tval = (dvalue["Videos"]) as? [String] {
                                    album.videos = tval
                                }
                                if let tval = (dvalue["Tracks"]) as? [String:String] {
                                    album.tracks = tval
                                }
                                if let tval = (dvalue["Manual Image URL"]) as? String {
                                    album.manualImageURL = tval
                                }
                                if let tval = (dvalue["Manual Preview URL"]) as? String {
                                    album.manualPreviewURL = tval
                                }
                                if let tval = (dvalue["Industry Certified"] as? Bool) {
                                    album.industryCerified = tval
                                }
                                if let tval = (dvalue["Verification Level"] as? String) {
                                    album.verificationLevel = Character(tval)
                                }
                                if let tval = (dvalue["Deluxes"] as? [String]) {
                                    album.deluxes = tval
                                }
                                if let tval = (dvalue["Other Versions"] as? [String]) {
                                    album.otherVersions = tval
                                }
                                if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                                    let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                                    if let tval = (taval["Standard Edition"] as? String) {
                                        deluxe.standardEdition = tval
                                    }
                                    if let tval = (taval["Status"] as? Bool) {
                                        deluxe.status = tval
                                    }
                                    album.isDeluxe = deluxe
                                }
                                if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                    let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                                    if let tval = (taval["Standard Edition"] as? String) {
                                        deluxe.standardEdition = tval
                                    }
                                    if let tval = (taval["Status"] as? Bool) {
                                        deluxe.status = tval
                                    }
                                    album.isOtherVersion = deluxe
                                }
                                
                                
                                album.name = temp[0] as! String
                                album.mainArtist = temp[1] as! Array<String>
                                album.producers = temp[2] as! Array<String>
                                album.favoritesOverall = temp[3] as! Int
                                album.toneDeafAppId = temp[4] as! String
                                album.numberofTracks = temp[5] as! Int
                                album.timeRegisteredToApp = temp[6] as! String
                                album.dateRegisteredToApp = temp[7] as! String
                                album.isActive = temp[8] as! Bool
                            }
                            if dkey.contains("APPL") == true {
                                let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Artists"] as! String)
                                temp.append(dvalue["Date Released On Apple"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Album URL"] as! String)
                                //temp.append(dvalue["Number of Favorites"] as! Int)
                                temp.append(dvalue["Number of Tracks"] as! Int)
                                temp.append(dvalue["Apple Music Id"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                appleData.name = temp[0] as! String
                                appleData.artist = temp[1] as! String
                                appleData.dateReleasedApple = temp[2] as! String
                                appleData.timeIA = temp[3] as! String
                                appleData.dateIA = temp[4] as! String
                                appleData.imageURL = temp[5] as! String
                                appleData.url = temp[6] as! String
                                //appleData. = temp[6] as! Int
                                appleData.trackCount = temp[7] as! Int
                                appleData.appleId = temp[8] as! String
                                appleData.isActive = temp[9] as! Bool
                                
                                album.apple = appleData
                            }
                            if dkey.contains("SPTY") == true {
                                let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Artists"] as! [[String:String]])
                                temp.append(dvalue["UPC"] as! String)
                                temp.append(dvalue["Date Released On Spotify"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Album URL"] as! String)
                                temp.append(dvalue["Album URI"] as! String)
                                //temp.append(dvalue["Number of Favorites"] as! Int)
                                temp.append(dvalue["Number of Tracks"] as! Int)
                                temp.append(dvalue["Spotify Id"] as! String)
                                
                                spotifyData.name = temp[0] as! String
                                spotifyData.artist = temp[1] as! [[String:String]]
                                spotifyData.upc = temp[2] as! String
                                spotifyData.dateReleasedSpotify = temp[3] as! String
                                spotifyData.timeIA = temp[4] as! String
                                spotifyData.dateIA = temp[5] as! String
                                spotifyData.imageURL = temp[6] as! String
                                spotifyData.url = temp[7] as! String
                                spotifyData.uri = temp[8] as! String
                                //spotifyData. = temp[10] as! Bool
                                spotifyData.trackNumberTotal = temp[9] as! Int
                                spotifyData.spotifyId = temp[10] as! String
                                
                                album.spotify = spotifyData
                                
                            }
                            if dkey.contains(soundcloudMusicContentType) == true {
                                let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                soundcloud.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                album.soundcloud = soundcloud
                            }
                            if dkey.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                youtubeMusic.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                album.youtubeMusic = youtubeMusic
                            }
                            if dkey.contains(amazonMusicContentType) == true {
                                let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                amazon.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                album.amazon = amazon
                            }
                            if dkey.contains(deezerMusicContentType) == true {
                                let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String:Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["UPC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Album URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String:Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.upc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.timeIA = temp[7] as! String
                                deezer.deezerID = temp[8] as! Int
                                deezer.dateIA = temp[9] as! String
                                
                                album.deezer = deezer
                            }
                            if dkey.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                spinrilla.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                album.spinrilla = spinrilla
                            }
                            if dkey.contains(napsterMusicContentType) == true {
                                let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                napster.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                album.napster = napster
                            }
                            if dkey.contains(tidalMusicContentType) == true {
                                let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = up.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                tidal.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                album.tidal = tidal
                            }
                            if dkey == "Videos" {
                                    for diva in up.children {
                                        let lsat = diva as! DataSnapshot
                                        let vidkey = lsat.key
                                        if vidkey == "Official" {
                                            var temp:Array<Any> = []
                                            let vvalue = lsat.value! as! [String:Any]
                                            temp.append(vvalue["id"] as! String)
                                            album.officialAlbumVideo = temp[0] as! String
                                        }
                                    }
                            }
                        }
                        contentFeaturedArray.append(album)
                    }
                }
    
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllInstrumentalsFromDatabase(page: Int, completion: @escaping (([InstrumentalData]) -> Void)) {
        var contentFeaturedArray:[InstrumentalData] = []
        Database.database().reference().child("Music Content").child("Instrumentals").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if key != "All Instrumental IDs" {
                    let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    var ltemp:Array<Any> = []
                    let dvalue = data.value as! [String:Any]
                    ltemp.append(dvalue["Name"] as! String)
                    ltemp.append(dvalue["Producers"] as! Array<String>)
                    ltemp.append(dvalue["Audio URL"] as! String)
                    ltemp.append(dvalue["Time Uploaded To App"] as! String)
                    ltemp.append(dvalue["Date Uploaded To App"] as! String)
                    ltemp.append(dvalue["Duration"] as! String)
                    ltemp.append(dvalue["Number of Favorites"] as! Int)
                    ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                    ltemp.append(dvalue["Active Status"] as! Bool)
                    if let tval = (dvalue["Songs"] as? [String]) {
                        instrumental.songs = tval
                    }
                    if let tval = (dvalue["Albums"] as? [String]) {
                        instrumental.albums = tval
                    }
                    if let eval = (dvalue["Engineers"] as? NSDictionary) {
                        if let tval = (eval["Mix Engineer"] as? [String]) {
                            instrumental.mixEngineer = tval
                        }
                        if let tval = (eval["Mastering Engineer"] as? [String]) {
                            instrumental.masteringEngineer = tval
                        }
                    }
                    if let tval = (dvalue["Videos"] as? [String]) {
                        instrumental.videos = tval
                    }
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        instrumental.merch = (merchandise)
                    }
                    if let tval = (dvalue["Artists"] as? [String]) {
                        instrumental.artist = tval
                    }
                    if let tval = (dvalue["Manual Image URL"] as? String) {
                        instrumental.manualImageURL = tval
                    }
                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                        instrumental.manualPreviewURL = tval
                    }
                    if let tval = (dvalue["Official Video"] as? String) {
                        instrumental.officialVideo = tval
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        instrumental.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        instrumental.verificationLevel = Character(tval)
                    }
                    for chi in data.children {
                        let da = chi as! DataSnapshot
                        let lilkey = da.key
                        if lilkey == "Store Info" {
                            let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                            let botval = da.value as! [String:Any]
                            
                            inststore.retailPrice = botval["Retail Price"] as! Double
                            inststore.merchType = botval["Merch Type"] as! String
                            inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                            let predate = botval["Date Uploaded"] as! String
                            guard predate != "" else {return}
                            let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                            inststore.dateUploaded = date
                            if let ite = botval["Sale Price"] as? Double {
                                inststore.salePrice = ite
                            }
                            if let ite = botval["Quantity"] as? Int {
                                inststore.quantity = ite
                            }
                            instrumental.storeInfo = inststore
                        }
                    }
                    instrumental.instrumentalName = ltemp[0] as! String
                    instrumental.producers = ltemp[1] as! Array<String>
                    instrumental.audioURL = ltemp[2] as! String
                    instrumental.timeRegisteredToApp = ltemp[3] as! String
                    instrumental.dateRegisteredToApp = ltemp[4] as! String
                    instrumental.duration = ltemp[5] as! String
                    instrumental.favoritesOverall = ltemp[6] as! Int
                    instrumental.toneDeafAppId = ltemp[7] as! String
                    instrumental.isActive = ltemp[8] as! Bool
                    let songname = ltemp[0] as! String
                    instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                    for val in data.children {
                        var temp:Array<Any> = []
                        let cont = val as! DataSnapshot
                        let chi = cont.key
                        if (chi).contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Spotify"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist 1"] as! String)
                            temp.append(svalue["Artist 1 URL"] as! String)
                            temp.append(svalue["Artist 2"] as! String)
                            temp.append(svalue["Artist 2 URL"] as! String)
                            temp.append(svalue["Artist 3"] as! String)
                            temp.append(svalue["Artist 3 URL"] as! String)
                            temp.append(svalue["Artist 4"] as! String)
                            temp.append(svalue["Artist 4 URL"] as! String)
                            temp.append(svalue["Artist 5"] as! String)
                            temp.append(svalue["Artist 5 URL"] as! String)
                            temp.append(svalue["Artist 6"] as! String)
                            temp.append(svalue["Artist 6 URL"] as! String)
                            temp.append(svalue["Album Type"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            instrumental.spotify = spotify
                        }
                        if (chi).contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Apple"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist"] as! String)
                            temp.append(svalue["Album Name"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Apple Music Id"] as! String)
                            ltemp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = ltemp[15] as! Bool
                            
                            instrumental.apple = apple
                        }
                        if chi.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                                soundcloud.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                instrumental.soundcloud = soundcloud
                            }
                            if chi.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                youtubeMusic.url = temp[0] as! String
                                youtubeMusic.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.youtubeMusic = youtubeMusic
                            }
                            if chi.contains(amazonMusicContentType) == true {
                                let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                amazon.url = temp[0] as! String
                                amazon.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.amazon = amazon
                            }
                            if chi.contains(deezerMusicContentType) == true {
                                let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String : Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["ISRC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Song URL"] as! String)
                                temp.append(dvalue["Preview URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String : Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.isrc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.previewURL = temp[7] as! String
                                deezer.timeIA = temp[8] as! String
                                deezer.deezerID = temp[9] as! Int
                                deezer.dateIA = temp[10] as! String
                                deezer.isActive = temp[11] as! Bool
                                
                                instrumental.deezer = deezer
                            }
                            if chi.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                spinrilla.url = temp[0] as! String
                                spinrilla.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                instrumental.spinrilla = spinrilla
                            }
                            if chi.contains(napsterMusicContentType) == true {
                                let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                napster.url = temp[0] as! String
                                napster.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.napster = napster
                            }
                            if chi.contains(tidalMusicContentType) == true {
                                let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                tidal.url = temp[0] as! String
                                tidal.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.tidal = tidal
                            }
                        }
                contentFeaturedArray.append(instrumental)
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllInstrumentalsFromDatabase(page: Int, exceptions: [InstrumentalData], completion: @escaping (([InstrumentalData]) -> Void)) {
        var contentFeaturedArray:[InstrumentalData] = []
        Database.database().reference().child("Music Content").child("Instrumentals").queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if key != "All Instrumental IDs" {
                    
                    let split = data.key.components(separatedBy: "--")
                    if !(cepArr.contains(String("\(split[2])"))) {
                        let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                        var ltemp:Array<Any> = []
                        let dvalue = data.value as! [String:Any]
                        ltemp.append(dvalue["Name"] as! String)
                        ltemp.append(dvalue["Producers"] as! Array<String>)
                        ltemp.append(dvalue["Audio URL"] as! String)
                        ltemp.append(dvalue["Time Uploaded To App"] as! String)
                        ltemp.append(dvalue["Date Uploaded To App"] as! String)
                        ltemp.append(dvalue["Duration"] as! String)
                        ltemp.append(dvalue["Number of Favorites"] as! Int)
                        ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                        ltemp.append(dvalue["Active Status"] as! Bool)
                        if let tval = (dvalue["Songs"] as? [String]) {
                            instrumental.songs = tval
                        }
                        if let tval = (dvalue["Albums"] as? [String]) {
                            instrumental.albums = tval
                        }
                        if let tval = (dvalue["Mix Engineers"] as? [String]) {
                            instrumental.mixEngineer = tval
                        }
                        if let tval = (dvalue["Mastering Engineers"] as? [String]) {
                            instrumental.masteringEngineer = tval
                        }
                        if let tval = (dvalue["Videos"] as? [String]) {
                            instrumental.videos = tval
                        }
                        if let merchandise = (dvalue["Merch"] as? [String]) {
                            instrumental.merch = (merchandise)
                        }
                        if let tval = (dvalue["Artists"] as? [String]) {
                            instrumental.artist = tval
                        }
                        if let tval = (dvalue["Manual Image URL"] as? String) {
                            instrumental.manualImageURL = tval
                        }
                        if let tval = (dvalue["Manual Preview URL"] as? String) {
                            instrumental.manualPreviewURL = tval
                        }
                        if let tval = (dvalue["Official Video"] as? String) {
                            instrumental.officialVideo = tval
                        }
                        if let tval = (dvalue["Industry Certified"] as? Bool) {
                            instrumental.industryCerified = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            instrumental.verificationLevel = Character(tval)
                        }
                        for chi in data.children {
                            let da = chi as! DataSnapshot
                            let lilkey = da.key
                            if lilkey == "Store Info" {
                                let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                                let botval = da.value as! [String:Any]
                                
                                inststore.retailPrice = botval["Retail Price"] as! Double
                                inststore.merchType = botval["Merch Type"] as! String
                                inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                                let predate = botval["Date Uploaded"] as! String
                                guard predate != "" else {return}
                                let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                inststore.dateUploaded = date
                                if let ite = botval["Sale Price"] as? Double {
                                    inststore.salePrice = ite
                                }
                                if let ite = botval["Quantity"] as? Int {
                                    inststore.quantity = ite
                                }
                                instrumental.storeInfo = inststore
                            }
                        }
                        instrumental.instrumentalName = ltemp[0] as! String
                        instrumental.producers = ltemp[1] as! Array<String>
                        instrumental.audioURL = ltemp[2] as! String
                        instrumental.timeRegisteredToApp = ltemp[3] as! String
                        instrumental.dateRegisteredToApp = ltemp[4] as! String
                        instrumental.duration = ltemp[5] as! String
                        instrumental.favoritesOverall = ltemp[6] as! Int
                        instrumental.toneDeafAppId = ltemp[7] as! String
                        instrumental.isActive = ltemp[8] as! Bool
                        let songname = ltemp[0] as! String
                        instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                        for val in data.children {
                            var temp:Array<Any> = []
                            let cont = val as! DataSnapshot
                            let chi = cont.key
                            if (chi).contains(spotifyMusicContentType) == true {
                                let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                                
                                let svalue = cont.value as! [String:Any]
                                temp.append(svalue["Name"] as! String)
                                temp.append(svalue["Duration"] as! String)
                                temp.append(svalue["Date Uploaded To App"] as! String)
                                temp.append(svalue["Date Released On Spotify"] as! String)
                                temp.append(svalue["Preview URL"] as! String)
                                temp.append(svalue["ISRC"] as! String)
                                temp.append(svalue["Number of Favorites"] as! Int)
                                temp.append(svalue["Artwork URL"] as! String)
                                temp.append(svalue["Time Uploaded To App"] as! String)
                                temp.append(svalue["Song URL"] as! String)
                                temp.append(svalue["Explicity"] as! Bool)
                                temp.append(svalue["Artist 1"] as! String)
                                temp.append(svalue["Artist 1 URL"] as! String)
                                temp.append(svalue["Artist 2"] as! String)
                                temp.append(svalue["Artist 2 URL"] as! String)
                                temp.append(svalue["Artist 3"] as! String)
                                temp.append(svalue["Artist 3 URL"] as! String)
                                temp.append(svalue["Artist 4"] as! String)
                                temp.append(svalue["Artist 4 URL"] as! String)
                                temp.append(svalue["Artist 5"] as! String)
                                temp.append(svalue["Artist 5 URL"] as! String)
                                temp.append(svalue["Artist 6"] as! String)
                                temp.append(svalue["Artist 6 URL"] as! String)
                                temp.append(svalue["Album Type"] as! String)
                                temp.append(svalue["Track Number"] as! Int)
                                temp.append(svalue["Spotify Id"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                spotify.spotifyName = temp[0] as! String
                                spotify.spotifyDuration = temp[1] as! String
                                spotify.spotifyDateIA = temp[2] as! String
                                spotify.spotifyDateSPT = temp[3] as! String
                                spotify.spotifyPreviewURL = temp[4] as! String
                                spotify.spotifyISRC = temp[5] as! String
                                spotify.spotifyFavorites = temp[6] as! Int
                                spotify.spotifyArtworkURL = temp[7] as! String
                                spotify.spotifyTimeIA = temp[8] as! String
                                spotify.spotifySongURL = temp[9] as! String
                                spotify.spotifyExplicity = temp[10] as! Bool
                                spotify.spotifyArtist1 = temp[11] as! String
                                spotify.spotifyArtist1URL = temp[12] as! String
                                spotify.spotifyArtist2 = temp[13] as! String
                                spotify.spotifyArtist2URL = temp[14] as! String
                                spotify.spotifyArtist3 = temp[15] as! String
                                spotify.spotifyArtist3URL = temp[16] as! String
                                spotify.spotifyArtist4 = temp[17] as! String
                                spotify.spotifyArtist4URL = temp[18] as! String
                                spotify.spotifyArtist5 = temp[19] as! String
                                spotify.spotifyArtist5URL = temp[20] as! String
                                spotify.spotifyArtist6 = temp[21] as! String
                                spotify.spotifyArtis6URL = temp[22] as! String
                                spotify.spotifyAlbumType = temp[23] as! String
                                spotify.spotifyTrackNumber = temp[24] as! Int
                                spotify.spotifyId = temp[25] as! String
                                spotify.isActive = temp[26] as! Bool
                                
                                instrumental.spotify = spotify
                            }
                            if (chi).contains(appleMusicContentType) == true {
                                let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                                var temp:Array<Any> = []
                                let svalue = cont.value as! [String:Any]
                                temp.append(svalue["Name"] as! String)
                                temp.append(svalue["Duration"] as! String)
                                temp.append(svalue["Date Uploaded To App"] as! String)
                                temp.append(svalue["Date Released On Apple"] as! String)
                                temp.append(svalue["Preview URL"] as! String)
                                temp.append(svalue["ISRC"] as! String)
                                temp.append(svalue["Number of Favorites"] as! Int)
                                temp.append(svalue["Artwork URL"] as! String)
                                temp.append(svalue["Time Uploaded To App"] as! String)
                                temp.append(svalue["Song URL"] as! String)
                                temp.append(svalue["Explicity"] as! Bool)
                                temp.append(svalue["Artist"] as! String)
                                temp.append(svalue["Album Name"] as! String)
                                temp.append(svalue["Track Number"] as! Int)
                                temp.append(svalue["Apple Music Id"] as! String)
                                ltemp.append(dvalue["Active Status"] as! Bool)
                                
                                apple.appleName = temp[0] as! String
                                apple.appleDuration = temp[1] as! String
                                apple.appleDateIA = temp[2] as! String
                                apple.appleDateAPPL = temp[3] as! String
                                apple.applePreviewURL = temp[4] as! String
                                apple.appleISRC = temp[5] as! String
                                apple.appleFavorites = temp[6] as! Int
                                apple.appleArtworkURL = temp[7] as! String
                                apple.appleTimeIA = temp[8] as! String
                                apple.appleSongURL = temp[9] as! String
                                apple.appleExplicity = temp[10] as! Bool
                                apple.appleArtist = temp[11] as! String
                                apple.appleAlbumName = temp[12] as! String
                                apple.appleTrackNumber = temp[13] as! Int
                                apple.appleMusicId = temp[14] as! String
                                apple.isActive = ltemp[15] as! Bool
                                
                                instrumental.apple = apple
                            }
                            if chi.contains(soundcloudMusicContentType) == true {
                                let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                soundcloud.url = temp[0] as! String
                                soundcloud.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                instrumental.soundcloud = soundcloud
                            }
                            if chi.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                youtubeMusic.url = temp[0] as! String
                                youtubeMusic.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.youtubeMusic = youtubeMusic
                            }
                            if chi.contains(amazonMusicContentType) == true {
                                let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                amazon.url = temp[0] as! String
                                amazon.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.amazon = amazon
                            }
                            if chi.contains(deezerMusicContentType) == true {
                                let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String : Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["ISRC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Song URL"] as! String)
                                temp.append(dvalue["Preview URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String : Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.isrc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.previewURL = temp[7] as! String
                                deezer.timeIA = temp[8] as! String
                                deezer.deezerID = temp[9] as! Int
                                deezer.dateIA = temp[10] as! String
                                deezer.isActive = temp[11] as! Bool
                                
                                instrumental.deezer = deezer
                            }
                            if chi.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                spinrilla.url = temp[0] as! String
                                spinrilla.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                instrumental.spinrilla = spinrilla
                            }
                            if chi.contains(napsterMusicContentType) == true {
                                let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                napster.url = temp[0] as! String
                                napster.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.napster = napster
                            }
                            if chi.contains(tidalMusicContentType) == true {
                                let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                tidal.url = temp[0] as! String
                                tidal.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.tidal = tidal
                            }
                        }
                        
                        contentFeaturedArray.append(instrumental)
                    }
                }
            }
                completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllInstrumentalsFromDatabase(page: Int, exceptions: [InstrumentalData], end:String, completion: @escaping (([InstrumentalData]) -> Void)) {
        var contentFeaturedArray:[InstrumentalData] = []
        Database.database().reference().child("Music Content").child("Instrumentals").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
            var cepArr:[String] = []
            for song in exceptions {
                cepArr.append("\(song.toneDeafAppId)")
            }
            //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if data.key != "All Instrumental IDs" {
                    
                    let split = data.key.components(separatedBy: "--")
                    //print("skey ", String("\(split[3])Ã†\(split[1])"), "ex ", exceptions)
                    if !(cepArr.contains(String("\(split[2])"))){
                        let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                        var ltemp:Array<Any> = []
                        let dvalue = data.value as! [String:Any]
                        ltemp.append(dvalue["Name"] as! String)
                        ltemp.append(dvalue["Producers"] as! Array<String>)
                        ltemp.append(dvalue["Audio URL"] as! String)
                        ltemp.append(dvalue["Time Uploaded To App"] as! String)
                        ltemp.append(dvalue["Date Uploaded To App"] as! String)
                        ltemp.append(dvalue["Duration"] as! String)
                        ltemp.append(dvalue["Number of Favorites"] as! Int)
                        ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                        ltemp.append(dvalue["Active Status"] as! Bool)
                        if let tval = (dvalue["Songs"] as? [String]) {
                            instrumental.songs = tval
                        }
                        if let tval = (dvalue["Albums"] as? [String]) {
                            instrumental.albums = tval
                        }
                        if let tval = (dvalue["Mix Engineers"] as? [String]) {
                            instrumental.mixEngineer = tval
                        }
                        if let tval = (dvalue["Mastering Engineers"] as? [String]) {
                            instrumental.masteringEngineer = tval
                        }
                        if let tval = (dvalue["Videos"] as? [String]) {
                            instrumental.videos = tval
                        }
                        if let merchandise = (dvalue["Merch"] as? [String]) {
                            instrumental.merch = (merchandise)
                        }
                        if let tval = (dvalue["Artists"] as? [String]) {
                            instrumental.artist = tval
                        }
                        if let tval = (dvalue["Manual Image URL"] as? String) {
                            instrumental.manualImageURL = tval
                        }
                        if let tval = (dvalue["Manual Preview URL"] as? String) {
                            instrumental.manualPreviewURL = tval
                        }
                        if let tval = (dvalue["Industry Certified"] as? Bool) {
                            instrumental.industryCerified = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            instrumental.verificationLevel = Character(tval)
                        }
                        for chi in data.children {
                            let da = chi as! DataSnapshot
                            let lilkey = da.key
                            if lilkey == "Store Info" {
                                let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                                let botval = da.value as! [String:Any]
                                
                                inststore.retailPrice = botval["Retail Price"] as! Double
                                inststore.merchType = botval["Merch Type"] as! String
                                inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                                let predate = botval["Date Uploaded"] as! String
                                guard predate != "" else {return}
                                let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                inststore.dateUploaded = date
                                if let ite = botval["Sale Price"] as? Double {
                                    inststore.salePrice = ite
                                }
                                if let ite = botval["Quantity"] as? Int {
                                    inststore.quantity = ite
                                }
                                instrumental.storeInfo = inststore
                            }
                            if lilkey == "Videos" {
                                for dis in da.children {
                                    let fha = dis as! DataSnapshot
                                    let dvalue = fha.value as! [String:Any]
                                    if let tval = (dvalue["Official"] as? String) {
                                        instrumental.officialVideo = tval
                                    }
                                }
                            }
                        }
                        instrumental.instrumentalName = ltemp[0] as! String
                        instrumental.producers = ltemp[1] as! Array<String>
                        instrumental.audioURL = ltemp[2] as! String
                        instrumental.timeRegisteredToApp = ltemp[3] as! String
                        instrumental.dateRegisteredToApp = ltemp[4] as! String
                        instrumental.duration = ltemp[5] as! String
                        instrumental.favoritesOverall = ltemp[6] as! Int
                        instrumental.toneDeafAppId = ltemp[7] as! String
                        instrumental.isActive = ltemp[8] as! Bool
                        let songname = ltemp[0] as! String
                        instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                        for val in data.children {
                            var temp:Array<Any> = []
                            let cont = val as! DataSnapshot
                            let chi = cont.key
                            if (chi).contains(spotifyMusicContentType) == true {
                                let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                                
                                let svalue = cont.value as! [String:Any]
                                temp.append(svalue["Name"] as! String)
                                temp.append(svalue["Duration"] as! String)
                                temp.append(svalue["Date Uploaded To App"] as! String)
                                temp.append(svalue["Date Released On Spotify"] as! String)
                                temp.append(svalue["Preview URL"] as! String)
                                temp.append(svalue["ISRC"] as! String)
                                temp.append(svalue["Number of Favorites"] as! Int)
                                temp.append(svalue["Artwork URL"] as! String)
                                temp.append(svalue["Time Uploaded To App"] as! String)
                                temp.append(svalue["Song URL"] as! String)
                                temp.append(svalue["Explicity"] as! Bool)
                                temp.append(svalue["Artist 1"] as! String)
                                temp.append(svalue["Artist 1 URL"] as! String)
                                temp.append(svalue["Artist 2"] as! String)
                                temp.append(svalue["Artist 2 URL"] as! String)
                                temp.append(svalue["Artist 3"] as! String)
                                temp.append(svalue["Artist 3 URL"] as! String)
                                temp.append(svalue["Artist 4"] as! String)
                                temp.append(svalue["Artist 4 URL"] as! String)
                                temp.append(svalue["Artist 5"] as! String)
                                temp.append(svalue["Artist 5 URL"] as! String)
                                temp.append(svalue["Artist 6"] as! String)
                                temp.append(svalue["Artist 6 URL"] as! String)
                                temp.append(svalue["Album Type"] as! String)
                                temp.append(svalue["Track Number"] as! Int)
                                temp.append(svalue["Spotify Id"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                spotify.spotifyName = temp[0] as! String
                                spotify.spotifyDuration = temp[1] as! String
                                spotify.spotifyDateIA = temp[2] as! String
                                spotify.spotifyDateSPT = temp[3] as! String
                                spotify.spotifyPreviewURL = temp[4] as! String
                                spotify.spotifyISRC = temp[5] as! String
                                spotify.spotifyFavorites = temp[6] as! Int
                                spotify.spotifyArtworkURL = temp[7] as! String
                                spotify.spotifyTimeIA = temp[8] as! String
                                spotify.spotifySongURL = temp[9] as! String
                                spotify.spotifyExplicity = temp[10] as! Bool
                                spotify.spotifyArtist1 = temp[11] as! String
                                spotify.spotifyArtist1URL = temp[12] as! String
                                spotify.spotifyArtist2 = temp[13] as! String
                                spotify.spotifyArtist2URL = temp[14] as! String
                                spotify.spotifyArtist3 = temp[15] as! String
                                spotify.spotifyArtist3URL = temp[16] as! String
                                spotify.spotifyArtist4 = temp[17] as! String
                                spotify.spotifyArtist4URL = temp[18] as! String
                                spotify.spotifyArtist5 = temp[19] as! String
                                spotify.spotifyArtist5URL = temp[20] as! String
                                spotify.spotifyArtist6 = temp[21] as! String
                                spotify.spotifyArtis6URL = temp[22] as! String
                                spotify.spotifyAlbumType = temp[23] as! String
                                spotify.spotifyTrackNumber = temp[24] as! Int
                                spotify.spotifyId = temp[25] as! String
                                spotify.isActive = temp[26] as! Bool
                                
                                instrumental.spotify = spotify
                            }
                            if (chi).contains(appleMusicContentType) == true {
                                let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                                var temp:Array<Any> = []
                                let svalue = cont.value as! [String:Any]
                                temp.append(svalue["Name"] as! String)
                                temp.append(svalue["Duration"] as! String)
                                temp.append(svalue["Date Uploaded To App"] as! String)
                                temp.append(svalue["Date Released On Apple"] as! String)
                                temp.append(svalue["Preview URL"] as! String)
                                temp.append(svalue["ISRC"] as! String)
                                temp.append(svalue["Number of Favorites"] as! Int)
                                temp.append(svalue["Artwork URL"] as! String)
                                temp.append(svalue["Time Uploaded To App"] as! String)
                                temp.append(svalue["Song URL"] as! String)
                                temp.append(svalue["Explicity"] as! Bool)
                                temp.append(svalue["Artist"] as! String)
                                temp.append(svalue["Album Name"] as! String)
                                temp.append(svalue["Track Number"] as! Int)
                                temp.append(svalue["Apple Music Id"] as! String)
                                ltemp.append(dvalue["Active Status"] as! Bool)
                                
                                apple.appleName = temp[0] as! String
                                apple.appleDuration = temp[1] as! String
                                apple.appleDateIA = temp[2] as! String
                                apple.appleDateAPPL = temp[3] as! String
                                apple.applePreviewURL = temp[4] as! String
                                apple.appleISRC = temp[5] as! String
                                apple.appleFavorites = temp[6] as! Int
                                apple.appleArtworkURL = temp[7] as! String
                                apple.appleTimeIA = temp[8] as! String
                                apple.appleSongURL = temp[9] as! String
                                apple.appleExplicity = temp[10] as! Bool
                                apple.appleArtist = temp[11] as! String
                                apple.appleAlbumName = temp[12] as! String
                                apple.appleTrackNumber = temp[13] as! Int
                                apple.appleMusicId = temp[14] as! String
                                apple.isActive = ltemp[15] as! Bool
                                
                                instrumental.apple = apple
                            }
                            if chi.contains(soundcloudMusicContentType) == true {
                                let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                soundcloud.url = temp[0] as! String
                                soundcloud.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                instrumental.soundcloud = soundcloud
                            }
                            if chi.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                youtubeMusic.url = temp[0] as! String
                                youtubeMusic.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.youtubeMusic = youtubeMusic
                            }
                            if chi.contains(amazonMusicContentType) == true {
                                let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                amazon.url = temp[0] as! String
                                amazon.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.amazon = amazon
                            }
                            if chi.contains(deezerMusicContentType) == true {
                                let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String : Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["ISRC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Song URL"] as! String)
                                temp.append(dvalue["Preview URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String : Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.isrc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.previewURL = temp[7] as! String
                                deezer.timeIA = temp[8] as! String
                                deezer.deezerID = temp[9] as! Int
                                deezer.dateIA = temp[10] as! String
                                deezer.isActive = temp[11] as! Bool
                                
                                instrumental.deezer = deezer
                            }
                            if chi.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                spinrilla.url = temp[0] as! String
                                spinrilla.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                instrumental.spinrilla = spinrilla
                            }
                            if chi.contains(napsterMusicContentType) == true {
                                let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                napster.url = temp[0] as! String
                                napster.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.napster = napster
                            }
                            if chi.contains(tidalMusicContentType) == true {
                                let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                tidal.url = temp[0] as! String
                                tidal.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.tidal = tidal
                            }
                        }
                        contentFeaturedArray.append(instrumental)
                    }
                }
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    func fetchAllInstrumentalsFromDatabase(page: Int, end:String, completion: @escaping (([InstrumentalData]) -> Void)) {
        var contentFeaturedArray:[InstrumentalData] = []
        Database.database().reference().child("Music Content").child("Instrumentals").queryOrderedByKey().queryStarting(atValue: end).queryLimited(toFirst: UInt(page)).observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                    
                let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                var ltemp:Array<Any> = []
                let dvalue = data.value as! [String:Any]
                ltemp.append(dvalue["Name"] as! String)
                ltemp.append(dvalue["Producers"] as! Array<String>)
                ltemp.append(dvalue["Audio URL"] as! String)
                ltemp.append(dvalue["Time Uploaded To App"] as! String)
                ltemp.append(dvalue["Date Uploaded To App"] as! String)
                ltemp.append(dvalue["Duration"] as! String)
                ltemp.append(dvalue["Number of Favorites"] as! Int)
                ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                ltemp.append(dvalue["Active Status"] as! Bool)
                if let tval = (dvalue["Songs"] as? [String]) {
                    instrumental.songs = tval
                }
                if let tval = (dvalue["Albums"] as? [String]) {
                    instrumental.albums = tval
                }
                if let tval = (dvalue["Mix Engineers"] as? [String]) {
                    instrumental.mixEngineer = tval
                }
                if let tval = (dvalue["Mastering Engineers"] as? [String]) {
                    instrumental.masteringEngineer = tval
                }
                if let tval = (dvalue["Videos"] as? [String]) {
                    instrumental.videos = tval
                }
                if let merchandise = (dvalue["Merch"] as? [String]) {
                    instrumental.merch = (merchandise)
                }
                if let tval = (dvalue["Artists"] as? [String]) {
                    instrumental.artist = tval
                }
                if let tval = (dvalue["Manual Image URL"] as? String) {
                    instrumental.manualImageURL = tval
                }
                if let tval = (dvalue["Manual Preview URL"] as? String) {
                    instrumental.manualPreviewURL = tval
                }
                if let tval = (dvalue["Industry Certified"] as? Bool) {
                    instrumental.industryCerified = tval
                }
                if let tval = (dvalue["Verification Level"] as? String) {
                    instrumental.verificationLevel = Character(tval)
                }
                for chi in data.children {
                    let da = chi as! DataSnapshot
                    let lilkey = da.key
                    if lilkey == "Store Info" {
                        let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                        let botval = da.value as! [String:Any]
                        
                        inststore.retailPrice = botval["Retail Price"] as! Double
                        inststore.merchType = botval["Merch Type"] as! String
                        inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                        let predate = botval["Date Uploaded"] as! String
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        inststore.dateUploaded = date
                        if let ite = botval["Sale Price"] as? Double {
                            inststore.salePrice = ite
                        }
                        if let ite = botval["Quantity"] as? Int {
                            inststore.quantity = ite
                        }
                        instrumental.storeInfo = inststore
                    }
                    if lilkey == "Videos" {
                        for dis in da.children {
                            let fha = dis as! DataSnapshot
                            let dvalue = fha.value as! [String:Any]
                            if let tval = (dvalue["Official"] as? String) {
                                instrumental.officialVideo = tval
                            }
                        }
                    }
                }
                instrumental.instrumentalName = ltemp[0] as! String
                instrumental.producers = ltemp[1] as! Array<String>
                instrumental.audioURL = ltemp[2] as! String
                instrumental.timeRegisteredToApp = ltemp[3] as! String
                instrumental.dateRegisteredToApp = ltemp[4] as! String
                instrumental.duration = ltemp[5] as! String
                instrumental.favoritesOverall = ltemp[6] as! Int
                instrumental.toneDeafAppId = ltemp[7] as! String
                instrumental.isActive = ltemp[8] as! Bool
                let songname = ltemp[0] as! String
                instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                for val in data.children {
                    var temp:Array<Any> = []
                    let cont = val as! DataSnapshot
                    let chi = cont.key
                    if (chi).contains(spotifyMusicContentType) == true {
                        let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                        
                        let svalue = cont.value as! [String:Any]
                        temp.append(svalue["Name"] as! String)
                        temp.append(svalue["Duration"] as! String)
                        temp.append(svalue["Date Uploaded To App"] as! String)
                        temp.append(svalue["Date Released On Spotify"] as! String)
                        temp.append(svalue["Preview URL"] as! String)
                        temp.append(svalue["ISRC"] as! String)
                        temp.append(svalue["Number of Favorites"] as! Int)
                        temp.append(svalue["Artwork URL"] as! String)
                        temp.append(svalue["Time Uploaded To App"] as! String)
                        temp.append(svalue["Song URL"] as! String)
                        temp.append(svalue["Explicity"] as! Bool)
                        temp.append(svalue["Artist 1"] as! String)
                        temp.append(svalue["Artist 1 URL"] as! String)
                        temp.append(svalue["Artist 2"] as! String)
                        temp.append(svalue["Artist 2 URL"] as! String)
                        temp.append(svalue["Artist 3"] as! String)
                        temp.append(svalue["Artist 3 URL"] as! String)
                        temp.append(svalue["Artist 4"] as! String)
                        temp.append(svalue["Artist 4 URL"] as! String)
                        temp.append(svalue["Artist 5"] as! String)
                        temp.append(svalue["Artist 5 URL"] as! String)
                        temp.append(svalue["Artist 6"] as! String)
                        temp.append(svalue["Artist 6 URL"] as! String)
                        temp.append(svalue["Album Type"] as! String)
                        temp.append(svalue["Track Number"] as! Int)
                        temp.append(svalue["Spotify Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        spotify.spotifyName = temp[0] as! String
                        spotify.spotifyDuration = temp[1] as! String
                        spotify.spotifyDateIA = temp[2] as! String
                        spotify.spotifyDateSPT = temp[3] as! String
                        spotify.spotifyPreviewURL = temp[4] as! String
                        spotify.spotifyISRC = temp[5] as! String
                        spotify.spotifyFavorites = temp[6] as! Int
                        spotify.spotifyArtworkURL = temp[7] as! String
                        spotify.spotifyTimeIA = temp[8] as! String
                        spotify.spotifySongURL = temp[9] as! String
                        spotify.spotifyExplicity = temp[10] as! Bool
                        spotify.spotifyArtist1 = temp[11] as! String
                        spotify.spotifyArtist1URL = temp[12] as! String
                        spotify.spotifyArtist2 = temp[13] as! String
                        spotify.spotifyArtist2URL = temp[14] as! String
                        spotify.spotifyArtist3 = temp[15] as! String
                        spotify.spotifyArtist3URL = temp[16] as! String
                        spotify.spotifyArtist4 = temp[17] as! String
                        spotify.spotifyArtist4URL = temp[18] as! String
                        spotify.spotifyArtist5 = temp[19] as! String
                        spotify.spotifyArtist5URL = temp[20] as! String
                        spotify.spotifyArtist6 = temp[21] as! String
                        spotify.spotifyArtis6URL = temp[22] as! String
                        spotify.spotifyAlbumType = temp[23] as! String
                        spotify.spotifyTrackNumber = temp[24] as! Int
                        spotify.spotifyId = temp[25] as! String
                        spotify.isActive = temp[26] as! Bool
                        
                        instrumental.spotify = spotify
                    }
                    if (chi).contains(appleMusicContentType) == true {
                        let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                        var temp:Array<Any> = []
                        let svalue = cont.value as! [String:Any]
                        temp.append(svalue["Name"] as! String)
                        temp.append(svalue["Duration"] as! String)
                        temp.append(svalue["Date Uploaded To App"] as! String)
                        temp.append(svalue["Date Released On Apple"] as! String)
                        temp.append(svalue["Preview URL"] as! String)
                        temp.append(svalue["ISRC"] as! String)
                        temp.append(svalue["Number of Favorites"] as! Int)
                        temp.append(svalue["Artwork URL"] as! String)
                        temp.append(svalue["Time Uploaded To App"] as! String)
                        temp.append(svalue["Song URL"] as! String)
                        temp.append(svalue["Explicity"] as! Bool)
                        temp.append(svalue["Artist"] as! String)
                        temp.append(svalue["Album Name"] as! String)
                        temp.append(svalue["Track Number"] as! Int)
                        temp.append(svalue["Apple Music Id"] as! String)
                        ltemp.append(dvalue["Active Status"] as! Bool)
                        
                        apple.appleName = temp[0] as! String
                        apple.appleDuration = temp[1] as! String
                        apple.appleDateIA = temp[2] as! String
                        apple.appleDateAPPL = temp[3] as! String
                        apple.applePreviewURL = temp[4] as! String
                        apple.appleISRC = temp[5] as! String
                        apple.appleFavorites = temp[6] as! Int
                        apple.appleArtworkURL = temp[7] as! String
                        apple.appleTimeIA = temp[8] as! String
                        apple.appleSongURL = temp[9] as! String
                        apple.appleExplicity = temp[10] as! Bool
                        apple.appleArtist = temp[11] as! String
                        apple.appleAlbumName = temp[12] as! String
                        apple.appleTrackNumber = temp[13] as! Int
                        apple.appleMusicId = temp[14] as! String
                        apple.isActive = ltemp[15] as! Bool
                        
                        instrumental.apple = apple
                    }
                    if chi.contains(soundcloudMusicContentType) == true {
                        let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = cont.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        soundcloud.url = temp[0] as! String
                            soundcloud.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            instrumental.soundcloud = soundcloud
                        }
                        if chi.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            youtubeMusic.url = temp[0] as! String
                            youtubeMusic.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            instrumental.youtubeMusic = youtubeMusic
                        }
                        if chi.contains(amazonMusicContentType) == true {
                            let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            amazon.url = temp[0] as! String
                            amazon.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            instrumental.amazon = amazon
                        }
                        if chi.contains(deezerMusicContentType) == true {
                            let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String : Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String : Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.isrc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.previewURL = temp[7] as! String
                            deezer.timeIA = temp[8] as! String
                            deezer.deezerID = temp[9] as! Int
                            deezer.dateIA = temp[10] as! String
                            deezer.isActive = temp[11] as! Bool
                            
                            instrumental.deezer = deezer
                        }
                        if chi.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            spinrilla.url = temp[0] as! String
                            spinrilla.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            instrumental.spinrilla = spinrilla
                        }
                        if chi.contains(napsterMusicContentType) == true {
                            let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            napster.url = temp[0] as! String
                            napster.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            instrumental.napster = napster
                        }
                        if chi.contains(tidalMusicContentType) == true {
                            let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            tidal.url = temp[0] as! String
                            tidal.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            instrumental.tidal = tidal
                        }
                    }
                contentFeaturedArray.append(instrumental)
            }
            completion(contentFeaturedArray)
            
        })
    }
    
    
    func fetchAllContentFromDatabase(completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("All Content IDs").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            let content = snapshot.value as! [String]
            completion(content)
            
        })
    }
    
    
    
    
    func getSongOfTheDayContent(completion: @escaping ((String, String) -> Void)) {
        var songYesterday:String!
        var songToday:String!
        
        Database.database().reference().child("Current Featured Content").child("Song of The Day").observeSingleEvent(of: .value, with: { snapshot in
                //print(snapshot)
            var count = 0
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if key.contains("Today") == true {
                    print(data.value)
                    let dvalue = data.value as! NSDictionary
                    songToday = dvalue["id"] as! String
                }
                if key.contains("Yesterday") == true {
                    let dvalue = data.value as! NSDictionary
                    songYesterday = dvalue["id"] as! String
                }
                count+=1
//                print("XCOUUUUU ", count)
                if count == 2 {
                    completion(songToday,songYesterday)
                }
            }
            
            
        })
    }
    
    func getBeatOfTheDayContent(completion: @escaping ((String, String) -> Void)) {
        var beatYesterday:String!
        var beatToday:String!
        Database.database().reference().child("Current Featured Content").child("Beat of The Day").observeSingleEvent(of: .value, with: { snapshot in
                //print(snapshot)
            var count = 0
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if key.contains("Today") == true {
                    print(data.value)
                    let dvalue = data.value as! NSDictionary
                    beatToday = dvalue["id"] as! String
                }
                if key.contains("Yesterday") == true {
                    let dvalue = data.value as! NSDictionary
                    beatYesterday = dvalue["id"] as! String
                }
                count+=1
                if count == 2 {
                    completion(beatToday,beatYesterday)
                }
            }
            
        })
    }
    
    func getDashboardLatestContent(completion: @escaping (([AnyObject]) -> Void)) {
        var contentFeaturedArray:[AnyObject] = []
        Database.database().reference().child("Music Content").observeSingleEvent(of: .value, with: {[weak self] snapshot in
            guard let strongSelf = self else {return}
            var datetemp:Array<Date> = []
            var snaptemp:Array<Date> = []
            //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let content = child as! DataSnapshot
                let key = content.key
                //print(key)
                if key.contains("Songs") == true {
                    for songg in content.children {
                        
                        let sing = songg as! DataSnapshot
                        let skey = sing.key
                        if skey != "All Song IDs" {
                            var earliestdate = Date()
                                var youtubeAlts:[String] = []
                            let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                            for kid in sing.children {
                                let sub = kid as! DataSnapshot
                                let dkey = sub.key
                                if dkey == "REQUIRED" {
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value as! [String:Any]
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Artist"] as! Array<String>)
                                    temp.append(dvalue["Producers"] as! Array<String>)
                                    temp.append(dvalue["Number of Favorites Overall"] as! Int)
                                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                        if let eng = engies1["Mix Engineer"] as? Array<String> {
                                            song.songMixEngineer = eng
                                        }
                                        if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                            song.songMasteringEngineer = eng
                                        }
                                        if let eng = engies1["Recording Engineer"] as? Array<String> {
                                            song.songRecordingEngineer = eng
                                        }
                                    }
                                    if let merchandise = (dvalue["Merch"] as? [String]) {
                                        song.merch = (merchandise)
                                    }
                                    if let tval = (dvalue["Instrumentals"] as? [String]) {
                                        song.instrumentals = tval
                                    }
                                    if let tval = (dvalue["Albums"] as? [String]) {
                                        song.albums = tval
                                    }
                                    if let tval = (dvalue["Videos"] as? [String]) {
                                        song.videos = tval
                                    }
                                    if let tval = (dvalue["Writers"] as? [String]) {
                                        song.songWriters = tval
                                    }
                                    if let tval = (dvalue["Manual Image URL"] as? String) {
                                        song.manualImageURL = tval
                                    }
                                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                                        song.manualPreviewURL = tval
                                    }
                                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                                        song.industryCerified = tval
                                    }
                                    if let tval = (dvalue["Verification Level"] as? String) {
                                        song.verificationLevel = Character(tval)
                                    }
                                    if let tval = (dvalue["Explicit"] as? Bool) {
                                        song.explicit = tval
                                    }
                                    if let tval = (dvalue["Date Registered To App"] as? String) {
                                        song.dateRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Time Registered To App"] as? String) {
                                        song.timeRegisteredToApp = tval
                                    }
                                    if let tval = (dvalue["Remixes"] as? [String]) {
                                        song.remixes = tval
                                    }
                                    if let tval = (dvalue["Other Versions"] as? [String]) {
                                        song.otherVersions = tval
                                    }
                                    if let taval = (dvalue["Remix"] as? NSDictionary) {
                                        let deluxe = SongRemixData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isRemix = deluxe
                                    }
                                    if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                        let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        song.isOtherVersion = deluxe
                                    }
                                    
                                    song.name = temp[0] as! String
                                    song.songArtist = temp[1] as! Array<String>
                                    song.songProducers = temp[2] as! Array<String>
                                    song.favoritesOverall = temp[3] as! Int
                                    song.toneDeafAppId = temp[4] as! String
                                    song.isActive = temp[5] as! Bool
                                }
                                if dkey.contains(appleMusicContentType) == true {
                                    let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Apple"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist"] as! String)
                                    temp.append(dvalue["Album Name"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Apple Music Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    apple.appleName = temp[0] as! String
                                    apple.appleDuration = temp[1] as! String
                                    apple.appleDateIA = temp[2] as! String
                                    apple.appleDateAPPL = temp[3] as! String
                                    apple.applePreviewURL = temp[4] as! String
                                    apple.appleISRC = temp[5] as! String
                                    apple.appleFavorites = temp[6] as! Int
                                    apple.appleArtworkURL = temp[7] as! String
                                    apple.appleTimeIA = temp[8] as! String
                                    apple.appleSongURL = temp[9] as! String
                                    apple.appleExplicity = temp[10] as! Bool
                                    apple.appleArtist = temp[11] as! String
                                    apple.appleAlbumName = temp[12] as! String
                                    apple.appleTrackNumber = temp[13] as! Int
                                    apple.appleMusicId = temp[14] as! String
                                    apple.isActive = temp[15] as! Bool
                                    
                                    song.apple = apple
                                    
                                }
                                if dkey.contains(spotifyMusicContentType) == true {
                                    let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Released On Spotify"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Explicity"] as! Bool)
                                    temp.append(dvalue["Artist 1"] as! String)
                                    temp.append(dvalue["Artist 1 URL"] as! String)
                                    temp.append(dvalue["Artist 2"] as! String)
                                    temp.append(dvalue["Artist 2 URL"] as! String)
                                    temp.append(dvalue["Artist 3"] as! String)
                                    temp.append(dvalue["Artist 3 URL"] as! String)
                                    temp.append(dvalue["Artist 4"] as! String)
                                    temp.append(dvalue["Artist 4 URL"] as! String)
                                    temp.append(dvalue["Artist 5"] as! String)
                                    temp.append(dvalue["Artist 5 URL"] as! String)
                                    temp.append(dvalue["Artist 6"] as! String)
                                    temp.append(dvalue["Artist 6 URL"] as! String)
                                    temp.append(dvalue["Album Type"] as! String)
                                    temp.append(dvalue["Track Number"] as! Int)
                                    temp.append(dvalue["Spotify Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    spotify.spotifyName = temp[0] as! String
                                    spotify.spotifyDuration = temp[1] as! String
                                    spotify.spotifyDateIA = temp[2] as! String
                                    spotify.spotifyDateSPT = temp[3] as! String
                                    spotify.spotifyPreviewURL = temp[4] as! String
                                    spotify.spotifyISRC = temp[5] as! String
                                    spotify.spotifyFavorites = temp[6] as! Int
                                    spotify.spotifyArtworkURL = temp[7] as! String
                                    spotify.spotifyTimeIA = temp[8] as! String
                                    spotify.spotifySongURL = temp[9] as! String
                                    spotify.spotifyExplicity = temp[10] as! Bool
                                    spotify.spotifyArtist1 = temp[11] as! String
                                    spotify.spotifyArtist1URL = temp[12] as! String
                                    spotify.spotifyArtist2 = temp[13] as! String
                                    spotify.spotifyArtist2URL = temp[14] as! String
                                    spotify.spotifyArtist3 = temp[15] as! String
                                    spotify.spotifyArtist3URL = temp[16] as! String
                                    spotify.spotifyArtist4 = temp[17] as! String
                                    spotify.spotifyArtist4URL = temp[18] as! String
                                    spotify.spotifyArtist5 = temp[19] as! String
                                    spotify.spotifyArtist5URL = temp[20] as! String
                                    spotify.spotifyArtist6 = temp[21] as! String
                                    spotify.spotifyArtis6URL = temp[22] as! String
                                    spotify.spotifyAlbumType = temp[23] as! String
                                    spotify.spotifyTrackNumber = temp[24] as! Int
                                    spotify.spotifyId = temp[25] as! String
                                    spotify.isActive = temp[26] as! Bool
                                    
                                    song.spotify = spotify
                                    
                                }
                                if dkey.contains(soundcloudMusicContentType) == true {
                                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    soundcloud.url = temp[0] as! String
                                    soundcloud.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    song.soundcloud = soundcloud
                                }
                                if dkey.contains(youtubeMusicContentType) == true {
                                    let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    youtubeMusic.url = temp[0] as! String
                                    youtubeMusic.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.youtubeMusic = youtubeMusic
                                }
                                if dkey.contains(amazonMusicContentType) == true {
                                    let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    amazon.url = temp[0] as! String
                                    amazon.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.amazon = amazon
                                }
                                if dkey.contains(deezerMusicContentType) == true {
                                    let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Date Released On Deezer"] as! String)
                                    temp.append(dvalue["Artist"] as! [[String : Any]])
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["Time Registered To App"] as! String)
                                    temp.append(dvalue["Deezer Music Id"] as! Int)
                                    temp.append(dvalue["Date Registered To App"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    deezer.deezerDate = temp[0] as! String
                                    deezer.artist = temp[1] as! [[String : Any]]
                                    deezer.imageurl = temp[2] as! String
                                    deezer.duration = temp[3] as! String
                                    deezer.isrc = temp[4] as! String
                                    deezer.name = temp[5] as! String
                                    deezer.url = temp[6] as! String
                                    deezer.previewURL = temp[7] as! String
                                    deezer.timeIA = temp[8] as! String
                                    deezer.deezerID = temp[9] as! Int
                                    deezer.dateIA = temp[10] as! String
                                    deezer.isActive = temp[11] as! Bool
                                    
                                    song.deezer = deezer
                                }
                                if dkey.contains(spinrillaMusicContentType) == true {
                                    let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    spinrilla.url = temp[0] as! String
                                    spinrilla.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Spinrilla"] != nil {
                                        spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                    }
                                    song.spinrilla = spinrilla
                                }
                                if dkey.contains(napsterMusicContentType) == true {
                                    let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    napster.url = temp[0] as! String
                                    napster.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        napster.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.napster = napster
                                }
                                if dkey.contains(tidalMusicContentType) == true {
                                    let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = sub.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    tidal.url = temp[0] as! String
                                    tidal.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    song.tidal = tidal
                                }
                                if dkey == "Videos" {
                                        for diva in sub.children {
                                            let lsat = diva as! DataSnapshot
                                            let vidkey = lsat.key
                                            if vidkey == "Official" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.officialVideo = temp[0] as! String
                                            }
                                            if vidkey == "Audio" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                song.audioVideo = temp[0] as! String
                                            }
                                        }
                                }
                                
                            }
                            
                            if song.isActive && song.verificationLevel != "U"  {
                                Comparisons.shared.getEarliestReleaseDate(song: song, completion: { dateReturned in
                                    let predate = dateReturned
                                    guard predate != "" else {return}
                                    let date = predate.date(format: "MM dd, yyyy")!
                                    if date < earliestdate {
                                        earliestdate = date
                                    }
                                    if  datetemp.count < 7 {
                                        //print(song.name)
                                        contentFeaturedArray.append(song)
                                        datetemp.append(earliestdate)
                                    } else if earliestdate > datetemp.min()! {
                                        if song != contentFeaturedArray[0] as? SongData && song != contentFeaturedArray[1] as? SongData && song != contentFeaturedArray[2] as? SongData && song != contentFeaturedArray[3] as? SongData && song != contentFeaturedArray[4] as? SongData && song != contentFeaturedArray[5] as? SongData && song != contentFeaturedArray[6] as? SongData {
                                            let it = datetemp.firstIndex(of: datetemp.min()!)
                                            datetemp.remove(at: it!)
                                            contentFeaturedArray.remove(at: it!)
                                            datetemp.append(earliestdate)
                                            contentFeaturedArray.append(song)
                                        }
                                    }
                                })
                            }
                        }
                        
                        }
                    }
                if key.contains("Videos") == true {
                    for child in content.children {
                        var earliestdate = Date()
                        let item = child as! DataSnapshot
                        let key = item.key
                        if key != "All Video IDs" {
                            let video = VideoData(title: "", toneDeafAppId: "", persons: nil, videographers: nil, albums: nil, instrumentals: nil, merch: nil, songs: nil, beats: nil, favorites: 0, type: "", timeIA: "", dateIA: "", viewsIA: 0, manualThumbnailURL: nil, isActive: false, youtube: nil, igtv: nil, instagramPost: nil, facebookPost: nil, worldstar: nil, twitter: nil, appleMusic: nil, tikTok: nil, industryCerified: nil, verificationLevel: nil)
                            for chi in item.children {
                                let data = chi as! DataSnapshot
                                let key = data.key
                                if key == "Active Status" {
                                    video.isActive = data.value  as! Bool
                                }
                                if key == "Albums" {
                                    video.albums = data.value as? [String]
                                }
                                if key == "Instrumentals" {
                                    if data.value as! [String] != [""] {
                                        video.instrumentals = data.value as? [String]
                                    }
                                }
                                if key == "Beats" {
                                    if data.value as! [String] != [""] {
                                        video.beats = data.value as? [String]
                                    }
                                }
                                if key == "Songs" {
                                    if data.value as! [String] != [""] {
                                        video.songs = data.value as? [String]
                                    }
                                }
                                if key == "Persons" {
                                    if data.value as! [String] != [""] {
                                        video.persons = data.value as? [String]
                                    }
                                }
                                if key == "Videographers" {
                                    if data.value as! [String] != [""] {
                                        video.videographers = data.value as? [String]
                                    }
                                }
                                if key == "Date Uploaded To App" {
                                    video.dateIA = data.value as! String
                                }
                                if key == "Time Uploaded To App" {
                                    video.timeIA = data.value as! String
                                }
                                if key == "Number of Favorites" {
                                    video.favorites = data.value as! Int
                                }
                                if key == "Views In App" {
                                    video.viewsIA = data.value as! Int
                                }
                                if key == "Title" {
                                    video.title = data.value as! String
                                }
                                if key == "Type" {
                                    video.type = data.value as! String
                                }
                                if key == "Tone Deaf App Video Id" {
                                    video.toneDeafAppId = data.value as! String
                                }
                                if key == "Manual Thumbnail URL" {
                                    video.manualThumbnailURL = (data.value as! String)
                                }
                                if key == "Industry Certified" {
                                    
                                    video.industryCerified = (data.value as? Bool)
                                }
                                if key == "Verification Level" {
                                    video.verificationLevel = Character(data.value as! String)
                                }
                                
                                if key == "Youtube" {
                                    
                                    
                                    for shi in data.children {
                                        let odata = shi as! DataSnapshot
                                        let okey = odata.key
                                        
                                        if okey.contains("YT") == true && !okey.contains("YTPL")  {
                                            if video.youtube == nil {
                                                video.youtube = []
                                            }
                                            let avideo = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                            //print(key)
                                            
                                            var temp:Array<Any> = []
                                            let avalue = item.value as! [String:Any]
                                            let ovalue = odata.value as! [String:Any]
                                            temp.append(ovalue["Channel Title"] as! String)
                                            temp.append(ovalue["Duration"] as! String)
                                            temp.append(ovalue["Date Uploaded To App"] as! String)
                                            temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                            temp.append(ovalue["Description"] as! String)
                                            temp.append(ovalue["Thumbnail URL"] as! String)
                                            temp.append(ovalue["Time Uploaded To App"] as! String)
                                            temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                            temp.append(ovalue["Title"] as! String)
                                            temp.append(ovalue["Video URL"] as! String)
                                            temp.append(avalue["Views In App"] as! Int)
                                            temp.append(ovalue["Youtube Id"] as! String)
                                            temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                            temp.append(ovalue["Type"] as! String)
                                            if let vid = (avalue["Views on Youtube"] as? Int) {
                                                avideo.viewsYT = vid
                                            }
                                            
                                            avideo.channelTitle = temp[0] as! String
                                            avideo.duration = temp[1] as! String
                                            avideo.dateIA = temp[2] as! String
                                            avideo.dateYT = temp[3] as! String
                                            avideo.description = temp[4] as! String
                                            //                        video.favorites = temp[5] as! Int
                                            avideo.thumbnailURL = temp[5] as! String
                                            avideo.timeIA = temp[6] as! String
                                            avideo.timeYT = temp[7] as! String
                                            avideo.title = temp[8] as! String
                                            avideo.url = temp[9] as! String
                                            avideo.viewsIA = temp[10] as! Int
                                            avideo.youtubeId = temp[11] as! String
                                            avideo.toneDeafAppId = temp[12] as! String
                                            avideo.type = temp[13] as! String
                                            video.youtube!.append(avideo)
                                            
                                            
                                        }
                                        
                                        if okey.contains("YTPL") == true {
                                            if video.youtube == nil {
                                                video.youtube = []
                                            }
                                            let avideo = YouTubeData(duration: nil, url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                            //print(key)
                                            
                                            var temp:Array<Any> = []
                                            let avalue = item.value as! [String:Any]
                                            let ovalue = odata.value as! [String:Any]
                                            temp.append(ovalue["Channel Title"] as! String)
                                            temp.append(ovalue["Date Uploaded To App"] as! String)
                                            temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                            temp.append(ovalue["Description"] as! String)
                                            temp.append(ovalue["Thumbnail URL"] as! String)
                                            temp.append(ovalue["Time Uploaded To App"] as! String)
                                            temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                            temp.append(ovalue["Title"] as! String)
                                            temp.append(ovalue["Video URL"] as! String)
                                            temp.append(avalue["Views In App"] as! Int)
                                            temp.append(ovalue["Youtube Id"] as! String)
                                            temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                            temp.append(ovalue["Type"] as! String)
                                            
                                            avideo.channelTitle = temp[0] as! String
                                            avideo.dateIA = temp[1] as! String
                                            avideo.dateYT = temp[2] as! String
                                            avideo.description = temp[3] as! String
                                            avideo.thumbnailURL = temp[4] as! String
                                            avideo.timeIA = temp[5] as! String
                                            avideo.timeYT = temp[6] as! String
                                            avideo.title = temp[7] as! String
                                            avideo.url = temp[8] as! String
                                            avideo.viewsIA = temp[9] as! Int
                                            avideo.youtubeId = temp[10] as! String
                                            avideo.toneDeafAppId = temp[11] as! String
                                            avideo.type = temp[12] as! String
                                            video.youtube!.append(avideo)
                                        }
                                    }
                                }
                                
                                if key == "Twitter" {
                                    for shi in data.children {
                                        let odata = shi as! DataSnapshot
                                        let okey = odata.key
                                        if video.twitter == nil {
                                            video.twitter = []
                                        }
                                        let avideo = TwitterTweetData(url: "", media: nil, twitterId: "", text: nil, dateTwitter: "", dateIA: "", timeIA: "", viewsIA: 0, isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = item.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(ovalue["Twitter Id"] as! String)
                                        temp.append(ovalue["Text"] as? String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Date Uploaded To Twitter"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Views In App"] as! Int)
                                        temp.append(ovalue["Active Status"] as! Bool)
                                        
                                        if let med = ovalue["Media"] as? [NSDictionary] {
                                            var medArr:[MediaDataForTwitter] = []
                                            for puppy in med {
                                                let tMed = MediaDataForTwitter(url: nil, mediaKey: nil, previewURL: nil, type: nil, contentType: nil)
                                                if let valval = puppy["Preview URL"] as? String {
                                                    tMed.previewURL = valval
                                                }
                                                if let valval = puppy["Media Key"] as? String {
                                                    tMed.mediaKey = valval
                                                }
                                                if let valval = puppy["Type"] as? String {
                                                    tMed.type = valval
                                                }
                                                medArr.append(tMed)
                                            }
                                            avideo.media = medArr
                                        }
                                        
                                        avideo.url = temp[0] as! String
                                        avideo.twitterId = temp[1] as! String
                                        avideo.text = temp[2] as? String
                                        avideo.dateIA = temp[3] as! String
                                        avideo.dateTwitter = temp[4] as! String
                                        avideo.timeIA = temp[5] as! String
                                        avideo.viewsIA = temp[6] as! Int
                                        avideo.isActive = temp[7] as! Bool
                                        
                                        
                                        
                                        video.twitter!.append(avideo)
                                        
                                    }
                                }
                                
                                if key == "Tik Tok" {
                                    for shi in data.children {
                                        let odata = shi as! DataSnapshot
                                        let okey = odata.key
                                        if video.tikTok == nil {
                                            video.tikTok = []
                                        }
                                        let avideo = TikTokData(url: "", dateIA: "", timeIa: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = item.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Active Status"] as! Bool)
                                        
                                        avideo.url = temp[0] as! String
                                        avideo.dateIA = temp[1] as! String
                                        avideo.timeIa = temp[2] as! String
                                        avideo.isActive = temp[3] as! Bool
                                        
                                        
                                        
                                        video.tikTok!.append(avideo)
                                        
                                    }
                                }
                                
                                if key == "Instagram" {
                                    for shi in data.children {
                                        let odata = shi as! DataSnapshot
                                        let okey = odata.key
                                        if video.instagramPost == nil {
                                            video.instagramPost = []
                                        }
                                        let avideo = InstagramPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = item.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Active Status"] as! Bool)
                                        
                                        avideo.url = temp[0] as! String
                                        avideo.dateIA = temp[1] as! String
                                        avideo.timeIa = temp[2] as! String
                                        avideo.isActive = temp[3] as! Bool
                                        
                                        
                                        
                                        video.instagramPost!.append(avideo)
                                        
                                    }
                                }
                                
                                if key == "Facebook" {
                                    for shi in data.children {
                                        let odata = shi as! DataSnapshot
                                        let okey = odata.key
                                        if video.facebookPost == nil {
                                            video.facebookPost = []
                                        }
                                        let avideo = FacebookPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = item.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Active Status"] as! Bool)
                                        
                                        avideo.url = temp[0] as! String
                                        avideo.dateIA = temp[1] as! String
                                        avideo.timeIa = temp[2] as! String
                                        avideo.isActive = temp[3] as! Bool
                                        
                                        
                                        
                                        video.facebookPost!.append(avideo)
                                        
                                    }
                                }
                                
                                if key == "Worldstar" {
                                    for shi in data.children {
                                        let odata = shi as! DataSnapshot
                                        let okey = odata.key
                                        if video.worldstar == nil {
                                            video.worldstar = []
                                        }
                                        let avideo = WorldstarData(url: "", dateIA: "", timeIa: "", isActive: false)
                                        //print(key)
                                        
                                        var temp:Array<Any> = []
                                        let avalue = item.value as! [String:Any]
                                        let ovalue = odata.value as! [String:Any]
                                        temp.append(ovalue["Video URL"] as! String)
                                        temp.append(ovalue["Date Uploaded To App"] as! String)
                                        temp.append(ovalue["Time Uploaded To App"] as! String)
                                        temp.append(ovalue["Active Status"] as! Bool)
                                        
                                        avideo.url = temp[0] as! String
                                        avideo.dateIA = temp[1] as! String
                                        avideo.timeIa = temp[2] as! String
                                        avideo.isActive = temp[3] as! Bool
                                        
                                        
                                        
                                        video.worldstar!.append(avideo)
                                        
                                    }
                                }
                                
                            }
                            
                            if video.isActive && video.verificationLevel != "U" {
                                Comparisons.shared.getEarliestReleaseDate(video: video, completion: { dateReturned in
                                    let predate = dateReturned
                                    guard predate != "" else {return}
                                    let date = predate.date(format: "MM dd, yyyy")!
                                    if date < earliestdate {
                                        earliestdate = date
                                    }
                                    if  datetemp.count < 7 {
                                        //print(song.name)
                                        contentFeaturedArray.append(video)
                                        datetemp.append(earliestdate)
                                    } else if earliestdate > datetemp.min()! {
                                        if video != contentFeaturedArray[0] as? VideoData && video != contentFeaturedArray[1] as? VideoData && video != contentFeaturedArray[2] as? VideoData && video != contentFeaturedArray[3] as? VideoData && video != contentFeaturedArray[4] as? VideoData && video != contentFeaturedArray[5] as? VideoData && video != contentFeaturedArray[6] as? VideoData {
                                            let it = datetemp.firstIndex(of: datetemp.min()!)
                                            datetemp.remove(at: it!)
                                            contentFeaturedArray.remove(at: it!)
                                            datetemp.append(earliestdate)
                                            contentFeaturedArray.append(video)
                                        }
                                    }
                                })
                            }
                        }
                       
                        
                    }
                }
                if key.contains("Albums") == true {
                    for songg in content.children {
                        
                        let sing = songg as! DataSnapshot
                        let skey = sing.key
                        if skey != "All Album IDs" {
                            var earliestdate = Date()
                            let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                            for sub in sing.children {
                                let up = sub as! DataSnapshot
                                let dkey = up.key
                                //print(up.key)
                                if dkey == "REQUIRED" {
                                    var temp:Array<Any> = []
                                    let dvalue = up.value as! [String:Any]
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Main Artist"] as! Array<String>)
                                    temp.append(dvalue["All Producers"] as! Array<String>)
                                    temp.append(dvalue["Number of Favorites Overall"] as! Int)
                                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                                    temp.append(dvalue["Number Of Tracks"] as! Int)
                                    temp.append(dvalue["Time Registered To App"] as! String)
                                    temp.append(dvalue["Date Registered To App"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    if let tval = (dvalue["All Artist"]) as? [String] {
                                        album.allArtists = tval
                                    }
                                    if let tval = (dvalue["All Writers"]) as? [String] {
                                        album.writers = tval
                                    }
                                    if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                        if let tval = (trval["Mix Engineer"]) as? [String] {
                                            album.mixEngineers = tval
                                        }
                                    }
                                    if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                        if let tval = (trval["Mastering Engineer"]) as? [String] {
                                            album.masteringEngineers = tval
                                        }
                                    }
                                    if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                        if let tval = (trval["Recording Engineer"]) as? [String] {
                                            album.recordingEngineers = tval
                                        }
                                    }
                                    if let merchandise = (dvalue["Merch"]) {
                                        album.merch = (merchandise as! [String])
                                    }
                                    if let tval = (dvalue["Songs"]) as? [String] {
                                        album.songs = tval
                                    }
                                    if let tval = (dvalue["Instrumentals"]) as? [String] {
                                        album.instrumentals = tval
                                    }
                                    if let tval = (dvalue["Videos"]) as? [String] {
                                        album.videos = tval
                                    }
                                    if let tval = (dvalue["Tracks"]) as? [String:String] {
                                        album.tracks = tval
                                    }
                                    if let tval = (dvalue["Manual Image URL"]) as? String {
                                        album.manualImageURL = tval
                                    }
                                    if let tval = (dvalue["Manual Preview URL"]) as? String {
                                        album.manualPreviewURL = tval
                                    }
                                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                                        album.industryCerified = tval
                                    }
                                    if let tval = (dvalue["Verification Level"] as? String) {
                                        album.verificationLevel = Character(tval)
                                    }
                                    if let tval = (dvalue["Deluxes"] as? [String]) {
                                        album.deluxes = tval
                                    }
                                    if let tval = (dvalue["Other Versions"] as? [String]) {
                                        album.otherVersions = tval
                                    }
                                    if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                                        let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        album.isDeluxe = deluxe
                                    }
                                    if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                        let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                                        if let tval = (taval["Standard Edition"] as? String) {
                                            deluxe.standardEdition = tval
                                        }
                                        if let tval = (taval["Status"] as? Bool) {
                                            deluxe.status = tval
                                        }
                                        album.isOtherVersion = deluxe
                                    }
                                    
                                    
                                    
                                    album.name = temp[0] as! String
                                    album.mainArtist = temp[1] as! Array<String>
                                    album.producers = temp[2] as! Array<String>
                                    album.favoritesOverall = temp[3] as! Int
                                    album.toneDeafAppId = temp[4] as! String
                                    album.numberofTracks = temp[5] as! Int
                                    album.timeRegisteredToApp = temp[6] as! String
                                    album.dateRegisteredToApp = temp[7] as! String
                                    album.isActive = temp[8] as! Bool
                                }
                                if dkey.contains("APPL") == true {
                                    let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Artists"] as! String)
                                    temp.append(dvalue["Date Released On Apple"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Album URL"] as! String)
                                    //temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Number of Tracks"] as! Int)
                                    temp.append(dvalue["Apple Music Id"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    appleData.name = temp[0] as! String
                                    appleData.artist = temp[1] as! String
                                    appleData.dateReleasedApple = temp[2] as! String
                                    appleData.timeIA = temp[3] as! String
                                    appleData.dateIA = temp[4] as! String
                                    appleData.imageURL = temp[5] as! String
                                    appleData.url = temp[6] as! String
                                    //appleData. = temp[6] as! Int
                                    appleData.trackCount = temp[7] as! Int
                                    appleData.appleId = temp[8] as! String
                                    appleData.isActive = temp[9] as! Bool
                                    
                                    album.apple = appleData
                                }
                                if dkey.contains("SPTY") == true {
                                    let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Artists"] as! [[String:String]])
                                    temp.append(dvalue["UPC"] as! String)
                                    temp.append(dvalue["Date Released On Spotify"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Album URL"] as! String)
                                    temp.append(dvalue["Album URI"] as! String)
                                    //temp.append(dvalue["Number of Favorites"] as! Int)
                                    temp.append(dvalue["Number of Tracks"] as! Int)
                                    temp.append(dvalue["Spotify Id"] as! String)
                                    
                                    spotifyData.name = temp[0] as! String
                                    spotifyData.artist = temp[1] as! [[String:String]]
                                    spotifyData.upc = temp[2] as! String
                                    spotifyData.dateReleasedSpotify = temp[3] as! String
                                    spotifyData.timeIA = temp[4] as! String
                                    spotifyData.dateIA = temp[5] as! String
                                    spotifyData.imageURL = temp[6] as! String
                                    spotifyData.url = temp[7] as! String
                                    spotifyData.uri = temp[8] as! String
                                    //spotifyData. = temp[10] as! Bool
                                    spotifyData.trackNumberTotal = temp[9] as! Int
                                    spotifyData.spotifyId = temp[10] as! String
                                    
                                    album.spotify = spotifyData
                                    
                                }
                                if dkey.contains(soundcloudMusicContentType) == true {
                                    let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    soundcloud.url = temp[0] as! String
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    album.soundcloud = soundcloud
                                }
                                if dkey.contains(youtubeMusicContentType) == true {
                                    let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    youtubeMusic.url = temp[0] as! String
                                    if dvalue["Artwork URL"] != nil {
                                        youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    album.youtubeMusic = youtubeMusic
                                }
                                if dkey.contains(amazonMusicContentType) == true {
                                    let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    amazon.url = temp[0] as! String
                                    if dvalue["Artwork URL"] != nil {
                                        amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    album.amazon = amazon
                                }
                                if dkey.contains(deezerMusicContentType) == true {
                                    let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Date Released On Deezer"] as! String)
                                    temp.append(dvalue["Artist"] as! [[String:Any]])
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["UPC"] as! String)
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Album URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Deezer Music Id"] as! Int)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    
                                    deezer.deezerDate = temp[0] as! String
                                    deezer.artist = temp[1] as! [[String:Any]]
                                    deezer.imageurl = temp[2] as! String
                                    deezer.duration = temp[3] as! String
                                    deezer.upc = temp[4] as! String
                                    deezer.name = temp[5] as! String
                                    deezer.url = temp[6] as! String
                                    deezer.timeIA = temp[7] as! String
                                    deezer.deezerID = temp[8] as! Int
                                    deezer.dateIA = temp[9] as! String
                                    
                                    album.deezer = deezer
                                }
                                if dkey.contains(spinrillaMusicContentType) == true {
                                    let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    spinrilla.url = temp[0] as! String
                                    if dvalue["Artwork URL"] != nil {
                                        spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Spinrilla"] != nil {
                                        spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                    }
                                    album.spinrilla = spinrilla
                                }
                                if dkey.contains(napsterMusicContentType) == true {
                                    let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    napster.url = temp[0] as! String
                                    if dvalue["Artwork URL"] != nil {
                                        napster.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    album.napster = napster
                                }
                                if dkey.contains(tidalMusicContentType) == true {
                                    let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = up.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    tidal.url = temp[0] as! String
                                    if dvalue["Artwork URL"] != nil {
                                        tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    album.tidal = tidal
                                }
                                if dkey == "Videos" {
                                        for diva in up.children {
                                            let lsat = diva as! DataSnapshot
                                            let vidkey = lsat.key
                                            if vidkey == "Official" {
                                                var temp:Array<Any> = []
                                                let vvalue = lsat.value! as! [String:Any]
                                                temp.append(vvalue["id"] as! String)
                                                album.officialAlbumVideo = temp[0] as! String
                                            }
                                        }
                                }
                            }
                            
                            if album.isActive && album.verificationLevel != "U"  {
                                Comparisons.shared.getEarliestReleaseDate(album: album, completion: { dateReturned in
                                    let predate = dateReturned
                                    guard predate != "" else {return}
                                    let date = predate.date(format: "MM dd, yyyy")!
                                    if date < earliestdate {
                                        earliestdate = date
                                    }
                                    if  datetemp.count < 7 {
                                        //print(song.name)
                                        contentFeaturedArray.append(album)
                                        datetemp.append(earliestdate)
                                    } else if earliestdate > datetemp.min()! {
                                        if album != contentFeaturedArray[0] as? AlbumData && album != contentFeaturedArray[1] as? AlbumData && album != contentFeaturedArray[2] as? AlbumData && album != contentFeaturedArray[3] as? AlbumData && album != contentFeaturedArray[4] as? AlbumData && album != contentFeaturedArray[5] as? AlbumData && album != contentFeaturedArray[6] as? AlbumData {
                                            let it = datetemp.firstIndex(of: datetemp.min()!)
                                            datetemp.remove(at: it!)
                                            contentFeaturedArray.remove(at: it!)
                                            datetemp.append(earliestdate)
                                            contentFeaturedArray.append(album)
                                        }
                                    }
                                })
                            }
                        }
                        
                        }
                    }
                    
                
                
            }
            //print(contentFeaturedArray)
            //print(datetemp)
            
            completion(contentFeaturedArray)
        })
    }
    
    func getLatestBeats(completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        Database.database().reference().child("Beats").observeSingleEvent(of: .value, with: {[weak self] snapshot in
            guard let strongSelf = self else {return}
            var datetemp:Array<Date> = []
            var timetemp:Array<Date> = []
            var snaptemp:Array<Date> = []
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let beakey = data.key
                let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                if beakey != "All Beat IDs" {
                    var temp:Array<Any> = []
                    let value = data.value as! [String:Any]
                    var typeArray:[String] = []
                    var soundArray:[String] = []
                    var time:String!
                    var date:String!
                    if let tval = value["Duration"] as? String {
                        beat.duration = tval
                    }
                    if let tval = value["Name"] as? String {
                        beat.name = tval
                    }
                    if let tval = value["Date"] as? String {
                        beat.date = tval
                        date = tval
                    }
                    if let tval = value["Number of Downloads"] as? Int {
                        beat.downloads = tval
                    }
                    if let tval = value["Wav Price"] as? Double {
                        beat.wavPrice = tval
                    }
                    if let tval = value["Lease Price"] as? Double {
                        beat.mp3Price = tval
                    }
                    if let tval = value["Exclusive Price"] as? Double {
                        beat.exclusivePrice = tval
                    }
                    if let tval = value["Time"] as? String {
                        beat.time = tval
                        time = tval
                    }
                    if let tval = value["Types"] as? [String] {
                        beat.types = tval
                    }
                    if let tval = value["Sounds"] as? [String] {
                        beat.sounds = tval
                    }
                    if let tval = value["Tempo"] as? Int {
                        beat.tempo = tval
                    }
                    if let tval = value["Audio"] as? String {
                        beat.audioURL = tval
                    }
                    if let tval = value["Image"] as? String {
                        beat.imageURL = tval
                    }
                    if let tval = value["beatId"] as? String {
                        beat.beatID = tval
                    }
                    if let tval = value["Price Type"] as? String {
                        beat.priceType = tval
                    }
                    if let tval = value["Producers"] as? [String] {
                        beat.producers = tval
                    }
                    if let tval = value["Tone Deaf App Id"] as? String {
                        beat.toneDeafAppId = tval
                    }
                    if let tval = value["Exclusive Files URL"] as? String {
                        beat.exclusiveFilesURL = tval
                    }
                    if let tval = value["Wav URL"] as? String {
                        beat.wavURL = tval
                    }
                    if let tval = value["Official Video"] as? String {
                        beat.officialVideo = tval
                    }
                    if let tval = value["Videos"] as? [String] {
                        beat.videos = tval
                    }
                    if let tval = value["Key"] as? String {
                        beat.key = tval
                    }
                    if let tval = value["Active Status"] as? Bool {
                        beat.isActive = tval
                    }
                    if let merchandise = (value["Merch"] as? [String]) {
                        beat.merch = (merchandise)
                    }
                    beat.datetime = "\(date)\(time)"
                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                    
                    for kiddo in data.children {
                        let dada = kiddo as! DataSnapshot
                        if dada.key.contains(soundcloudMusicContentType) == true {
                            var temp:Array<Any> = []
                            let dvalue = dada.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            beat.soundcloud = soundcloud
                        }
                    }
                    
                    let predate = value["Date"] as! String
                    guard predate != "" else {return}
                    //                    let date = predate.date(format: "MM dd, yyyy")!
                    
                    let pretime = value["Time"] as! String
                    guard pretime != "" else {return}
                    //                    let time = pretime.date(format: "HH:mm:ss a")!
                    
                    let predatetime = "\(predate) \(pretime)".replacingOccurrences(of: " AM", with: "").replacingOccurrences(of: " PM", with: "")
                    let datetime = predatetime.date(format: "MM dd, yyyy HH:mm:ss")!
                    //print(value["Name"] as! String, datetime)
                    //datetemp.sort(by: { $0.compare($1) == .orderedDescending })
                    
                    if beat.isActive {
                        if  datetemp.count < 5 {
                            contentFeaturedArray.append(beat)
                            datetemp.append(datetime)
                        } else if datetime > datetemp.min()! {
                            if beat.name != contentFeaturedArray[0].name && beat.name != contentFeaturedArray[1].name && beat.name != contentFeaturedArray[2].name && beat.name != contentFeaturedArray[3].name && beat.name != contentFeaturedArray[4].name {
                                let it = datetemp.firstIndex(of: datetemp.min()!)
                                datetemp.remove(at: it!)
                                contentFeaturedArray.remove(at: it!)
                                datetemp.append(datetime)
                                contentFeaturedArray.append(beat)
                            }
                        }
                    }
                }
            }
            //print(datetemp, timetemp)
            
            completion(contentFeaturedArray)
        })
    }
    
    func getLatestFreeBeats(completion: @escaping (([BeatData]) -> Void)) {
        var contentFeaturedArray:[BeatData] = []
        Database.database().reference().child("Beats").observeSingleEvent(of: .value, with: {[weak self] snapshot in
           // guard let strongSelf = self else {return}
            var datetemp:Array<Date> = []
            var timetemp:Array<Date> = []
            //var snaptemp:Array<Date> = []
            for item in snapshot.children {
                let bea = item as! DataSnapshot
                let key = bea.key
                let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                if key != "All Beat IDs" {
                    var temp:Array<Any> = []
                    let value = bea.value as! [String:Any]
                    var typeArray:[String] = []
                    var soundArray:[String] = []
                    var time:String!
                    var date:String!
                    if let tval = value["Duration"] as? String {
                        beat.duration = tval
                    }
                    if let tval = value["Name"] as? String {
                        beat.name = tval
                    }
                    if let tval = value["Date"] as? String {
                        beat.date = tval
                        date = tval
                    }
                    if let tval = value["Number of Downloads"] as? Int {
                        beat.downloads = tval
                    }
                    if let tval = value["Wav Price"] as? Double {
                        beat.wavPrice = tval
                    }
                    if let tval = value["Lease Price"] as? Double {
                        beat.mp3Price = tval
                    }
                    if let tval = value["Exclusive Price"] as? Double {
                        beat.exclusivePrice = tval
                    }
                    if let tval = value["Time"] as? String {
                        beat.time = tval
                        time = tval
                    }
                    if let tval = value["Types"] as? [String] {
                        beat.types = tval
                    }
                    if let tval = value["Sounds"] as? [String] {
                        beat.sounds = tval
                    }
                    if let tval = value["Tempo"] as? Int {
                        beat.tempo = tval
                    }
                    if let tval = value["Audio"] as? String {
                        beat.audioURL = tval
                    }
                    if let tval = value["Image"] as? String {
                        beat.imageURL = tval
                    }
                    if let tval = value["beatId"] as? String {
                        beat.beatID = tval
                    }
                    if let tval = value["Price Type"] as? String {
                        beat.priceType = tval
                    }
                    if let tval = value["Producers"] as? [String] {
                        beat.producers = tval
                    }
                    if let tval = value["Tone Deaf App Id"] as? String {
                        beat.toneDeafAppId = tval
                    }
                    if let tval = value["Exclusive Files URL"] as? String {
                        beat.exclusiveFilesURL = tval
                    }
                    if let tval = value["Wav URL"] as? String {
                        beat.wavURL = tval
                    }
                    if let tval = value["Official Video"] as? String {
                        beat.officialVideo = tval
                    }
                    if let tval = value["Videos"] as? [String] {
                        beat.videos = tval
                    }
                    if let tval = value["Key"] as? String {
                        beat.key = tval
                    }
                    if let tval = value["Active Status"] as? Bool {
                        beat.isActive = tval
                    }
                    if let merchandise = (value["Merch"] as? [String]) {
                        beat.merch = (merchandise)
                    }
                    beat.datetime = "\(date)\(time)"
                    let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                    for kiddo in bea.children {
                        let dada = kiddo as! DataSnapshot
                        if dada.key.contains(soundcloudMusicContentType) == true {
                            var temp:Array<Any> = []
                            let dvalue = dada.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            beat.soundcloud = soundcloud
                        }
                    }
                    
                    let predate = value["Date"] as! String
                    guard predate != "" else {return}
                    //                    let date = predate.date(format: "MM dd, yyyy")!
                    
                    let pretime = value["Time"] as! String
                    guard pretime != "" else {return}
                    //                    let time = pretime.date(format: "HH:mm:ss a")!
                    
                    let predatetime = "\(predate) \(pretime)".replacingOccurrences(of: " AM", with: "").replacingOccurrences(of: " PM", with: "")
                    let datetime = predatetime.date(format: "MM dd, yyyy HH:mm:ss")!
                    //print(value["Name"] as! String, datetime)
                    //datetemp.sort(by: { $0.compare($1) == .orderedDescending })
                    
                    if beat.isActive {
                        if beat.priceType == "Free" {
                            if  datetemp.count < 5 {
                                contentFeaturedArray.append(beat)
                                datetemp.append(datetime)
                            } else if datetime > datetemp.min()! {
                                if beat.name != contentFeaturedArray[0].name && beat.name != contentFeaturedArray[1].name && beat.name != contentFeaturedArray[2].name && beat.name != contentFeaturedArray[3].name && beat.name != contentFeaturedArray[4].name {
                                    let it = datetemp.firstIndex(of: datetemp.min()!)
                                    datetemp.remove(at: it!)
                                    contentFeaturedArray.remove(at: it!)
                                    datetemp.append(datetime)
                                    contentFeaturedArray.append(beat)
                                }
                            }
                        }
                    }
                }
                
                //print("ðŸ“™ beat \(beat)")
            }
            
            completion(contentFeaturedArray)
        })
    }
    
    
    
    
    
    
    func getMusicMainInfiniteScrollContent(completion: @escaping (([AnyObject]) -> Void)) {
        var contentFeaturedArray:[AnyObject] = []
        Database.database().reference().child("Current Featured Content").child("Main Music Infinite Scroll").observeSingleEvent(of: .value, with: { snapshot in
            for snap in snapshot.children {
                let item = snap as! DataSnapshot
                let key = item.key
                if key.contains("SONG") == true {
                    var youtubeAlts:[String] = []
                    let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    for kid in item.children {
                        let sub = kid as! DataSnapshot
                        let dkey = sub.key
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = sub.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artist"] as! Array<String>)
                            temp.append(dvalue["Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                if let eng = engies1["Mix Engineer"] as? Array<String> {
                                    song.songMixEngineer = eng
                                }
                                if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                    song.songMasteringEngineer = eng
                                }
                                if let eng = engies1["Recording Engineer"] as? Array<String> {
                                    song.songRecordingEngineer = eng
                                }
                            }
                            if let merchandise = (dvalue["Merch"] as? [String]) {
                                song.merch = (merchandise)
                            }
                            if let tval = (dvalue["Instrumentals"] as? [String]) {
                                song.instrumentals = tval
                            }
                            if let tval = (dvalue["Albums"] as? [String]) {
                                song.albums = tval
                            }
                            if let tval = (dvalue["Videos"] as? [String]) {
                                song.videos = tval
                            }
                            if let tval = (dvalue["Writers"] as? [String]) {
                                song.songWriters = tval
                            }
                            if let tval = (dvalue["Manual Image URL"] as? String) {
                                song.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"] as? String) {
                                song.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                song.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                song.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Explicit"] as? Bool) {
                                song.explicit = tval
                        }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                        
                        song.name = temp[0] as! String
                            song.songArtist = temp[1] as! Array<String>
                            song.songProducers = temp[2] as! Array<String>
                            song.favoritesOverall = temp[3] as! Int
                            song.toneDeafAppId = temp[4] as! String
                            song.isActive = temp[5] as! Bool
                        }
                        if dkey.contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist"] as! String)
                            temp.append(dvalue["Album Name"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = temp[15] as! Bool
                            
                            song.apple = apple
                            
                        }
                        if dkey.contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist 1"] as! String)
                            temp.append(dvalue["Artist 1 URL"] as! String)
                            temp.append(dvalue["Artist 2"] as! String)
                            temp.append(dvalue["Artist 2 URL"] as! String)
                            temp.append(dvalue["Artist 3"] as! String)
                            temp.append(dvalue["Artist 3 URL"] as! String)
                            temp.append(dvalue["Artist 4"] as! String)
                            temp.append(dvalue["Artist 4 URL"] as! String)
                            temp.append(dvalue["Artist 5"] as! String)
                            temp.append(dvalue["Artist 5 URL"] as! String)
                            temp.append(dvalue["Artist 6"] as! String)
                            temp.append(dvalue["Artist 6 URL"] as! String)
                            temp.append(dvalue["Album Type"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            song.spotify = spotify
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                            soundcloud.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            song.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            youtubeMusic.url = temp[0] as! String
                            youtubeMusic.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            amazon.url = temp[0] as! String
                            amazon.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String : Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String : Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.isrc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.previewURL = temp[7] as! String
                            deezer.timeIA = temp[8] as! String
                            deezer.deezerID = temp[9] as! Int
                            deezer.dateIA = temp[10] as! String
                            deezer.isActive = temp[11] as! Bool
                            
                            song.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            spinrilla.url = temp[0] as! String
                            spinrilla.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            song.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            napster.url = temp[0] as! String
                            napster.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            tidal.url = temp[0] as! String
                            tidal.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in sub.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        song.officialVideo = temp[0] as! String
                                    }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                                if vidkey == "Lyric" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.lyricVideo = temp[0] as! String
                                }
                            }
                        }
                        
                    }
                    //print(song.name)
                    contentFeaturedArray.append(song)
                }
                if key.contains("YT") == true {
                    let video = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                    
                    var temp:Array<Any> = []
                    let dvalue = item.value as! [String:Any]
                    temp.append(dvalue["Channel Title"] as! String)
                    temp.append(dvalue["Duration"] as! String)
                    temp.append(dvalue["Date Uploaded To App"] as! String)
                    temp.append(dvalue["Date Uploaded To Youtube"] as! String)
                    temp.append(dvalue["Description"] as! String)
                    temp.append(dvalue["Number of Favorites"] as! Int)
                    temp.append(dvalue["Thumbnail URL"] as! String)
                    temp.append(dvalue["Time Uploaded To App"] as! String)
                    temp.append(dvalue["Time Uploaded To Youtube"] as! String)
                    temp.append(dvalue["Title"] as! String)
                    temp.append(dvalue["Video URL"] as! String)
                    temp.append(dvalue["Views In App"] as! Int)
                    temp.append(dvalue["Views on Youtube"] as! Int)
                    temp.append(dvalue["Youtube Id"] as! String)
                    temp.append(dvalue["Tone Deaf App Video Id"] as! String)
                    temp.append(dvalue["Artist"] as! [String])
                    temp.append(dvalue["Producers"] as! [String])
                    temp.append(dvalue["Albums"] as! [String])
                    temp.append(dvalue["Instrumentals"] as! [String])
                    temp.append(dvalue["Songs"] as! [String])
                    temp.append(dvalue["Beats"] as! [String])
                    temp.append(dvalue["Type"] as! String)
                    if let merchandise = (dvalue["Merch"] as? [String]) {
//                        video.merch = (merchandise)
                    }
                    
                    
                    video.channelTitle = temp[0] as! String
                    video.duration = temp[1] as! String
                    video.dateIA = temp[2] as! String
                    video.dateYT = temp[3] as! String
                    video.description = temp[4] as! String
//                    video.favorites = temp[5] as! Int
                    video.thumbnailURL = temp[6] as! String
                    video.timeIA = temp[7] as! String
                    video.timeYT = temp[8] as! String
                    video.title = temp[9] as! String
                    video.url = temp[10] as! String
                    video.viewsIA = temp[11] as! Int
                    video.viewsYT = temp[12] as! Int
                    video.youtubeId = temp[13] as! String
                    video.toneDeafAppId = temp[14] as! String
//                    video.artist = temp[15] as! [String]
//                    video.producers = temp[16] as! [String]
//                    video.albums = temp[17] as! [String]
//                    video.instrumentals = temp[18] as! [String]
//                    video.songs = temp[19] as! [String]
//                    video.beats = temp[20] as! [String]
                    video.type = temp[21] as! String
                    
                    contentFeaturedArray.append(video)
                }
                if key.contains("INMT") == true {
                    let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    var ltemp:Array<Any> = []
                    let dvalue = item.value as! [String:Any]
                    ltemp.append(dvalue["Name"] as! String)
                    ltemp.append(dvalue["Producers"] as! Array<String>)
                    ltemp.append(dvalue["Audio URL"] as! String)
                    ltemp.append(dvalue["Time Uploaded To App"] as! String)
                    ltemp.append(dvalue["Date Uploaded To App"] as! String)
                    ltemp.append(dvalue["Duration"] as! String)
                    ltemp.append(dvalue["Number of Favorites"] as! Int)
                    ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                    ltemp.append(dvalue["Active Status"] as! Bool)
                    if let tval = (dvalue["Songs"] as? [String]) {
                        instrumental.songs = tval
                    }
                    if let tval = (dvalue["Albums"] as? [String]) {
                        instrumental.albums = tval
                    }
                    if let eval = (dvalue["Engineers"] as? NSDictionary) {
                        if let tval = (eval["Mix Engineer"] as? [String]) {
                            instrumental.mixEngineer = tval
                        }
                        if let tval = (eval["Mastering Engineer"] as? [String]) {
                            instrumental.masteringEngineer = tval
                        }
                    }
                    if let tval = (dvalue["Videos"] as? [String]) {
                        instrumental.videos = tval
                    }
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        instrumental.merch = (merchandise)
                    }
                    if let tval = (dvalue["Artists"] as? [String]) {
                        instrumental.artist = tval
                    }
                    if let tval = (dvalue["Manual Image URL"] as? String) {
                        instrumental.manualImageURL = tval
                    }
                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                        instrumental.manualPreviewURL = tval
                    }
                    if let tval = (dvalue["Official Video"] as? String) {
                        instrumental.officialVideo = tval
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        instrumental.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        instrumental.verificationLevel = Character(tval)
                    }
                    for chi in item.children {
                        let da = chi as! DataSnapshot
                        let lilkey = da.key
                        if lilkey == "Store Info" {
                            let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                            let botval = da.value as! [String:Any]
                            
                            inststore.retailPrice = botval["Retail Price"] as! Double
                            inststore.merchType = botval["Merch Type"] as! String
                            inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                            let predate = botval["Date Uploaded"] as! String
                            guard predate != "" else {return}
                            let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                            inststore.dateUploaded = date
                            if let ite = botval["Sale Price"] as? Double {
                                inststore.salePrice = ite
                            }
                            if let ite = botval["Quantity"] as? Int {
                                inststore.quantity = ite
                            }
                            instrumental.storeInfo = inststore
                        }
                    }
                    instrumental.instrumentalName = ltemp[0] as! String
                    instrumental.producers = ltemp[1] as! Array<String>
                    instrumental.audioURL = ltemp[2] as! String
                    instrumental.timeRegisteredToApp = ltemp[3] as! String
                    instrumental.dateRegisteredToApp = ltemp[4] as! String
                    instrumental.duration = ltemp[5] as! String
                    instrumental.favoritesOverall = ltemp[6] as! Int
                    instrumental.toneDeafAppId = ltemp[7] as! String
                    instrumental.isActive = ltemp[8] as! Bool
                    let songname = ltemp[0] as! String
                    instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                    for val in item.children {
                        var temp:Array<Any> = []
                        let cont = val as! DataSnapshot
                        let chi = cont.key
                        if (chi).contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Spotify"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist 1"] as! String)
                            temp.append(svalue["Artist 1 URL"] as! String)
                            temp.append(svalue["Artist 2"] as! String)
                            temp.append(svalue["Artist 2 URL"] as! String)
                            temp.append(svalue["Artist 3"] as! String)
                            temp.append(svalue["Artist 3 URL"] as! String)
                            temp.append(svalue["Artist 4"] as! String)
                            temp.append(svalue["Artist 4 URL"] as! String)
                            temp.append(svalue["Artist 5"] as! String)
                            temp.append(svalue["Artist 5 URL"] as! String)
                            temp.append(svalue["Artist 6"] as! String)
                            temp.append(svalue["Artist 6 URL"] as! String)
                            temp.append(svalue["Album Type"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Spotify Id"] as! String)
                            ltemp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = ltemp[26] as! Bool
                            
                            instrumental.spotify = spotify
                        }
                        if (chi).contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Apple"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist"] as! String)
                            temp.append(svalue["Album Name"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Apple Music Id"] as! String)
                            ltemp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = ltemp[15] as! Bool
                            
                            instrumental.apple = apple
                        }
                        if chi.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                                soundcloud.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                instrumental.soundcloud = soundcloud
                            }
                            if chi.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                youtubeMusic.url = temp[0] as! String
                                youtubeMusic.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.youtubeMusic = youtubeMusic
                            }
                            if chi.contains(amazonMusicContentType) == true {
                                let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                amazon.url = temp[0] as! String
                                amazon.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.amazon = amazon
                            }
                            if chi.contains(deezerMusicContentType) == true {
                                let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String : Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["ISRC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Song URL"] as! String)
                                temp.append(dvalue["Preview URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String : Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.isrc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.previewURL = temp[7] as! String
                                deezer.timeIA = temp[8] as! String
                                deezer.deezerID = temp[9] as! Int
                                deezer.dateIA = temp[10] as! String
                                deezer.isActive = temp[11] as! Bool
                                
                                instrumental.deezer = deezer
                            }
                            if chi.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                spinrilla.url = temp[0] as! String
                                spinrilla.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                instrumental.spinrilla = spinrilla
                            }
                            if chi.contains(napsterMusicContentType) == true {
                                let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                napster.url = temp[0] as! String
                                napster.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.napster = napster
                            }
                            if chi.contains(tidalMusicContentType) == true {
                                let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                tidal.url = temp[0] as! String
                                tidal.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.tidal = tidal
                            }
                        }
                    
                    contentFeaturedArray.append(instrumental)
                }
                if key.contains("ALBM") == true {
                    var youtubeAlts:[String] = []
                    let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                    for sub in item.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        //print(up.key)
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = up.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Main Artist"] as! Array<String>)
                            temp.append(dvalue["All Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Number Of Tracks"] as! Int)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            if let tval = (dvalue["All Artist"]) as? [String] {
                                album.allArtists = tval
                            }
                            if let tval = (dvalue["All Writers"]) as? [String] {
                                album.writers = tval
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mix Engineer"]) as? [String] {
                                    album.mixEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mastering Engineer"]) as? [String] {
                                    album.masteringEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Recording Engineer"]) as? [String] {
                                    album.recordingEngineers = tval
                                }
                            }
                            if let merchandise = (dvalue["Merch"]) {
                                album.merch = (merchandise as! [String])
                            }
                            if let tval = (dvalue["Songs"]) as? [String] {
                                album.songs = tval
                            }
                            if let tval = (dvalue["Instrumentals"]) as? [String] {
                                album.instrumentals = tval
                            }
                            if let tval = (dvalue["Videos"]) as? [String] {
                                album.videos = tval
                            }
                            if let tval = (dvalue["Tracks"]) as? [String:String] {
                                album.tracks = tval
                            }
                            if let tval = (dvalue["Manual Image URL"]) as? String {
                                album.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"]) as? String {
                                album.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                album.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                album.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Deluxes"] as? [String]) {
                                album.deluxes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                album.otherVersions = tval
                            }
                        if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                            let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isDeluxe = deluxe
                        }
                        if let taval = (dvalue["Other Version"] as? NSDictionary) {
                            let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isOtherVersion = deluxe
                        }
                            
                            
                            
                            album.name = temp[0] as! String
                            album.mainArtist = temp[1] as! Array<String>
                            album.producers = temp[2] as! Array<String>
                            album.favoritesOverall = temp[3] as! Int
                            album.toneDeafAppId = temp[4] as! String
                            album.numberofTracks = temp[5] as! Int
                            album.timeRegisteredToApp = temp[6] as! String
                            album.dateRegisteredToApp = temp[7] as! String
                            album.isActive = temp[8] as! Bool
                        }
                        if dkey.contains("APPL") == true {
                            let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            appleData.name = temp[0] as! String
                            appleData.artist = temp[1] as! String
                            appleData.dateReleasedApple = temp[2] as! String
                            appleData.timeIA = temp[3] as! String
                            appleData.dateIA = temp[4] as! String
                            appleData.imageURL = temp[5] as! String
                            appleData.url = temp[6] as! String
                            //appleData. = temp[6] as! Int
                            appleData.trackCount = temp[7] as! Int
                            appleData.appleId = temp[8] as! String
                            appleData.isActive = temp[9] as! Bool
                            
                            album.apple = appleData
                        }
                        if dkey.contains("SPTY") == true {
                            let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! [[String:String]])
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Album URI"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            
                            spotifyData.name = temp[0] as! String
                            spotifyData.artist = temp[1] as! [[String:String]]
                            spotifyData.upc = temp[2] as! String
                            spotifyData.dateReleasedSpotify = temp[3] as! String
                            spotifyData.timeIA = temp[4] as! String
                            spotifyData.dateIA = temp[5] as! String
                            spotifyData.imageURL = temp[6] as! String
                            spotifyData.url = temp[7] as! String
                            spotifyData.uri = temp[8] as! String
                            //spotifyData. = temp[10] as! Bool
                            spotifyData.trackNumberTotal = temp[9] as! Int
                            spotifyData.spotifyId = temp[10] as! String
                            
                            album.spotify = spotifyData
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            album.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            youtubeMusic.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            amazon.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String:Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String:Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.upc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.timeIA = temp[7] as! String
                            deezer.deezerID = temp[8] as! Int
                            deezer.dateIA = temp[9] as! String
                            
                            album.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            spinrilla.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            album.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            napster.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            tidal.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in up.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        album.officialAlbumVideo = temp[0] as! String
                                    }
                                }
                        }
                    }
                    contentFeaturedArray.append(album)
            }
            //print(contentFeaturedArray)
            }
            completion(contentFeaturedArray)
        })
    }
    
    func getMusicLatestSongsContent(completion: @escaping (([SongData]) -> Void)) {
        var contentFeaturedArray:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").observeSingleEvent(of: .value, with: {[weak self] snapshot in
            guard let strongSelf = self else {return}
            var datetemp:Array<Date> = []
            var snaptemp:Array<Date> = []
            //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let content = child as! DataSnapshot
                if content.key != "All Song IDs" {
                    var earliestdate = Date()
                    var youtubeAlts:[String] = []
                    let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    for kid in content.children {
                        let sub = kid as! DataSnapshot
                        let dkey = sub.key
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = sub.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artist"] as! Array<String>)
                            temp.append(dvalue["Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                if let eng = engies1["Mix Engineer"] as? Array<String> {
                                    song.songMixEngineer = eng
                                }
                                if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                    song.songMasteringEngineer = eng
                                }
                                if let eng = engies1["Recording Engineer"] as? Array<String> {
                                    song.songRecordingEngineer = eng
                                }
                            }
                            if let merchandise = (dvalue["Merch"] as? [String]) {
                                song.merch = (merchandise)
                            }
                            if let tval = (dvalue["Instrumentals"] as? [String]) {
                                song.instrumentals = tval
                            }
                            if let tval = (dvalue["Albums"] as? [String]) {
                                song.albums = tval
                            }
                            if let tval = (dvalue["Videos"] as? [String]) {
                                song.videos = tval
                            }
                            if let tval = (dvalue["Writers"] as? [String]) {
                                song.songWriters = tval
                            }
                            if let tval = (dvalue["Manual Image URL"] as? String) {
                                song.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"] as? String) {
                                song.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                song.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                song.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Explicit"] as? Bool) {
                                song.explicit = tval
                        }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                        
                        song.name = temp[0] as! String
                            song.songArtist = temp[1] as! Array<String>
                            song.songProducers = temp[2] as! Array<String>
                            song.favoritesOverall = temp[3] as! Int
                            song.toneDeafAppId = temp[4] as! String
                            song.isActive = temp[5] as! Bool
                        }
                        if dkey.contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist"] as! String)
                            temp.append(dvalue["Album Name"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = temp[15] as! Bool
                            
                            song.apple = apple
                            
                        }
                        if dkey.contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist 1"] as! String)
                            temp.append(dvalue["Artist 1 URL"] as! String)
                            temp.append(dvalue["Artist 2"] as! String)
                            temp.append(dvalue["Artist 2 URL"] as! String)
                            temp.append(dvalue["Artist 3"] as! String)
                            temp.append(dvalue["Artist 3 URL"] as! String)
                            temp.append(dvalue["Artist 4"] as! String)
                            temp.append(dvalue["Artist 4 URL"] as! String)
                            temp.append(dvalue["Artist 5"] as! String)
                            temp.append(dvalue["Artist 5 URL"] as! String)
                            temp.append(dvalue["Artist 6"] as! String)
                            temp.append(dvalue["Artist 6 URL"] as! String)
                            temp.append(dvalue["Album Type"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            song.spotify = spotify
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                            soundcloud.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            song.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            youtubeMusic.url = temp[0] as! String
                            youtubeMusic.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            amazon.url = temp[0] as! String
                            amazon.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String : Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String : Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.isrc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.previewURL = temp[7] as! String
                            deezer.timeIA = temp[8] as! String
                            deezer.deezerID = temp[9] as! Int
                            deezer.dateIA = temp[10] as! String
                            deezer.isActive = temp[11] as! Bool
                            
                            song.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            spinrilla.url = temp[0] as! String
                            spinrilla.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            song.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            napster.url = temp[0] as! String
                            napster.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            tidal.url = temp[0] as! String
                            tidal.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in content.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        song.officialVideo = temp[0] as! String
                                    }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                                if vidkey == "Lyric" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.lyricVideo = temp[0] as! String
                                }
                            }
                        }
                        
                    }
                    if  datetemp.count < 15 {
                        contentFeaturedArray.append(song)
                        datetemp.append(earliestdate)
                    } else if earliestdate > datetemp.min()! {
                        if song.toneDeafAppId != contentFeaturedArray[0].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[1].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[2].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[3].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[4].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[5].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[6].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[7].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[8].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[9].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[10].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[11].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[12].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[13].toneDeafAppId && song.toneDeafAppId != contentFeaturedArray[14].toneDeafAppId {
                            let it = datetemp.firstIndex(of: datetemp.min()!)
                            datetemp.remove(at: it!)
                            contentFeaturedArray.remove(at: it!)
                            datetemp.append(earliestdate)
                            contentFeaturedArray.append(song)
                        }
                    }
                }
                
                
            }
            //print(contentFeaturedArray)
            completion(contentFeaturedArray)
            //print(datetemp)
        })
    }
    
    func getMusicLatestVideosContent(completion: @escaping (([AnyObject]) -> Void)) {
        var contentFeaturedArray:[AnyObject] = []
        Database.database().reference().child("Music Content").child("Videos").observeSingleEvent(of: .value, with: { snapshot in
            var datetemp:Array<Date> = []
            var snaptemp:Array<Date> = []
            //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                var earliestdate = Date()
                var set = 0
                let item = child as! DataSnapshot
                let key = item.key
                var youtubeAlts:[String] = []
                if key != "All Video IDs" {
                    if key.contains("YTAL") == true || key.contains("YTVD") == true {
                        let video = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = item.value as! [String:Any]
                        temp.append(dvalue["Channel Title"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Date Uploaded To Youtube"] as! String)
                        temp.append(dvalue["Description"] as! String)
                        temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Thumbnail URL"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Time Uploaded To Youtube"] as! String)
                        temp.append(dvalue["Title"] as! String)
                        temp.append(dvalue["Video URL"] as! String)
                        temp.append(dvalue["Views In App"] as! Int)
                        temp.append(dvalue["Views on Youtube"] as! Int)
                        temp.append(dvalue["Youtube Id"] as! String)
                        temp.append(dvalue["Tone Deaf App Video Id"] as! String)
                        temp.append(dvalue["Artist"] as! [String])
                        temp.append(dvalue["Producers"] as! [String])
                        temp.append(dvalue["Albums"] as! [String])
                        temp.append(dvalue["Instrumentals"] as! [String])
                        temp.append(dvalue["Songs"] as! [String])
                        temp.append(dvalue["Beats"] as! [String])
                        temp.append(dvalue["Type"] as! String)
                        if let merchandise = (dvalue["Merch"] as? [String]) {
//                            video.merch = (merchandise)
                        }
                        
                        video.channelTitle = temp[0] as! String
                        video.duration = temp[1] as! String
                        video.dateIA = temp[2] as! String
                        video.dateYT = temp[3] as! String
                        video.description = temp[4] as! String
//                        video.favorites = temp[5] as! Int
                        video.thumbnailURL = temp[6] as! String
                        video.timeIA = temp[7] as! String
                        video.timeYT = temp[8] as! String
                        video.title = temp[9] as! String
                        video.url = temp[10] as! String
                        video.viewsIA = temp[11] as! Int
                        video.viewsYT = temp[12] as! Int
                        video.youtubeId = temp[13] as! String
                        video.toneDeafAppId = temp[14] as! String
//                        video.artist = temp[15] as! [String]
//                        video.producers = temp[16] as! [String]
//                        video.albums = temp[17] as! [String]
//                        video.instrumentals = temp[18] as! [String]
//                        video.songs = temp[19] as! [String]
//                        video.beats = temp[20] as! [String]
                        video.type = temp[21] as! String
                        
                        
                        let predate = video.dateYT
                        guard predate != "" else {return}
                        let date = predate.date(format: "MM dd, yyyy")!
                        if date < earliestdate {
                            earliestdate = date
                        }
                        //print(earliestdate)
                        if  datetemp.count < 3 {
                            contentFeaturedArray.append(video)
                            datetemp.append(earliestdate)
                        } else if earliestdate > datetemp.min()! {
                            if video.title != contentFeaturedArray[0].title && video.title != contentFeaturedArray[1].title && video.title != contentFeaturedArray[2].title {
                                let it = datetemp.firstIndex(of: datetemp.min()!)
                                datetemp.remove(at: it!)
                                contentFeaturedArray.remove(at: it!)
                                datetemp.append(earliestdate)
                                contentFeaturedArray.append(video)
                            }
                        }
                    }
                }
                
                
            }
            //print(contentFeaturedArray)
            completion(contentFeaturedArray)
            //print(datetemp)
        })
    }
    
    func getMusicInstrumentalContent(completion: @escaping (([InstrumentalData]) -> Void)) {
        var snapArray:[DataSnapshot] = []
        var instrumentalsFeaturedArray:[InstrumentalData] = []
        
        Database.database().reference().child("Music Content").child("Instrumentals").observeSingleEvent(of: .value, with: { snapshot in
            //print(snapshot)
            for content in snapshot.children {
                let data = content as! DataSnapshot
                snapArray.append(data)
            }
            snapArray.shuffle()
            
            for content in snapArray {
                let akey = content.key
                if akey != "All Instrumental IDs" {
                    if instrumentalsFeaturedArray.count < 5 {
                        let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                        var ltemp:Array<Any> = []
                        let dvalue = content.value as! [String:Any]
                        ltemp.append(dvalue["Name"] as! String)
                        ltemp.append(dvalue["Producers"] as! Array<String>)
                        ltemp.append(dvalue["Audio URL"] as! String)
                        ltemp.append(dvalue["Time Uploaded To App"] as! String)
                        ltemp.append(dvalue["Date Uploaded To App"] as! String)
                        ltemp.append(dvalue["Duration"] as! String)
                        ltemp.append(dvalue["Number of Favorites"] as! Int)
                        ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                        ltemp.append(dvalue["Active Status"] as! Bool)
                        if let tval = (dvalue["Songs"] as? [String]) {
                            instrumental.songs = tval
                        }
                        if let tval = (dvalue["Albums"] as? [String]) {
                            instrumental.albums = tval
                        }
                        if let tval = (dvalue["Mix Engineers"] as? [String]) {
                            instrumental.mixEngineer = tval
                        }
                        if let tval = (dvalue["Mastering Engineers"] as? [String]) {
                            instrumental.masteringEngineer = tval
                        }
                        if let tval = (dvalue["Videos"] as? [String]) {
                            instrumental.videos = tval
                        }
                        if let merchandise = (dvalue["Merch"] as? [String]) {
                            instrumental.merch = (merchandise)
                        }
                        if let tval = (dvalue["Artists"] as? [String]) {
                            instrumental.artist = tval
                        }
                        if let tval = (dvalue["Manual Image URL"] as? String) {
                            instrumental.manualImageURL = tval
                        }
                        if let tval = (dvalue["Manual Preview URL"] as? String) {
                            instrumental.manualPreviewURL = tval
                        }
                        if let tval = (dvalue["Industry Certified"] as? Bool) {
                            instrumental.industryCerified = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            instrumental.verificationLevel = Character(tval)
                        }
                        for chi in content.children {
                            let da = chi as! DataSnapshot
                            let lilkey = da.key
                            if lilkey == "Store Info" {
                                let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                                let botval = da.value as! [String:Any]
                                
                                inststore.retailPrice = botval["Retail Price"] as! Double
                                inststore.merchType = botval["Merch Type"] as! String
                                inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                                let predate = botval["Date Uploaded"] as! String
                                guard predate != "" else {return}
                                let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                inststore.dateUploaded = date
                                if let ite = botval["Sale Price"] as? Double {
                                    inststore.salePrice = ite
                                }
                                if let ite = botval["Quantity"] as? Int {
                                    inststore.quantity = ite
                                }
                                instrumental.storeInfo = inststore
                            }
                            if lilkey == "Videos" {
                                for dis in da.children {
                                    let fha = dis as! DataSnapshot
                                    let dvalue = fha.value as! [String:Any]
                                    if let tval = (dvalue["Official"] as? String) {
                                        instrumental.officialVideo = tval
                                    }
                                }
                            }
                        }
                        instrumental.instrumentalName = ltemp[0] as! String
                        instrumental.producers = ltemp[1] as! Array<String>
                        instrumental.audioURL = ltemp[2] as! String
                        instrumental.timeRegisteredToApp = ltemp[3] as! String
                        instrumental.dateRegisteredToApp = ltemp[4] as! String
                        instrumental.duration = ltemp[5] as! String
                        instrumental.favoritesOverall = ltemp[6] as! Int
                        instrumental.toneDeafAppId = ltemp[7] as! String
                        instrumental.isActive = ltemp[8] as! Bool
                        let songname = ltemp[0] as! String
                        instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                        for val in content.children {
                            var temp:Array<Any> = []
                            let cont = val as! DataSnapshot
                            let chi = cont.key
                            if (chi).contains(spotifyMusicContentType) == true {
                                let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                                
                                let svalue = cont.value as! [String:Any]
                                temp.append(svalue["Name"] as! String)
                                temp.append(svalue["Duration"] as! String)
                                temp.append(svalue["Date Uploaded To App"] as! String)
                                temp.append(svalue["Date Released On Spotify"] as! String)
                                temp.append(svalue["Preview URL"] as! String)
                                temp.append(svalue["ISRC"] as! String)
                                temp.append(svalue["Number of Favorites"] as! Int)
                                temp.append(svalue["Artwork URL"] as! String)
                                temp.append(svalue["Time Uploaded To App"] as! String)
                                temp.append(svalue["Song URL"] as! String)
                                temp.append(svalue["Explicity"] as! Bool)
                                temp.append(svalue["Artist 1"] as! String)
                                temp.append(svalue["Artist 1 URL"] as! String)
                                temp.append(svalue["Artist 2"] as! String)
                                temp.append(svalue["Artist 2 URL"] as! String)
                                temp.append(svalue["Artist 3"] as! String)
                                temp.append(svalue["Artist 3 URL"] as! String)
                                temp.append(svalue["Artist 4"] as! String)
                                temp.append(svalue["Artist 4 URL"] as! String)
                                temp.append(svalue["Artist 5"] as! String)
                                temp.append(svalue["Artist 5 URL"] as! String)
                                temp.append(svalue["Artist 6"] as! String)
                                temp.append(svalue["Artist 6 URL"] as! String)
                                temp.append(svalue["Album Type"] as! String)
                                temp.append(svalue["Track Number"] as! Int)
                                temp.append(svalue["Spotify Id"] as! String)
                                ltemp.append(dvalue["Active Status"] as! Bool)
                                
                                spotify.spotifyName = temp[0] as! String
                                spotify.spotifyDuration = temp[1] as! String
                                spotify.spotifyDateIA = temp[2] as! String
                                spotify.spotifyDateSPT = temp[3] as! String
                                spotify.spotifyPreviewURL = temp[4] as! String
                                spotify.spotifyISRC = temp[5] as! String
                                spotify.spotifyFavorites = temp[6] as! Int
                                spotify.spotifyArtworkURL = temp[7] as! String
                                spotify.spotifyTimeIA = temp[8] as! String
                                spotify.spotifySongURL = temp[9] as! String
                                spotify.spotifyExplicity = temp[10] as! Bool
                                spotify.spotifyArtist1 = temp[11] as! String
                                spotify.spotifyArtist1URL = temp[12] as! String
                                spotify.spotifyArtist2 = temp[13] as! String
                                spotify.spotifyArtist2URL = temp[14] as! String
                                spotify.spotifyArtist3 = temp[15] as! String
                                spotify.spotifyArtist3URL = temp[16] as! String
                                spotify.spotifyArtist4 = temp[17] as! String
                                spotify.spotifyArtist4URL = temp[18] as! String
                                spotify.spotifyArtist5 = temp[19] as! String
                                spotify.spotifyArtist5URL = temp[20] as! String
                                spotify.spotifyArtist6 = temp[21] as! String
                                spotify.spotifyArtis6URL = temp[22] as! String
                                spotify.spotifyAlbumType = temp[23] as! String
                                spotify.spotifyTrackNumber = temp[24] as! Int
                                spotify.spotifyId = temp[25] as! String
                                spotify.isActive = ltemp[26] as! Bool
                                
                                instrumental.spotify = spotify
                            }
                            if (chi).contains(appleMusicContentType) == true {
                                let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                                var temp:Array<Any> = []
                                let svalue = cont.value as! [String:Any]
                                temp.append(svalue["Name"] as! String)
                                temp.append(svalue["Duration"] as! String)
                                temp.append(svalue["Date Uploaded To App"] as! String)
                                temp.append(svalue["Date Released On Apple"] as! String)
                                temp.append(svalue["Preview URL"] as! String)
                                temp.append(svalue["ISRC"] as! String)
                                temp.append(svalue["Number of Favorites"] as! Int)
                                temp.append(svalue["Artwork URL"] as! String)
                                temp.append(svalue["Time Uploaded To App"] as! String)
                                temp.append(svalue["Song URL"] as! String)
                                temp.append(svalue["Explicity"] as! Bool)
                                temp.append(svalue["Artist"] as! String)
                                temp.append(svalue["Album Name"] as! String)
                                temp.append(svalue["Track Number"] as! Int)
                                temp.append(svalue["Apple Music Id"] as! String)
                                ltemp.append(dvalue["Active Status"] as! Bool)
                                
                                apple.appleName = temp[0] as! String
                                apple.appleDuration = temp[1] as! String
                                apple.appleDateIA = temp[2] as! String
                                apple.appleDateAPPL = temp[3] as! String
                                apple.applePreviewURL = temp[4] as! String
                                apple.appleISRC = temp[5] as! String
                                apple.appleFavorites = temp[6] as! Int
                                apple.appleArtworkURL = temp[7] as! String
                                apple.appleTimeIA = temp[8] as! String
                                apple.appleSongURL = temp[9] as! String
                                apple.appleExplicity = temp[10] as! Bool
                                apple.appleArtist = temp[11] as! String
                                apple.appleAlbumName = temp[12] as! String
                                apple.appleTrackNumber = temp[13] as! Int
                                apple.appleMusicId = temp[14] as! String
                                apple.isActive = ltemp[15] as! Bool
                                
                                instrumental.apple = apple
                            }
                            if chi.contains(soundcloudMusicContentType) == true {
                                let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                soundcloud.url = temp[0] as! String
                                    soundcloud.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Soundcloud"] != nil {
                                        soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                    }
                                    instrumental.soundcloud = soundcloud
                                }
                                if chi.contains(youtubeMusicContentType) == true {
                                    let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = cont.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    youtubeMusic.url = temp[0] as! String
                                    youtubeMusic.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    instrumental.youtubeMusic = youtubeMusic
                                }
                                if chi.contains(amazonMusicContentType) == true {
                                    let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = cont.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    amazon.url = temp[0] as! String
                                    amazon.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    instrumental.amazon = amazon
                                }
                                if chi.contains(deezerMusicContentType) == true {
                                    let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = cont.value! as! [String:Any]
                                    
                                    temp.append(dvalue["Date Released On Deezer"] as! String)
                                    temp.append(dvalue["Artist"] as! [[String : Any]])
                                    temp.append(dvalue["Artwork URL"] as! String)
                                    temp.append(dvalue["Duration"] as! String)
                                    temp.append(dvalue["ISRC"] as! String)
                                    temp.append(dvalue["Name"] as! String)
                                    temp.append(dvalue["Song URL"] as! String)
                                    temp.append(dvalue["Preview URL"] as! String)
                                    temp.append(dvalue["Time Uploaded To App"] as! String)
                                    temp.append(dvalue["Deezer Music Id"] as! Int)
                                    temp.append(dvalue["Date Uploaded To App"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    
                                    deezer.deezerDate = temp[0] as! String
                                    deezer.artist = temp[1] as! [[String : Any]]
                                    deezer.imageurl = temp[2] as! String
                                    deezer.duration = temp[3] as! String
                                    deezer.isrc = temp[4] as! String
                                    deezer.name = temp[5] as! String
                                    deezer.url = temp[6] as! String
                                    deezer.previewURL = temp[7] as! String
                                    deezer.timeIA = temp[8] as! String
                                    deezer.deezerID = temp[9] as! Int
                                    deezer.dateIA = temp[10] as! String
                                    deezer.isActive = temp[11] as! Bool
                                    
                                    instrumental.deezer = deezer
                                }
                                if chi.contains(spinrillaMusicContentType) == true {
                                    let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = cont.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    spinrilla.url = temp[0] as! String
                                    spinrilla.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    if dvalue["Date Released On Spinrilla"] != nil {
                                        spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                    }
                                    instrumental.spinrilla = spinrilla
                                }
                                if chi.contains(napsterMusicContentType) == true {
                                    let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = cont.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    napster.url = temp[0] as! String
                                    napster.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        napster.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    instrumental.napster = napster
                                }
                                if chi.contains(tidalMusicContentType) == true {
                                    let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                    var temp:Array<Any> = []
                                    let dvalue = cont.value! as! [String:Any]
                                    temp.append(dvalue["url"] as! String)
                                    temp.append(dvalue["Active Status"] as! Bool)
                                    tidal.url = temp[0] as! String
                                    tidal.isActive = temp[1] as! Bool
                                    if dvalue["Artwork URL"] != nil {
                                        tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                    }
                                    instrumental.tidal = tidal
                                }
                            }
                        
                        instrumentalsFeaturedArray.append(instrumental)
                        //print(instrumentalsFeaturedArray)
                        //Copy 5 To other node
                        Database.database().reference().child("Current Featured Content").child("Main Music Featured Instrumentals").removeValue()
                        let ref1 = Database.database().reference().child("Music Content").child(akey)
                        let ref2 = Database.database().reference().child("Current Featured Content").child("Main Music Featured Instrumentals").child(akey)
                        
                        ref1.observeSingleEvent(of: .value, with: { snapshot in
                            let log = snapshot.value
                            ref2.setValue(log)
                            //print("Done")
                        })
                    }
                }
                
            }
            completion(instrumentalsFeaturedArray)
            
        })
    }
    
    
    
    func fetchLatestMerch(amount: Int, completion: @escaping (([MerchData]) -> Void)) {
        var merchArray:[MerchData] = []
        var datetemp:Array<Date> = []
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: {[weak self] snap in
            guard let strongSelf = self else {return}
            for kid in snap.children {
                let child = kid as! DataSnapshot
                let key = child.key
                var latestDate:Date = Date()
                let word = key.split(separator: "Ã†")
                let id = String(word[0])
                let merch = MerchData(kit: nil, apperal: nil, instrumentalSale: nil, service: nil, memorabilia: nil)
                switch id.count {
                case 24:
                    let memo = MerchMemorabiliaData(date: Date(), colors: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        memo.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        memo.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        memo.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        memo.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        memo.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        memo.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        memo.instrumentals = array
                    }
                    for sub in child.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        if dkey == "Colors" {
                            var colorArr:[MemorabiliaColorData] = []
                            for siz in up.children {
                                let sze = siz as! DataSnapshot
                                let size = sze.key
                                let colordata = MemorabiliaColorData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0)
                                let cval = sze.value as! [String:Any]
                                let coll = cval["Color"] as! String
                                let dateRes = cval["Date Restocked"] as! String
                                let descript = cval["Description"] as! String
                                let nopur = cval["Number of Purchases"] as! Int
                                let quan = cval["Quantity"] as! Int
                                let repe = cval["Retail Price"] as! Double
                                
                                colordata.color = coll
                                let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                colordata.dateLastRestocked = dateee
                                colordata.description = descript
                                colordata.numberOfPurchases = nopur
                                colordata.quantity = quan
                                colordata.retailPrice = repe
                                if let sale = cval["Sale Price"] as? Double {
                                    colordata.salePrice = sale
                                }
                                
                                colorArr.append(colordata)
                                memo.colors = colorArr
                                
                            }
                        }
                    }
                    memo.merchType = merchType
                    memo.imageURLs = images
                    memo.subcategory = subcat
                    memo.tDAppId = tdID
                    memo.name = name
                    memo.numberOfFavorites = nof
                    memo.numberOfPurchases = nop
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    memo.date = date
                    latestDate = date
                    
                    merch.memorabilia = memo
                case 23:
                    let apperal = MerchApperalData(date: Date(), osfaSize: nil, xxsmallSize: nil,xsmallSize: nil,smallSize: nil,mediumSize: nil,largeSize: nil,xlargeSize: nil,xxlargeSize: nil,xxxlargeSize: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        apperal.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        apperal.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        apperal.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        apperal.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        apperal.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        apperal.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        apperal.instrumentals = array
                    }
                    for sub in child.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        if dkey == "Sizes" {
                            var osfaarr:[ApperalSizeData] = []
                            var xxsmallarr:[ApperalSizeData] = []
                            var xsmallarr:[ApperalSizeData] = []
                            var smallarr:[ApperalSizeData] = []
                            var mediumarr:[ApperalSizeData] = []
                            var largearr:[ApperalSizeData] = []
                            var xlargearr:[ApperalSizeData] = []
                            var xxlargearr:[ApperalSizeData] = []
                            var xxxlargearr:[ApperalSizeData] = []
                            for siz in up.children {
                                let sze = siz as! DataSnapshot
                                let size = sze.key
                                for col in sze.children {
                                    let sizedata = ApperalSizeData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0, size: "")
                                    
                                    let cole = col as! DataSnapshot
                                    let color = cole.key
                                    let cval = cole.value as! [String:Any]
                                    let coll = cval["Color"] as! String
                                    let dateRes = cval["Date Restocked"] as! String
                                    let descript = cval["Description"] as! String
                                    let nopur = cval["Number of Purchases"] as! Int
                                    let quan = cval["Quantity"] as! Int
                                    let repe = cval["Retail Price"] as! Double
                                    let dasize = cval["Size"] as! String
                                    
                                    sizedata.color = coll
                                    let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                    sizedata.dateLastRestocked = dateee
                                    sizedata.description = descript
                                    sizedata.numberOfPurchases = nopur
                                    sizedata.quantity = quan
                                    sizedata.retailPrice = repe
                                    sizedata.size = dasize
                                    
                                    if let sale = cval["Sale Price"] as? Double {
                                        sizedata.salePrice = sale
                                    }
                                    
                                    switch sizedata.size {
                                    case "OSFA":
                                        osfaarr.append(sizedata)
                                        apperal.osfaSize = osfaarr
                                    case "XXS":
                                        xxsmallarr.append(sizedata)
                                        apperal.xxsmallSize = xxsmallarr
                                    case "XS":
                                        xsmallarr.append(sizedata)
                                        apperal.xsmallSize = xsmallarr
                                    case "S":
                                        smallarr.append(sizedata)
                                        apperal.smallSize = smallarr
                                    case "M":
                                        mediumarr.append(sizedata)
                                        apperal.mediumSize = mediumarr
                                    case "L":
                                        largearr.append(sizedata)
                                        apperal.largeSize = largearr
                                    case "XL":
                                        xlargearr.append(sizedata)
                                        apperal.xlargeSize = xlargearr
                                    case "XXL":
                                        xxlargearr.append(sizedata)
                                        apperal.xxlargeSize = xxlargearr
                                    case "XXXL":
                                        xxxlargearr.append(sizedata)
                                        apperal.xxxlargeSize = xxxlargearr
                                    default:
                                        print("you trippin tone")
                                    }
                                    
                                }
                            }
                        }
                    }
                    apperal.merchType = merchType
                    apperal.imageURLs = images
                    apperal.subcategory = subcat
                    apperal.tDAppId = tdID
                    apperal.name = name
                    apperal.numberOfFavorites = nof
                    apperal.numberOfPurchases = nop
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    apperal.date = date
                    latestDate = date
                    
                    merch.apperal = apperal
                case 22:
                    let kit = MerchKitData(date: Date(), description: "", fileURL: "", imageURLs: [], merchType: "", name: "", quantity: 0, numberOfPurchases: 0, numberOfFavorites: 0, previewURL: "", retailPrice: 0.0, salePrice: 0.0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let fileurl = dvalue["File URL"] as! String
                    let prevurl = dvalue["Preview URL"] as! String
                    let description = dvalue["Description"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        kit.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        kit.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        kit.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        kit.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        kit.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        kit.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        kit.instrumentals = array
                    }
                    if let num = dvalue["Retail Price"] as? Double {
                        kit.retailPrice = num
                    }
                    if let num = dvalue["Sale Price"] as? Double {
                        kit.salePrice = num
                    }
                    if let num = dvalue["Quantity"] as? Int {
                        kit.quantity = num
                    }
                    kit.merchType = merchType
                    kit.imageURLs = images
                    kit.subcategory = subcat
                    kit.tDAppId = tdID
                    kit.name = name
                    kit.numberOfFavorites = nof
                    kit.numberOfPurchases = nop
                    kit.description = description
                    kit.fileURL = fileurl
                    kit.previewURL = prevurl
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    kit.date = date
                    latestDate = date
                    merch.kit = kit
                case 21:
                    print("Bundle")
                case 20:
                    let service = MerchServiceData(name: "", serviceType: "", tDAppId: "", retailPrice: nil, salePrice: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date(), description: "", producers: nil)
                    let dvalue = child.value as! [String:Any]
                    let merchType = dvalue["Merch Type"] as! String
                    let servtype = dvalue["Service Type"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let description = dvalue["Description"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Producers"] as? [String] {
                        service.producers = array
                    }
                    if let num = dvalue["Retail Price"] as? Double {
                        service.retailPrice = num
                    }
                    if let num = dvalue["Sale Price"] as? Double {
                        service.salePrice = num
                    }
                    service.merchType = merchType
                    service.serviceType = servtype
                    service.tDAppId = tdID
                    service.name = name
                    service.numberOfFavorites = nof
                    service.numberOfPurchases = nop
                    service.description = description
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    service.dateUploaded = date
                    latestDate = date
                    merch.service = service
                case 12:
                    let botval = child.value as! [String:Any]
                    let instr = MerchInstrumentalData(instrumentaldbid: key, retailPrice: 0.0, salePrice: nil, quantity: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date())
                    instr.retailPrice = botval["Retail Price"] as! Double
                    instr.merchType = botval["Merch Type"] as! String
                    instr.numberOfPurchases = botval["Number of Purchases"] as! Int
                    let predate = botval["Date Uploaded"] as! String
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    instr.dateUploaded = date
                    if let ite = botval["Sale Price"] as? Double {
                        instr.salePrice = ite
                    }
                    if let ite = botval["Quantity"] as? Int {
                        instr.quantity = ite
                    }
                    latestDate = instr.dateUploaded
                    merch.instrumentalSale = instr
                default:
                    print("Latest Merch Fecth Error")
                }
                
                if  datetemp.count < amount {
                    merchArray.append(merch)
                    datetemp.append(latestDate)
                } else if latestDate > datetemp.min()! {
                    let it = datetemp.firstIndex(of: datetemp.min()!)
                    datetemp.remove(at: it!)
                    merchArray.remove(at: it!)
                    datetemp.append(latestDate)
                    merchArray.append(merch)
                }
            }
            
            completion(merchArray)
        })
    }
    
    func fetchAllMerch(completion: @escaping (([MerchData]) -> Void)) {
        var merchArray:[MerchData] = []
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: {[weak self] snap in
            guard let strongSelf = self else {return}
            for kid in snap.children {
                let child = kid as! DataSnapshot
                let key = child.key
                let word = key.split(separator: "Ã†")
                let id = String(word[0])
                let merch = MerchData(kit: nil, apperal: nil, instrumentalSale: nil, service: nil, memorabilia: nil)
                switch id.count {
                case 24:
                    let memo = MerchMemorabiliaData(date: Date(), colors: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        memo.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        memo.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        memo.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        memo.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        memo.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        memo.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        memo.instrumentals = array
                    }
                    for sub in child.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        if dkey == "Colors" {
                            var colorArr:[MemorabiliaColorData] = []
                            for siz in up.children {
                                let sze = siz as! DataSnapshot
                                let size = sze.key
                                let colordata = MemorabiliaColorData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0)
                                let cval = sze.value as! [String:Any]
                                let coll = cval["Color"] as! String
                                let dateRes = cval["Date Restocked"] as! String
                                let descript = cval["Description"] as! String
                                let nopur = cval["Number of Purchases"] as! Int
                                let quan = cval["Quantity"] as! Int
                                let repe = cval["Retail Price"] as! Double
                                if let sale = cval["Sale Price"] as? Double {
                                    colordata.salePrice = sale
                                }
                                
                                colordata.color = coll
                                let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                colordata.dateLastRestocked = dateee
                                colordata.description = descript
                                colordata.numberOfPurchases = nopur
                                colordata.quantity = quan
                                colordata.retailPrice = repe
                                
                                
                                colorArr.append(colordata)
                                memo.colors = colorArr
                                
                            }
                        }
                    }
                    memo.merchType = merchType
                    memo.imageURLs = images
                    memo.subcategory = subcat
                    memo.tDAppId = tdID
                    memo.name = name
                    memo.numberOfFavorites = nof
                    memo.numberOfPurchases = nop
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    memo.date = date
                    
                    merch.memorabilia = memo
                case 23:
                    let apperal = MerchApperalData(date: Date(), osfaSize: nil, xxsmallSize: nil,xsmallSize: nil,smallSize: nil,mediumSize: nil,largeSize: nil,xlargeSize: nil,xxlargeSize: nil,xxxlargeSize: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        apperal.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        apperal.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        apperal.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        apperal.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        apperal.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        apperal.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        apperal.instrumentals = array
                    }
                    for sub in child.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        if dkey == "Sizes" {
                            var osfaarr:[ApperalSizeData] = []
                            var xxsmallarr:[ApperalSizeData] = []
                            var xsmallarr:[ApperalSizeData] = []
                            var smallarr:[ApperalSizeData] = []
                            var mediumarr:[ApperalSizeData] = []
                            var largearr:[ApperalSizeData] = []
                            var xlargearr:[ApperalSizeData] = []
                            var xxlargearr:[ApperalSizeData] = []
                            var xxxlargearr:[ApperalSizeData] = []
                            for siz in up.children {
                                let sze = siz as! DataSnapshot
                                let size = sze.key
                                for col in sze.children {
                                    let sizedata = ApperalSizeData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0, size: "")
                                    
                                    let cole = col as! DataSnapshot
                                    let color = cole.key
                                    let cval = cole.value as! [String:Any]
                                    let coll = cval["Color"] as! String
                                    let dateRes = cval["Date Restocked"] as! String
                                    let descript = cval["Description"] as! String
                                    let nopur = cval["Number of Purchases"] as! Int
                                    let quan = cval["Quantity"] as! Int
                                    let repe = cval["Retail Price"] as! Double
                                    let dasize = cval["Size"] as! String
                                    
                                    sizedata.color = coll
                                    let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                    sizedata.dateLastRestocked = dateee
                                    sizedata.description = descript
                                    sizedata.numberOfPurchases = nopur
                                    sizedata.quantity = quan
                                    sizedata.retailPrice = repe
                                    sizedata.size = dasize
                                    
                                    if let sale = cval["Sale Price"] as? Double {
                                        sizedata.salePrice = sale
                                    }
                                    
                                    switch sizedata.size {
                                    case "OSFA":
                                        osfaarr.append(sizedata)
                                        apperal.osfaSize = osfaarr
                                    case "XXS":
                                        xxsmallarr.append(sizedata)
                                        apperal.xxsmallSize = xxsmallarr
                                    case "XS":
                                        xsmallarr.append(sizedata)
                                        apperal.xsmallSize = xsmallarr
                                    case "S":
                                        smallarr.append(sizedata)
                                        apperal.smallSize = smallarr
                                    case "M":
                                        mediumarr.append(sizedata)
                                        apperal.mediumSize = mediumarr
                                    case "L":
                                        largearr.append(sizedata)
                                        apperal.largeSize = largearr
                                    case "XL":
                                        xlargearr.append(sizedata)
                                        apperal.xlargeSize = xlargearr
                                    case "XXL":
                                        xxlargearr.append(sizedata)
                                        apperal.xxlargeSize = xxlargearr
                                    case "XXXL":
                                        xxxlargearr.append(sizedata)
                                        apperal.xxxlargeSize = xxxlargearr
                                    default:
                                        print("you trippin tone")
                                    }
                                    
                                }
                            }
                        }
                    }
                    apperal.merchType = merchType
                    apperal.imageURLs = images
                    apperal.subcategory = subcat
                    apperal.tDAppId = tdID
                    apperal.name = name
                    apperal.numberOfFavorites = nof
                    apperal.numberOfPurchases = nop
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    apperal.date = date
                    
                    merch.apperal = apperal
                case 22:
                    let kit = MerchKitData(date: Date(), description: "", fileURL: "", imageURLs: [], merchType: "", name: "", quantity: 0, numberOfPurchases: 0, numberOfFavorites: 0, previewURL: "", retailPrice: 0.0, salePrice: nil, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let fileurl = dvalue["File URL"] as! String
                    let prevurl = dvalue["Preview URL"] as! String
                    let description = dvalue["Description"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        kit.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        kit.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        kit.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        kit.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        kit.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        kit.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        kit.instrumentals = array
                    }
                    if let num = dvalue["Retail Price"] as? Double {
                        kit.retailPrice = num
                    }
                    if let num = dvalue["Sale Price"] as? Double {
                        kit.salePrice = num
                    }
                    if let num = dvalue["Quantity"] as? Int {
                        kit.quantity = num
                    }
                    kit.merchType = merchType
                    kit.imageURLs = images
                    kit.subcategory = subcat
                    kit.tDAppId = tdID
                    kit.name = name
                    kit.numberOfFavorites = nof
                    kit.numberOfPurchases = nop
                    kit.description = description
                    kit.fileURL = fileurl
                    kit.previewURL = prevurl
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    kit.date = date
                    merch.kit = kit
                case 21:
                    print("Bundle")
                case 20:
                    let service = MerchServiceData(name: "", serviceType: "", tDAppId: "", retailPrice: nil, salePrice: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date(), description: "", producers: nil)
                    let dvalue = child.value as! [String:Any]
                    let merchType = dvalue["Merch Type"] as! String
                    let servtype = dvalue["Service Type"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let description = dvalue["Description"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Producers"] as? [String] {
                        service.producers = array
                    }
                    if let num = dvalue["Retail Price"] as? Double {
                        service.retailPrice = num
                    }
                    if let num = dvalue["Sale Price"] as? Double {
                        service.salePrice = num
                    }
                    service.merchType = merchType
                    service.serviceType = servtype
                    service.tDAppId = tdID
                    service.name = name
                    service.numberOfFavorites = nof
                    service.numberOfPurchases = nop
                    service.description = description
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    service.dateUploaded = date
                    merch.service = service
                case 12:
                    let botval = child.value as! [String:Any]
                    let instr = MerchInstrumentalData(instrumentaldbid: key, retailPrice: 0.0, salePrice: nil, quantity: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date())
                    instr.retailPrice = botval["Retail Price"] as! Double
                    instr.merchType = botval["Merch Type"] as! String
                    instr.numberOfPurchases = botval["Number of Purchases"] as! Int
                    let predate = botval["Date Uploaded"] as! String
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    instr.dateUploaded = date
                    if let ite = botval["Sale Price"] as? Double {
                        instr.salePrice = ite
                    }
                    if let ite = botval["Quantity"] as? Int {
                        instr.quantity = ite
                    }
                    merch.instrumentalSale = instr
                default:
                    print("All Merch Fecth Error")
                }
                merchArray.append(merch)
            }
            completion(merchArray)
        })
    }
    
    func fetchAllMerchKits(completion: @escaping (([MerchKitData]) -> Void)) {
            var merchArray:[MerchKitData] = []
        AllKitsInDatabaseArray = []
        Database.database().reference().child("Merch").keepSynced(true)
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: { snap in
            for kid in snap.children {
                let child = kid as! DataSnapshot
                let key = child.key
                var latestDate:Date!
                let word = key.split(separator: "Ã†")
                let id = String(word[0])
                if id.count == 22 {
                    let kit = MerchKitData(date: Date(), description: "", fileURL: "", imageURLs: [], merchType: "", name: "", quantity: 0, numberOfPurchases: 0, numberOfFavorites: 0, previewURL: "", retailPrice: 0.0, salePrice: 0.0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let fileurl = dvalue["File URL"] as! String
                    let prevurl = dvalue["Preview URL"] as! String
                    let description = dvalue["Description"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        kit.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        kit.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        kit.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        kit.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        kit.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        kit.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        kit.instrumentals = array
                    }
                    if let num = dvalue["Retail Price"] as? Double {
                        kit.retailPrice = num
                    }
                    if let num = dvalue["Sale Price"] as? Double {
                        kit.salePrice = num
                    }
                    if let num = dvalue["Quantity"] as? Int {
                        kit.quantity = num
                    }
                    kit.merchType = merchType
                    kit.imageURLs = images
                    kit.subcategory = subcat
                    kit.tDAppId = tdID
                    kit.name = name
                    kit.numberOfFavorites = nof
                    kit.numberOfPurchases = nop
                    kit.description = description
                    kit.fileURL = fileurl
                    kit.previewURL = prevurl
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    kit.date = date
                    merchArray.append(kit)
                }
            }
            completion(merchArray)
        })
    }
    
    func fetchAllMerchInstrumentals(completion: @escaping (([MerchInstrumentalData]) -> Void)) {
            var merchArray:[MerchInstrumentalData] = []
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: { snap in
            for kid in snap.children {
                let child = kid as! DataSnapshot
                let key = child.key
                let word = key.split(separator: "Ã†")
                let id = String(word[0])
                if id.count == 12 {
                    let botval = child.value as! [String:Any]
                    let instr = MerchInstrumentalData(instrumentaldbid: key, retailPrice: 0.0, salePrice: nil, quantity: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date())
                    instr.retailPrice = botval["Retail Price"] as! Double
                    instr.merchType = botval["Merch Type"] as! String
                    instr.numberOfPurchases = botval["Number of Purchases"] as! Int
                    let predate = botval["Date Uploaded"] as! String
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    instr.dateUploaded = date
                    if let ite = botval["Sale Price"] as? Double {
                        instr.salePrice = ite
                    }
                    if let ite = botval["Quantity"] as? Int {
                        instr.quantity = ite
                    }
                    merchArray.append(instr)
                }
            }
            completion(merchArray)
        })
    }
    
    func fetchAllMerchApperal(completion: @escaping (([MerchApperalData]) -> Void)) {
            var merchArray:[MerchApperalData] = []
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: { snap in
            for kid in snap.children {
                let child = kid as! DataSnapshot
                let key = child.key
                let word = key.split(separator: "Ã†")
                let id = String(word[0])
                if id.count == 23 {
                    let apperal = MerchApperalData(date: Date(), osfaSize: nil, xxsmallSize: nil,xsmallSize: nil,smallSize: nil,mediumSize: nil,largeSize: nil,xlargeSize: nil,xxlargeSize: nil,xxxlargeSize: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        apperal.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        apperal.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        apperal.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        apperal.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        apperal.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        apperal.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        apperal.instrumentals = array
                    }
                    for sub in child.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        if dkey == "Sizes" {
                            var osfaarr:[ApperalSizeData] = []
                            var xxsmallarr:[ApperalSizeData] = []
                            var xsmallarr:[ApperalSizeData] = []
                            var smallarr:[ApperalSizeData] = []
                            var mediumarr:[ApperalSizeData] = []
                            var largearr:[ApperalSizeData] = []
                            var xlargearr:[ApperalSizeData] = []
                            var xxlargearr:[ApperalSizeData] = []
                            var xxxlargearr:[ApperalSizeData] = []
                            for siz in up.children {
                                let sze = siz as! DataSnapshot
                                let size = sze.key
                                for col in sze.children {
                                    let sizedata = ApperalSizeData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0, size: "")
                                    
                                    let cole = col as! DataSnapshot
                                    let color = cole.key
                                    let cval = cole.value as! [String:Any]
                                    let coll = cval["Color"] as! String
                                    let dateRes = cval["Date Restocked"] as! String
                                    let descript = cval["Description"] as! String
                                    let nopur = cval["Number of Purchases"] as! Int
                                    let quan = cval["Quantity"] as! Int
                                    let repe = cval["Retail Price"] as! Double
                                    let dasize = cval["Size"] as! String
                                    
                                    sizedata.color = coll
                                    let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                    sizedata.dateLastRestocked = dateee
                                    sizedata.description = descript
                                    sizedata.numberOfPurchases = nopur
                                    sizedata.quantity = quan
                                    sizedata.retailPrice = repe
                                    sizedata.size = dasize
                                    if let sale = cval["Sale Price"] as? Double {
                                        sizedata.salePrice = sale
                                    }
                                    
                                    switch sizedata.size {
                                    case "OSFA":
                                        osfaarr.append(sizedata)
                                        apperal.osfaSize = osfaarr
                                    case "XXS":
                                        xxsmallarr.append(sizedata)
                                        apperal.xxsmallSize = xxsmallarr
                                    case "XS":
                                        xsmallarr.append(sizedata)
                                        apperal.xsmallSize = xsmallarr
                                    case "S":
                                        smallarr.append(sizedata)
                                        apperal.smallSize = smallarr
                                    case "M":
                                        mediumarr.append(sizedata)
                                        apperal.mediumSize = mediumarr
                                    case "L":
                                        largearr.append(sizedata)
                                        apperal.largeSize = largearr
                                    case "XL":
                                        xlargearr.append(sizedata)
                                        apperal.xlargeSize = xlargearr
                                    case "XXL":
                                        xxlargearr.append(sizedata)
                                        apperal.xxlargeSize = xxlargearr
                                    case "XXXL":
                                        xxxlargearr.append(sizedata)
                                        apperal.xxxlargeSize = xxxlargearr
                                    default:
                                        print("you trippin tone")
                                    }
                                    
                                }
                            }
                        }
                    }
                    apperal.merchType = merchType
                    apperal.imageURLs = images
                    apperal.subcategory = subcat
                    apperal.tDAppId = tdID
                    apperal.name = name
                    apperal.numberOfFavorites = nof
                    apperal.numberOfPurchases = nop
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    apperal.date = date
                    merchArray.append(apperal)
                }
            }
            completion(merchArray)
        })
    }
    
    func fetchAllMerchMemorabilia(completion: @escaping (([MerchMemorabiliaData]) -> Void)) {
            var merchArray:[MerchMemorabiliaData] = []
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: { snap in
            for kid in snap.children {
                let child = kid as! DataSnapshot
                let key = child.key
                let word = key.split(separator: "Ã†")
                let id = String(word[0])
                if id.count == 24 {
                    let memo = MerchMemorabiliaData(date: Date(), colors: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        memo.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        memo.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        memo.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        memo.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        memo.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        memo.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        memo.instrumentals = array
                    }
                    for sub in child.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        if dkey == "Colors" {
                            var colorArr:[MemorabiliaColorData] = []
                            for siz in up.children {
                                let sze = siz as! DataSnapshot
                                let size = sze.key
                                let colordata = MemorabiliaColorData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0)
                                let cval = sze.value as! [String:Any]
                                let coll = cval["Color"] as! String
                                let dateRes = cval["Date Restocked"] as! String
                                let descript = cval["Description"] as! String
                                let nopur = cval["Number of Purchases"] as! Int
                                let quan = cval["Quantity"] as! Int
                                let repe = cval["Retail Price"] as! Double
                                
                                colordata.color = coll
                                let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                colordata.dateLastRestocked = dateee
                                colordata.description = descript
                                colordata.numberOfPurchases = nopur
                                colordata.quantity = quan
                                colordata.retailPrice = repe
                                if let sale = cval["Sale Price"] as? Double {
                                    colordata.salePrice = sale
                                }
                                
                                
                                colorArr.append(colordata)
                                memo.colors = colorArr
                                
                            }
                        }
                    }
                    memo.merchType = merchType
                    memo.imageURLs = images
                    memo.subcategory = subcat
                    memo.tDAppId = tdID
                    memo.name = name
                    memo.numberOfFavorites = nof
                    memo.numberOfPurchases = nop
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    memo.date = date
                    merchArray.append(memo)
                }
            }
            completion(merchArray)
        })
    }
    
    func fetchAllMerchServices(completion: @escaping (([MerchServiceData]) -> Void)) {
            var merchArray:[MerchServiceData] = []
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: { snap in
            for kid in snap.children {
                let child = kid as! DataSnapshot
                let key = child.key
                let word = key.split(separator: "Ã†")
                let id = String(word[0])
                if id.count == 20 {
                    let service = MerchServiceData(name: "", serviceType: "", tDAppId: "", retailPrice: nil, salePrice: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date(), description: "", producers: nil)
                    let dvalue = child.value as! [String:Any]
                    let merchType = dvalue["Merch Type"] as! String
                    let servtype = dvalue["Service Type"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let description = dvalue["Description"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Producers"] as? [String] {
                        service.producers = array
                    }
                    if let num = dvalue["Retail Price"] as? Double {
                        service.retailPrice = num
                    }
                    if let num = dvalue["Sale Price"] as? Double {
                        service.salePrice = num
                    }
                    service.merchType = merchType
                    service.serviceType = servtype
                    service.tDAppId = tdID
                    service.name = name
                    service.numberOfFavorites = nof
                    service.numberOfPurchases = nop
                    service.description = description
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    service.dateUploaded = date
                    merchArray.append(service)
                }
            }
            completion(merchArray)
        })
    }
    
    func fetchAllMerchOnSale(completion: @escaping (([MerchData]) -> Void)) {
        var merchArray:[MerchData] = []
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: {[weak self] snap in
            guard let strongSelf = self else {return}
            for kid in snap.children {
                var onSale = false
                let child = kid as! DataSnapshot
                let key = child.key
                let word = key.split(separator: "Ã†")
                let id = String(word[0])
                let merch = MerchData(kit: nil, apperal: nil, instrumentalSale: nil, service: nil, memorabilia: nil)
                switch id.count {
                case 24:
                    let memo = MerchMemorabiliaData(date: Date(), colors: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        memo.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        memo.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        memo.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        memo.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        memo.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        memo.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        memo.instrumentals = array
                    }
                    for sub in child.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        if dkey == "Colors" {
                            var colorArr:[MemorabiliaColorData] = []
                            for siz in up.children {
                                let sze = siz as! DataSnapshot
                                let size = sze.key
                                let colordata = MemorabiliaColorData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0)
                                let cval = sze.value as! [String:Any]
                                let coll = cval["Color"] as! String
                                let dateRes = cval["Date Restocked"] as! String
                                let descript = cval["Description"] as! String
                                let nopur = cval["Number of Purchases"] as! Int
                                let quan = cval["Quantity"] as! Int
                                let repe = cval["Retail Price"] as! Double
                                
                                colordata.color = coll
                                let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                colordata.dateLastRestocked = dateee
                                colordata.description = descript
                                colordata.numberOfPurchases = nopur
                                colordata.quantity = quan
                                colordata.retailPrice = repe
                                
                                if let sale = cval["Sale Price"] as? Double {
                                    colordata.salePrice = sale
                                    onSale = true
                                }
                                
                                
                                colorArr.append(colordata)
                                memo.colors = colorArr
                                
                            }
                        }
                    }
                    memo.merchType = merchType
                    memo.imageURLs = images
                    memo.subcategory = subcat
                    memo.tDAppId = tdID
                    memo.name = name
                    memo.numberOfFavorites = nof
                    memo.numberOfPurchases = nop
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    memo.date = date
                    
                    merch.memorabilia = memo
                    
                case 23:
                    let apperal = MerchApperalData(date: Date(), osfaSize: nil, xxsmallSize: nil,xsmallSize: nil,smallSize: nil,mediumSize: nil,largeSize: nil,xlargeSize: nil,xxlargeSize: nil,xxxlargeSize: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        apperal.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        apperal.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        apperal.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        apperal.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        apperal.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        apperal.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        apperal.instrumentals = array
                    }
                    for sub in child.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        if dkey == "Sizes" {
                            var osfaarr:[ApperalSizeData] = []
                            var xxsmallarr:[ApperalSizeData] = []
                            var xsmallarr:[ApperalSizeData] = []
                            var smallarr:[ApperalSizeData] = []
                            var mediumarr:[ApperalSizeData] = []
                            var largearr:[ApperalSizeData] = []
                            var xlargearr:[ApperalSizeData] = []
                            var xxlargearr:[ApperalSizeData] = []
                            var xxxlargearr:[ApperalSizeData] = []
                            for siz in up.children {
                                let sze = siz as! DataSnapshot
                                let size = sze.key
                                for col in sze.children {
                                    let sizedata = ApperalSizeData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0, size: "")
                                    
                                    let cole = col as! DataSnapshot
                                    let color = cole.key
                                    let cval = cole.value as! [String:Any]
                                    let coll = cval["Color"] as! String
                                    let dateRes = cval["Date Restocked"] as! String
                                    let descript = cval["Description"] as! String
                                    let nopur = cval["Number of Purchases"] as! Int
                                    let quan = cval["Quantity"] as! Int
                                    let repe = cval["Retail Price"] as! Double
                                    let dasize = cval["Size"] as! String
                                    
                                    sizedata.color = coll
                                    let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                    sizedata.dateLastRestocked = dateee
                                    sizedata.description = descript
                                    sizedata.numberOfPurchases = nopur
                                    sizedata.quantity = quan
                                    sizedata.retailPrice = repe
                                    sizedata.size = dasize
                                    
                                    if let sale = cval["Sale Price"] as? Double {
                                        sizedata.salePrice = sale
                                        onSale = true
                                    }
                                    
                                    switch sizedata.size {
                                    case "OSFA":
                                        osfaarr.append(sizedata)
                                        apperal.osfaSize = osfaarr
                                    case "XXS":
                                        xxsmallarr.append(sizedata)
                                        apperal.xxsmallSize = xxsmallarr
                                    case "XS":
                                        xsmallarr.append(sizedata)
                                        apperal.xsmallSize = xsmallarr
                                    case "S":
                                        smallarr.append(sizedata)
                                        apperal.smallSize = smallarr
                                    case "M":
                                        mediumarr.append(sizedata)
                                        apperal.mediumSize = mediumarr
                                    case "L":
                                        largearr.append(sizedata)
                                        apperal.largeSize = largearr
                                    case "XL":
                                        xlargearr.append(sizedata)
                                        apperal.xlargeSize = xlargearr
                                    case "XXL":
                                        xxlargearr.append(sizedata)
                                        apperal.xxlargeSize = xxlargearr
                                    case "XXXL":
                                        xxxlargearr.append(sizedata)
                                        apperal.xxxlargeSize = xxxlargearr
                                    default:
                                        print("you trippin tone")
                                    }
                                    
                                }
                            }
                        }
                    }
                    apperal.merchType = merchType
                    apperal.imageURLs = images
                    apperal.subcategory = subcat
                    apperal.tDAppId = tdID
                    apperal.name = name
                    apperal.numberOfFavorites = nof
                    apperal.numberOfPurchases = nop
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    apperal.date = date
                    
                    merch.apperal = apperal
                case 22:
                    let kit = MerchKitData(date: Date(), description: "", fileURL: "", imageURLs: [], merchType: "", name: "", quantity: 0, numberOfPurchases: 0, numberOfFavorites: 0, previewURL: "", retailPrice: 0.0, salePrice: 0.0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                    let dvalue = child.value as! [String:Any]
                    let images = dvalue["Images"] as! [String]
                    let merchType = dvalue["Merch Type"] as! String
                    let subcat = dvalue["Sub Category"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let fileurl = dvalue["File URL"] as! String
                    let prevurl = dvalue["Preview URL"] as! String
                    let description = dvalue["Description"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Artists"] as? [String] {
                        kit.artists = array
                    }
                    if let array = dvalue["Producers"] as? [String] {
                        kit.producers = array
                    }
                    if let array = dvalue["Songs"] as? [String] {
                        kit.songs = array
                    }
                    if let array = dvalue["Albums"] as? [String] {
                        kit.albums = array
                    }
                    if let array = dvalue["Videos"] as? [String] {
                        kit.videos = array
                    }
                    if let array = dvalue["Beats"] as? [String] {
                        kit.beats = array
                    }
                    if let array = dvalue["Instrumentals"] as? [String] {
                        kit.instrumentals = array
                    }
                    if let num = dvalue["Retail Price"] as? Double {
                        kit.retailPrice = num
                    }
                    if let num = dvalue["Sale Price"] as? Double {
                        kit.salePrice = num
                        onSale = true
                    }
                    if let num = dvalue["Quantity"] as? Int {
                        kit.quantity = num
                    }
                    kit.merchType = merchType
                    kit.imageURLs = images
                    kit.subcategory = subcat
                    kit.tDAppId = tdID
                    kit.name = name
                    kit.numberOfFavorites = nof
                    kit.numberOfPurchases = nop
                    kit.description = description
                    kit.fileURL = fileurl
                    kit.previewURL = prevurl
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    kit.date = date
                    merch.kit = kit
                case 21:
                    print("Bundle")
                case 20:
                    let service = MerchServiceData(name: "", serviceType: "", tDAppId: "", retailPrice: nil, salePrice: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date(), description: "", producers: nil)
                    let dvalue = child.value as! [String:Any]
                    let merchType = dvalue["Merch Type"] as! String
                    let servtype = dvalue["Service Type"] as! String
                    let tdID = dvalue["Tone Deaf App Id"] as! String
                    let name = dvalue["Name"] as! String
                    let description = dvalue["Description"] as! String
                    let nof = dvalue["Number of Favorites"] as! Int
                    let nop = dvalue["Number of Purchases"] as! Int
                    let predate = dvalue["Date Uploaded"] as! String
                    if let array = dvalue["Producers"] as? [String] {
                        service.producers = array
                    }
                    if let num = dvalue["Retail Price"] as? Double {
                        service.retailPrice = num
                    }
                    if let num = dvalue["Sale Price"] as? Double {
                        service.salePrice = num
                        onSale = true
                    }
                    service.merchType = merchType
                    service.serviceType = servtype
                    service.tDAppId = tdID
                    service.name = name
                    service.numberOfFavorites = nof
                    service.numberOfPurchases = nop
                    service.description = description
                    
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    service.dateUploaded = date
                    merch.service = service
                case 12:
                    let botval = child.value as! [String:Any]
                    let instr = MerchInstrumentalData(instrumentaldbid: key, retailPrice: 0.0, salePrice: nil, quantity: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date())
                    instr.retailPrice = botval["Retail Price"] as! Double
                    instr.merchType = botval["Merch Type"] as! String
                    instr.numberOfPurchases = botval["Number of Purchases"] as! Int
                    let predate = botval["Date Uploaded"] as! String
                    guard predate != "" else {return}
                    let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                    instr.dateUploaded = date
                    if let ite = botval["Sale Price"] as? Double {
                        instr.salePrice = ite
                        onSale = true
                    }
                    if let ite = botval["Quantity"] as? Int {
                        instr.quantity = ite
                    }
                    merch.instrumentalSale = instr
                default:
                    print("All Merch Fecth Error")
                }
                if onSale != false {
                    merchArray.append(merch)
                }
            }
            completion(merchArray)
        })
    }
    
    
    
    func fetchTonesPickSong(completion: @escaping ((SongData) -> Void)) {
        var tonesong:SongData!
        Database.database().reference().child("Current Featured Content").child("Tones Picks").child("Song").observeSingleEvent(of: .value, with: { snapshot in
            
            var youtubeAlts:[String] = []
            let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
            for sub in snapshot.children {
                let up = sub as! DataSnapshot
                let key = up.key
                for kid in up.children {
                    let sub = kid as! DataSnapshot
                    let dkey = sub.key
                    if dkey == "REQUIRED" {
                        var temp:Array<Any> = []
                        let dvalue = sub.value as! [String:Any]
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Artist"] as! Array<String>)
                        temp.append(dvalue["Producers"] as! Array<String>)
                        temp.append(dvalue["Number of Favorites Overall"] as! Int)
                        temp.append(dvalue["Tone Deaf App Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        if let engies1 = dvalue["Engineers"] as? NSDictionary {
                            if let eng = engies1["Mix Engineer"] as? Array<String> {
                                song.songMixEngineer = eng
                            }
                            if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                song.songMasteringEngineer = eng
                            }
                            if let eng = engies1["Recording Engineer"] as? Array<String> {
                                song.songRecordingEngineer = eng
                            }
                        }
                        if let merchandise = (dvalue["Merch"] as? [String]) {
                            song.merch = (merchandise)
                        }
                        if let tval = (dvalue["Instrumentals"] as? [String]) {
                            song.instrumentals = tval
                        }
                        if let tval = (dvalue["Albums"] as? [String]) {
                            song.albums = tval
                        }
                        if let tval = (dvalue["Videos"] as? [String]) {
                            song.videos = tval
                        }
                        if let tval = (dvalue["Writers"] as? [String]) {
                            song.songWriters = tval
                        }
                        if let tval = (dvalue["Manual Image URL"] as? String) {
                            song.manualImageURL = tval
                        }
                        if let tval = (dvalue["Manual Preview URL"] as? String) {
                            song.manualPreviewURL = tval
                        }
                        if let tval = (dvalue["Industry Certified"] as? Bool) {
                            song.industryCerified = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            song.verificationLevel = Character(tval)
                        }
                        if let tval = (dvalue["Explicit"] as? Bool) {
                            song.explicit = tval
                        }
                        if let tval = (dvalue["Date Registered To App"] as? String) {
                            song.dateRegisteredToApp = tval
                        }
                        if let tval = (dvalue["Time Registered To App"] as? String) {
                            song.timeRegisteredToApp = tval
                        }
                        if let tval = (dvalue["Remixes"] as? [String]) {
                            song.remixes = tval
                        }
                        if let tval = (dvalue["Other Versions"] as? [String]) {
                            song.otherVersions = tval
                        }
                        if let taval = (dvalue["Remix"] as? NSDictionary) {
                            let deluxe = SongRemixData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            song.isRemix = deluxe
                        }
                        if let taval = (dvalue["Other Version"] as? NSDictionary) {
                            let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            song.isOtherVersion = deluxe
                        }
                        
                        song.name = temp[0] as! String
                        song.songArtist = temp[1] as! Array<String>
                        song.songProducers = temp[2] as! Array<String>
                        song.favoritesOverall = temp[3] as! Int
                        song.toneDeafAppId = temp[4] as! String
                        song.isActive = temp[5] as! Bool
                    }
                    if dkey.contains(appleMusicContentType) == true {
                        let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Date Released On Apple"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Explicity"] as! Bool)
                        temp.append(dvalue["Artist"] as! String)
                        temp.append(dvalue["Album Name"] as! String)
                        temp.append(dvalue["Track Number"] as! Int)
                        temp.append(dvalue["Apple Music Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        apple.appleName = temp[0] as! String
                        apple.appleDuration = temp[1] as! String
                        apple.appleDateIA = temp[2] as! String
                        apple.appleDateAPPL = temp[3] as! String
                        apple.applePreviewURL = temp[4] as! String
                        apple.appleISRC = temp[5] as! String
                        apple.appleFavorites = temp[6] as! Int
                        apple.appleArtworkURL = temp[7] as! String
                        apple.appleTimeIA = temp[8] as! String
                        apple.appleSongURL = temp[9] as! String
                        apple.appleExplicity = temp[10] as! Bool
                        apple.appleArtist = temp[11] as! String
                        apple.appleAlbumName = temp[12] as! String
                        apple.appleTrackNumber = temp[13] as! Int
                        apple.appleMusicId = temp[14] as! String
                        apple.isActive = temp[15] as! Bool
                        
                        song.apple = apple
                        
                    }
                    if dkey.contains(spotifyMusicContentType) == true {
                        let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Date Released On Spotify"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Explicity"] as! Bool)
                        temp.append(dvalue["Artist 1"] as! String)
                        temp.append(dvalue["Artist 1 URL"] as! String)
                        temp.append(dvalue["Artist 2"] as! String)
                        temp.append(dvalue["Artist 2 URL"] as! String)
                        temp.append(dvalue["Artist 3"] as! String)
                        temp.append(dvalue["Artist 3 URL"] as! String)
                        temp.append(dvalue["Artist 4"] as! String)
                        temp.append(dvalue["Artist 4 URL"] as! String)
                        temp.append(dvalue["Artist 5"] as! String)
                        temp.append(dvalue["Artist 5 URL"] as! String)
                        temp.append(dvalue["Artist 6"] as! String)
                        temp.append(dvalue["Artist 6 URL"] as! String)
                        temp.append(dvalue["Album Type"] as! String)
                        temp.append(dvalue["Track Number"] as! Int)
                        temp.append(dvalue["Spotify Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        spotify.spotifyName = temp[0] as! String
                        spotify.spotifyDuration = temp[1] as! String
                        spotify.spotifyDateIA = temp[2] as! String
                        spotify.spotifyDateSPT = temp[3] as! String
                        spotify.spotifyPreviewURL = temp[4] as! String
                        spotify.spotifyISRC = temp[5] as! String
                        spotify.spotifyFavorites = temp[6] as! Int
                        spotify.spotifyArtworkURL = temp[7] as! String
                        spotify.spotifyTimeIA = temp[8] as! String
                        spotify.spotifySongURL = temp[9] as! String
                        spotify.spotifyExplicity = temp[10] as! Bool
                        spotify.spotifyArtist1 = temp[11] as! String
                        spotify.spotifyArtist1URL = temp[12] as! String
                        spotify.spotifyArtist2 = temp[13] as! String
                        spotify.spotifyArtist2URL = temp[14] as! String
                        spotify.spotifyArtist3 = temp[15] as! String
                        spotify.spotifyArtist3URL = temp[16] as! String
                        spotify.spotifyArtist4 = temp[17] as! String
                        spotify.spotifyArtist4URL = temp[18] as! String
                        spotify.spotifyArtist5 = temp[19] as! String
                        spotify.spotifyArtist5URL = temp[20] as! String
                        spotify.spotifyArtist6 = temp[21] as! String
                        spotify.spotifyArtis6URL = temp[22] as! String
                        spotify.spotifyAlbumType = temp[23] as! String
                        spotify.spotifyTrackNumber = temp[24] as! Int
                        spotify.spotifyId = temp[25] as! String
                        spotify.isActive = temp[26] as! Bool
                        
                        song.spotify = spotify
                        
                    }
                    if dkey.contains(soundcloudMusicContentType) == true {
                        let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        soundcloud.url = temp[0] as! String
                        soundcloud.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Soundcloud"] != nil {
                            soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                        }
                        song.soundcloud = soundcloud
                    }
                    if dkey.contains(youtubeMusicContentType) == true {
                        let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        youtubeMusic.url = temp[0] as! String
                        youtubeMusic.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.youtubeMusic = youtubeMusic
                    }
                    if dkey.contains(amazonMusicContentType) == true {
                        let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        amazon.url = temp[0] as! String
                        amazon.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            amazon.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.amazon = amazon
                    }
                    if dkey.contains(deezerMusicContentType) == true {
                        let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        
                        temp.append(dvalue["Date Released On Deezer"] as! String)
                        temp.append(dvalue["Artist"] as! [[String : Any]])
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["ISRC"] as! String)
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Song URL"] as! String)
                        temp.append(dvalue["Preview URL"] as! String)
                        temp.append(dvalue["Time Registered To App"] as! String)
                        temp.append(dvalue["Deezer Music Id"] as! Int)
                        temp.append(dvalue["Date Registered To App"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        deezer.deezerDate = temp[0] as! String
                        deezer.artist = temp[1] as! [[String : Any]]
                        deezer.imageurl = temp[2] as! String
                        deezer.duration = temp[3] as! String
                        deezer.isrc = temp[4] as! String
                        deezer.name = temp[5] as! String
                        deezer.url = temp[6] as! String
                        deezer.previewURL = temp[7] as! String
                        deezer.timeIA = temp[8] as! String
                        deezer.deezerID = temp[9] as! Int
                        deezer.dateIA = temp[10] as! String
                        deezer.isActive = temp[11] as! Bool
                        
                        song.deezer = deezer
                    }
                    if dkey.contains(spinrillaMusicContentType) == true {
                        let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        spinrilla.url = temp[0] as! String
                        spinrilla.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Spinrilla"] != nil {
                            spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                        }
                        song.spinrilla = spinrilla
                    }
                    if dkey.contains(napsterMusicContentType) == true {
                        let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        napster.url = temp[0] as! String
                        napster.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            napster.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.napster = napster
                    }
                    if dkey.contains(tidalMusicContentType) == true {
                        let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = sub.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        tidal.url = temp[0] as! String
                        tidal.isActive = temp[1] as! Bool
                        if dvalue["Artwork URL"] != nil {
                            tidal.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        song.tidal = tidal
                    }
                    if dkey == "Videos" {
                            for diva in sub.children {
                                let lsat = diva as! DataSnapshot
                                let vidkey = lsat.key
                                if vidkey == "Official" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.officialVideo = temp[0] as! String
                                }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                            }
                    }
                    
                }
                //print(up.key)
                
                tonesong = song
                completion(tonesong)
            }
        })
    }
    
    func fetchTonesPickBeat(completion: @escaping ((BeatData) -> Void)) {
        var toneinstrumental:BeatData!
        let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
        Database.database().reference().child("Current Featured Content").child("Tones Picks").child("Beat").observeSingleEvent(of: .value, with: { snapshot in
            for item in snapshot.children {
                let bea = item as! DataSnapshot
                let key = bea.key
                    var temp:Array<Any> = []
                    let value = bea.value as! [String:Any]
                var typeArray:[String] = []
                var soundArray:[String] = []
                var time:String!
                var date:String!
                if let tval = value["Duration"] as? String {
                    beat.duration = tval
                }
                if let tval = value["Name"] as? String {
                    beat.name = tval
                }
                if let tval = value["Date"] as? String {
                    beat.date = tval
                    date = tval
                }
                if let tval = value["Number of Downloads"] as? Int {
                    beat.downloads = tval
                }
                if let tval = value["Wav Price"] as? Double {
                    beat.wavPrice = tval
                }
                if let tval = value["Lease Price"] as? Double {
                    beat.mp3Price = tval
                }
                if let tval = value["Exclusive Price"] as? Double {
                    beat.exclusivePrice = tval
                }
                if let tval = value["Time"] as? String {
                    beat.time = tval
                    time = tval
                }
                if let tval = value["Types"] as? [String] {
                    beat.types = tval
                }
                if let tval = value["Sounds"] as? [String] {
                    beat.sounds = tval
                }
                if let tval = value["Tempo"] as? Int {
                    beat.tempo = tval
                }
                if let tval = value["Audio"] as? String {
                    beat.audioURL = tval
                }
                if let tval = value["Image"] as? String {
                    beat.imageURL = tval
                }
                if let tval = value["beatId"] as? String {
                    beat.beatID = tval
                }
                if let tval = value["Price Type"] as? String {
                    beat.priceType = tval
                }
                if let tval = value["Producers"] as? [String] {
                    beat.producers = tval
                }
                if let tval = value["Tone Deaf App Id"] as? String {
                    beat.toneDeafAppId = tval
                }
                if let tval = value["Exclusive Files URL"] as? String {
                    beat.exclusiveFilesURL = tval
                }
                if let tval = value["Wav URL"] as? String {
                    beat.wavURL = tval
                }
                if let tval = value["Official Video"] as? String {
                    beat.officialVideo = tval
                }
                if let tval = value["Videos"] as? [String] {
                    beat.videos = tval
                }
                if let tval = value["Key"] as? String {
                    beat.key = tval
                }
                if let tval = value["Active Status"] as? Bool {
                    beat.isActive = tval
                }
                if let merchandise = (value["Merch"] as? [String]) {
                    beat.merch = (merchandise)
                }
                beat.datetime = "\(date)\(time)"
                let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                for kiddo in bea.children {
                    let dada = kiddo as! DataSnapshot
                    if dada.key.contains(soundcloudMusicContentType) == true {
                        var temp:Array<Any> = []
                        let dvalue = dada.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        soundcloud.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Soundcloud"] != nil {
                            soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                        }
                        beat.soundcloud = soundcloud
                    }
                }
                    //print("ðŸ“™ beat \(beat)")
                    toneinstrumental = beat
                completion(toneinstrumental)
            }
        })
    }
    
    func fetchTonesPickInstrumental(completion: @escaping ((InstrumentalData) -> Void)) {
        var tonebeat:InstrumentalData!
        Database.database().reference().child("Current Featured Content").child("Tones Picks").child("Instrumental").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                    
                let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                var ltemp:Array<Any> = []
                let dvalue = data.value as! [String:Any]
                ltemp.append(dvalue["Name"] as! String)
                ltemp.append(dvalue["Producers"] as! Array<String>)
                ltemp.append(dvalue["Audio URL"] as! String)
                ltemp.append(dvalue["Time Uploaded To App"] as! String)
                ltemp.append(dvalue["Date Uploaded To App"] as! String)
                ltemp.append(dvalue["Duration"] as! String)
                ltemp.append(dvalue["Number of Favorites"] as! Int)
                ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                ltemp.append(dvalue["Active Status"] as! Bool)
                if let tval = (dvalue["Songs"] as? [String]) {
                    instrumental.songs = tval
                }
                if let tval = (dvalue["Albums"] as? [String]) {
                    instrumental.albums = tval
                }
                if let tval = (dvalue["Mix Engineers"] as? [String]) {
                    instrumental.mixEngineer = tval
                }
                if let tval = (dvalue["Mastering Engineers"] as? [String]) {
                    instrumental.masteringEngineer = tval
                }
                if let tval = (dvalue["Videos"] as? [String]) {
                    instrumental.videos = tval
                }
                if let merchandise = (dvalue["Merch"] as? [String]) {
                    instrumental.merch = (merchandise)
                }
                if let tval = (dvalue["Artists"] as? [String]) {
                    instrumental.artist = tval
                }
                if let tval = (dvalue["Manual Image URL"] as? String) {
                    instrumental.manualImageURL = tval
                }
                if let tval = (dvalue["Manual Preview URL"] as? String) {
                    instrumental.manualPreviewURL = tval
                }
                if let tval = (dvalue["Industry Certified"] as? Bool) {
                    instrumental.industryCerified = tval
                }
                if let tval = (dvalue["Verification Level"] as? String) {
                    instrumental.verificationLevel = Character(tval)
                }
                for chi in data.children {
                    let da = chi as! DataSnapshot
                    let lilkey = da.key
                    if lilkey == "Store Info" {
                        let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                        let botval = da.value as! [String:Any]
                        
                        inststore.retailPrice = botval["Retail Price"] as! Double
                        inststore.merchType = botval["Merch Type"] as! String
                        inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                        let predate = botval["Date Uploaded"] as! String
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        inststore.dateUploaded = date
                        if let ite = botval["Sale Price"] as? Double {
                            inststore.salePrice = ite
                        }
                        if let ite = botval["Quantity"] as? Int {
                            inststore.quantity = ite
                        }
                        instrumental.storeInfo = inststore
                    }
                    if lilkey == "Videos" {
                        for dis in da.children {
                            let fha = dis as! DataSnapshot
                            let dvalue = fha.value as! [String:Any]
                            if let tval = (dvalue["Official"] as? String) {
                                instrumental.officialVideo = tval
                            }
                        }
                    }
                }
                instrumental.instrumentalName = ltemp[0] as! String
                instrumental.producers = ltemp[1] as! Array<String>
                instrumental.audioURL = ltemp[2] as! String
                instrumental.timeRegisteredToApp = ltemp[3] as! String
                instrumental.dateRegisteredToApp = ltemp[4] as! String
                instrumental.duration = ltemp[5] as! String
                instrumental.favoritesOverall = ltemp[6] as! Int
                instrumental.toneDeafAppId = ltemp[7] as! String
                instrumental.isActive = ltemp[8] as! Bool
                let songname = ltemp[0] as! String
                instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                for val in data.children {
                    var temp:Array<Any> = []
                    let cont = val as! DataSnapshot
                    let chi = cont.key
                    if (chi).contains(spotifyMusicContentType) == true {
                        let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                        
                        let svalue = cont.value as! [String:Any]
                        temp.append(svalue["Name"] as! String)
                        temp.append(svalue["Duration"] as! String)
                        temp.append(svalue["Date Uploaded To App"] as! String)
                        temp.append(svalue["Date Released On Spotify"] as! String)
                        temp.append(svalue["Preview URL"] as! String)
                        temp.append(svalue["ISRC"] as! String)
                        temp.append(svalue["Number of Favorites"] as! Int)
                        temp.append(svalue["Artwork URL"] as! String)
                        temp.append(svalue["Time Uploaded To App"] as! String)
                        temp.append(svalue["Song URL"] as! String)
                        temp.append(svalue["Explicity"] as! Bool)
                        temp.append(svalue["Artist 1"] as! String)
                        temp.append(svalue["Artist 1 URL"] as! String)
                        temp.append(svalue["Artist 2"] as! String)
                        temp.append(svalue["Artist 2 URL"] as! String)
                        temp.append(svalue["Artist 3"] as! String)
                        temp.append(svalue["Artist 3 URL"] as! String)
                        temp.append(svalue["Artist 4"] as! String)
                        temp.append(svalue["Artist 4 URL"] as! String)
                        temp.append(svalue["Artist 5"] as! String)
                        temp.append(svalue["Artist 5 URL"] as! String)
                        temp.append(svalue["Artist 6"] as! String)
                        temp.append(svalue["Artist 6 URL"] as! String)
                        temp.append(svalue["Album Type"] as! String)
                        temp.append(svalue["Track Number"] as! Int)
                        temp.append(svalue["Spotify Id"] as! String)
                        ltemp.append(dvalue["Active Status"] as! Bool)
                        
                        spotify.spotifyName = temp[0] as! String
                        spotify.spotifyDuration = temp[1] as! String
                        spotify.spotifyDateIA = temp[2] as! String
                        spotify.spotifyDateSPT = temp[3] as! String
                        spotify.spotifyPreviewURL = temp[4] as! String
                        spotify.spotifyISRC = temp[5] as! String
                        spotify.spotifyFavorites = temp[6] as! Int
                        spotify.spotifyArtworkURL = temp[7] as! String
                        spotify.spotifyTimeIA = temp[8] as! String
                        spotify.spotifySongURL = temp[9] as! String
                        spotify.spotifyExplicity = temp[10] as! Bool
                        spotify.spotifyArtist1 = temp[11] as! String
                        spotify.spotifyArtist1URL = temp[12] as! String
                        spotify.spotifyArtist2 = temp[13] as! String
                        spotify.spotifyArtist2URL = temp[14] as! String
                        spotify.spotifyArtist3 = temp[15] as! String
                        spotify.spotifyArtist3URL = temp[16] as! String
                        spotify.spotifyArtist4 = temp[17] as! String
                        spotify.spotifyArtist4URL = temp[18] as! String
                        spotify.spotifyArtist5 = temp[19] as! String
                        spotify.spotifyArtist5URL = temp[20] as! String
                        spotify.spotifyArtist6 = temp[21] as! String
                        spotify.spotifyArtis6URL = temp[22] as! String
                        spotify.spotifyAlbumType = temp[23] as! String
                        spotify.spotifyTrackNumber = temp[24] as! Int
                        spotify.spotifyId = temp[25] as! String
                        spotify.isActive = ltemp[26] as! Bool
                        
                        instrumental.spotify = spotify
                    }
                    if (chi).contains(appleMusicContentType) == true {
                        let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                        var temp:Array<Any> = []
                        let svalue = cont.value as! [String:Any]
                        temp.append(svalue["Name"] as! String)
                        temp.append(svalue["Duration"] as! String)
                        temp.append(svalue["Date Uploaded To App"] as! String)
                        temp.append(svalue["Date Released On Apple"] as! String)
                        temp.append(svalue["Preview URL"] as! String)
                        temp.append(svalue["ISRC"] as! String)
                        temp.append(svalue["Number of Favorites"] as! Int)
                        temp.append(svalue["Artwork URL"] as! String)
                        temp.append(svalue["Time Uploaded To App"] as! String)
                        temp.append(svalue["Song URL"] as! String)
                        temp.append(svalue["Explicity"] as! Bool)
                        temp.append(svalue["Artist"] as! String)
                        temp.append(svalue["Album Name"] as! String)
                        temp.append(svalue["Track Number"] as! Int)
                        temp.append(svalue["Apple Music Id"] as! String)
                        ltemp.append(dvalue["Active Status"] as! Bool)
                        
                        apple.appleName = temp[0] as! String
                        apple.appleDuration = temp[1] as! String
                        apple.appleDateIA = temp[2] as! String
                        apple.appleDateAPPL = temp[3] as! String
                        apple.applePreviewURL = temp[4] as! String
                        apple.appleISRC = temp[5] as! String
                        apple.appleFavorites = temp[6] as! Int
                        apple.appleArtworkURL = temp[7] as! String
                        apple.appleTimeIA = temp[8] as! String
                        apple.appleSongURL = temp[9] as! String
                        apple.appleExplicity = temp[10] as! Bool
                        apple.appleArtist = temp[11] as! String
                        apple.appleAlbumName = temp[12] as! String
                        apple.appleTrackNumber = temp[13] as! Int
                        apple.appleMusicId = temp[14] as! String
                        apple.isActive = ltemp[15] as! Bool
                        
                        instrumental.apple = apple
                    }
                    if chi.contains(soundcloudMusicContentType) == true {
                        let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = cont.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        soundcloud.url = temp[0] as! String
                            soundcloud.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            instrumental.soundcloud = soundcloud
                        }
                        if chi.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            youtubeMusic.url = temp[0] as! String
                            youtubeMusic.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            instrumental.youtubeMusic = youtubeMusic
                        }
                        if chi.contains(amazonMusicContentType) == true {
                            let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            amazon.url = temp[0] as! String
                            amazon.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            instrumental.amazon = amazon
                        }
                        if chi.contains(deezerMusicContentType) == true {
                            let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String : Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String : Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.isrc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.previewURL = temp[7] as! String
                            deezer.timeIA = temp[8] as! String
                            deezer.deezerID = temp[9] as! Int
                            deezer.dateIA = temp[10] as! String
                            deezer.isActive = temp[11] as! Bool
                            
                            instrumental.deezer = deezer
                        }
                        if chi.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            spinrilla.url = temp[0] as! String
                            spinrilla.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            instrumental.spinrilla = spinrilla
                        }
                        if chi.contains(napsterMusicContentType) == true {
                            let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            napster.url = temp[0] as! String
                            napster.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            instrumental.napster = napster
                        }
                        if chi.contains(tidalMusicContentType) == true {
                            let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            tidal.url = temp[0] as! String
                            tidal.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            instrumental.tidal = tidal
                        }
                    }
                    tonebeat = instrumental
                completion(tonebeat)
            }
        })
    }
    
    func fetchTonesPickAlbum(completion: @escaping ((AlbumData) -> Void)) {
        var tonealbum:AlbumData!
        Database.database().reference().child("Current Featured Content").child("Tones Picks").child("Album").observeSingleEvent(of: .value, with: { snapshot in
            for sub in snapshot.children {
                let ch = sub as! DataSnapshot
                let key = ch.key
                var youtubeAlts:[String] = []
                let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                for sub in ch.children {
                    let up = sub as! DataSnapshot
                    let dkey = up.key
                    //print(up.key)
                    if dkey == "REQUIRED" {
                        var temp:Array<Any> = []
                        let dvalue = up.value as! [String:Any]
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Main Artist"] as! Array<String>)
                        temp.append(dvalue["All Producers"] as! Array<String>)
                        temp.append(dvalue["Number of Favorites Overall"] as! Int)
                        temp.append(dvalue["Tone Deaf App Id"] as! String)
                        temp.append(dvalue["Number Of Tracks"] as! Int)
                        temp.append(dvalue["Time Registered To App"] as! String)
                        temp.append(dvalue["Date Registered To App"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        if let tval = (dvalue["All Artist"]) as? [String] {
                            album.allArtists = tval
                        }
                        if let tval = (dvalue["All Writers"]) as? [String] {
                            album.writers = tval
                        }
                        if let trval = (dvalue["Engineers"]) as? NSDictionary {
                            if let tval = (trval["Mix Engineer"]) as? [String] {
                                album.mixEngineers = tval
                            }
                        }
                        if let trval = (dvalue["Engineers"]) as? NSDictionary {
                            if let tval = (trval["Mastering Engineer"]) as? [String] {
                                album.masteringEngineers = tval
                            }
                        }
                        if let trval = (dvalue["Engineers"]) as? NSDictionary {
                            if let tval = (trval["Recording Engineer"]) as? [String] {
                                album.recordingEngineers = tval
                            }
                        }
                        if let merchandise = (dvalue["Merch"]) {
                            album.merch = (merchandise as! [String])
                        }
                        if let tval = (dvalue["Songs"]) as? [String] {
                            album.songs = tval
                        }
                        if let tval = (dvalue["Instrumentals"]) as? [String] {
                            album.instrumentals = tval
                        }
                        if let tval = (dvalue["Videos"]) as? [String] {
                            album.videos = tval
                        }
                        if let tval = (dvalue["Tracks"]) as? [String:String] {
                            album.tracks = tval
                        }
                        if let tval = (dvalue["Manual Image URL"]) as? String {
                            album.manualImageURL = tval
                        }
                        if let tval = (dvalue["Manual Preview URL"]) as? String {
                            album.manualPreviewURL = tval
                        }
                        if let tval = (dvalue["Industry Certified"] as? Bool) {
                            album.industryCerified = tval
                        }
                        if let tval = (dvalue["Verification Level"] as? String) {
                            album.verificationLevel = Character(tval)
                        }
                        if let tval = (dvalue["Deluxes"] as? [String]) {
                            album.deluxes = tval
                        }
                        if let tval = (dvalue["Other Versions"] as? [String]) {
                            album.otherVersions = tval
                        }
                        if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                            let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isDeluxe = deluxe
                        }
                        if let taval = (dvalue["Other Version"] as? NSDictionary) {
                            let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isOtherVersion = deluxe
                        }
                        
                        
                        album.name = temp[0] as! String
                        album.mainArtist = temp[1] as! Array<String>
                        album.producers = temp[2] as! Array<String>
                        album.favoritesOverall = temp[3] as! Int
                        album.toneDeafAppId = temp[4] as! String
                        album.numberofTracks = temp[5] as! Int
                        album.timeRegisteredToApp = temp[6] as! String
                        album.dateRegisteredToApp = temp[7] as! String
                        album.isActive = temp[8] as! Bool
                    }
                    if dkey.contains("APPL") == true {
                        let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Artists"] as! String)
                        temp.append(dvalue["Date Released On Apple"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Album URL"] as! String)
                        //temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Number of Tracks"] as! Int)
                        temp.append(dvalue["Apple Music Id"] as! String)
                        temp.append(dvalue["Active Status"] as! Bool)
                        
                        appleData.name = temp[0] as! String
                        appleData.artist = temp[1] as! String
                        appleData.dateReleasedApple = temp[2] as! String
                        appleData.timeIA = temp[3] as! String
                        appleData.dateIA = temp[4] as! String
                        appleData.imageURL = temp[5] as! String
                        appleData.url = temp[6] as! String
                        //appleData. = temp[6] as! Int
                        appleData.trackCount = temp[7] as! Int
                        appleData.appleId = temp[8] as! String
                        appleData.isActive = temp[8] as! Bool
                        
                        album.apple = appleData
                    }
                    if dkey.contains("SPTY") == true {
                        let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Artists"] as! [[String:String]])
                        temp.append(dvalue["UPC"] as! String)
                        temp.append(dvalue["Date Released On Spotify"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Album URL"] as! String)
                        temp.append(dvalue["Album URI"] as! String)
                        //temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Number of Tracks"] as! Int)
                        temp.append(dvalue["Spotify Id"] as! String)
                        
                        spotifyData.name = temp[0] as! String
                        spotifyData.artist = temp[1] as! [[String:String]]
                        spotifyData.upc = temp[2] as! String
                        spotifyData.dateReleasedSpotify = temp[3] as! String
                        spotifyData.timeIA = temp[4] as! String
                        spotifyData.dateIA = temp[5] as! String
                        spotifyData.imageURL = temp[6] as! String
                        spotifyData.url = temp[7] as! String
                        spotifyData.uri = temp[8] as! String
                        //spotifyData. = temp[10] as! Bool
                        spotifyData.trackNumberTotal = temp[9] as! Int
                        spotifyData.spotifyId = temp[10] as! String
                        
                        album.spotify = spotifyData
                        
                    }
                    if dkey.contains(soundcloudMusicContentType) == true {
                        let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        soundcloud.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Soundcloud"] != nil {
                            soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                        }
                        album.soundcloud = soundcloud
                    }
                    if dkey.contains(youtubeMusicContentType) == true {
                        let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        youtubeMusic.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        album.youtubeMusic = youtubeMusic
                    }
                    if dkey.contains(amazonMusicContentType) == true {
                        let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        amazon.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            amazon.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        album.amazon = amazon
                    }
                    if dkey.contains(deezerMusicContentType) == true {
                        let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        
                        temp.append(dvalue["Date Released On Deezer"] as! String)
                        temp.append(dvalue["Artist"] as! [[String:Any]])
                        temp.append(dvalue["Artwork URL"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["UPC"] as! String)
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Album URL"] as! String)
                        temp.append(dvalue["Time Registered To App"] as! String)
                        temp.append(dvalue["Deezer Music Id"] as! Int)
                        temp.append(dvalue["Date Registered To App"] as! String)
                        
                        deezer.deezerDate = temp[0] as! String
                        deezer.artist = temp[1] as! [[String:Any]]
                        deezer.imageurl = temp[2] as! String
                        deezer.duration = temp[3] as! String
                        deezer.upc = temp[4] as! String
                        deezer.name = temp[5] as! String
                        deezer.url = temp[6] as! String
                        deezer.timeIA = temp[7] as! String
                        deezer.deezerID = temp[8] as! Int
                        deezer.dateIA = temp[9] as! String
                        
                        album.deezer = deezer
                    }
                    if dkey.contains(spinrillaMusicContentType) == true {
                        let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        spinrilla.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        if dvalue["Date Released On Spinrilla"] != nil {
                            spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                        }
                        album.spinrilla = spinrilla
                    }
                    if dkey.contains(napsterMusicContentType) == true {
                        let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        napster.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            napster.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        album.napster = napster
                    }
                    if dkey.contains(tidalMusicContentType) == true {
                        let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                        var temp:Array<Any> = []
                        let dvalue = up.value! as! [String:Any]
                        temp.append(dvalue["url"] as! String)
                        tidal.url = temp[0] as! String
                        if dvalue["Artwork URL"] != nil {
                            tidal.imageurl = (dvalue["Artwork URL"] as! String)
                        }
                        album.tidal = tidal
                    }
                    if dkey == "Videos" {
                            for diva in up.children {
                                let lsat = diva as! DataSnapshot
                                let vidkey = lsat.key
                                if vidkey == "Official" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    album.officialAlbumVideo = temp[0] as! String
                                }
                            }
                    }
                }
                
                //print(up.key)
                completion(tonealbum)
            }
        })
    }
    
    func fetchTonesPickVideo(completion: @escaping ((AnyObject) -> Void)) {
        var tonevideo:AnyObject!
        Database.database().reference().child("Current Featured Content").child("Tones Picks").child("Video").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                
                    if key.contains("YT") == true {
                        let video = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                        //print(key)
                        
                        var temp:Array<Any> = []
                        let dvalue = data.value as! [String:Any]
                        temp.append(dvalue["Channel Title"] as! String)
                        temp.append(dvalue["Duration"] as! String)
                        temp.append(dvalue["Date Uploaded To App"] as! String)
                        temp.append(dvalue["Date Uploaded To Youtube"] as! String)
                        temp.append(dvalue["Description"] as! String)
                        temp.append(dvalue["Number of Favorites"] as! Int)
                        temp.append(dvalue["Thumbnail URL"] as! String)
                        temp.append(dvalue["Time Uploaded To App"] as! String)
                        temp.append(dvalue["Time Uploaded To Youtube"] as! String)
                        temp.append(dvalue["Title"] as! String)
                        temp.append(dvalue["Video URL"] as! String)
                        temp.append(dvalue["Views In App"] as! Int)
                        temp.append(dvalue["Views on Youtube"] as! Int)
                        temp.append(dvalue["Youtube Id"] as! String)
                        temp.append(dvalue["Tone Deaf App Video Id"] as! String)
                        temp.append(dvalue["Artist"] as! [String])
                        temp.append(dvalue["Producers"] as! [String])
                        temp.append(dvalue["Albums"] as! [String])
                        temp.append(dvalue["Instrumentals"] as! [String])
                        temp.append(dvalue["Songs"] as! [String])
                        temp.append(dvalue["Beats"] as! [String])
                        temp.append(dvalue["Type"] as! String)
                        if let merchandise = (dvalue["Merch"] as? [String]) {
//                            video.merch = (merchandise)
                        }
                        
                        video.channelTitle = temp[0] as! String
                        video.duration = temp[1] as! String
                        video.dateIA = temp[2] as! String
                        video.dateYT = temp[3] as! String
                        video.description = temp[4] as! String
//                        video.favorites = temp[5] as! Int
                        video.thumbnailURL = temp[6] as! String
                        video.timeIA = temp[7] as! String
                        video.timeYT = temp[8] as! String
                        video.title = temp[9] as! String
                        video.url = temp[10] as! String
                        video.viewsIA = temp[11] as! Int
                        video.viewsYT = temp[12] as! Int
                        video.youtubeId = temp[13] as! String
                        video.toneDeafAppId = temp[14] as! String
//                        video.artist = temp[15] as! [String]
//                        video.producers = temp[16] as! [String]
//                        video.albums = temp[17] as! [String]
//                        video.instrumentals = temp[18] as! [String]
//                        video.songs = temp[19] as! [String]
//                        video.beats = temp[20] as! [String]
                        video.type = temp[21] as! String
                        
                        
                        tonevideo = video
                        completion(tonevideo)
                    }
                
            }
        })
    }
    
    func getHighlightVideoURL(completion: @escaping ((URL) -> Void)) {
        Database.database().reference().child("Current Featured Content").child("Highlight Video").observeSingleEvent(of: .value, with: {snapshot in
            print("SAPPPPP", snapshot.value)
            let preurl = snapshot.value as! String
            guard let url = URL(string: preurl) else {fatalError()}
            completion(url)
        })
    }
    
    func getRandomSong(num: Int, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("Music Content").child("Songs").child("All Song IDs").observeSingleEvent(of: .value, with: { snap in
            let arr = snap.value as! [String]
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    func getRandomAlbum(num:Int, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("Music Content").child("Albums").child("All Album IDs").observeSingleEvent(of: .value, with: { snap in
            let arr = snap.value as! [String]
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    func getRandomVideo(num:Int, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("Music Content").child("Videos").child("All Video IDs").observeSingleEvent(of: .value, with: { snap in
            let arr = snap.value as! [String]
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    func getRandomInstrumental(num:Int, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("Music Content").child("Instrumentals").child("All Instrumental IDs").observeSingleEvent(of: .value, with: { snap in
            let arr = snap.value as! [String]
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    func getRandomArtist(num: Int, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("Registered Persons").child("All Person IDs").observeSingleEvent(of: .value, with: { snap in
            let arr = snap.value as! [String]
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    func getRandomProducer(num:Int, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("Registered Producers").child("All Producer IDs").observeSingleEvent(of: .value, with: { snap in
            let arr = snap.value as! [String]
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    func getRandomBeat(num: Int, price: String, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("Beats").child(price).child("\(price) Beat IDs").observeSingleEvent(of: .value, with: { snap in
            let arr = snap.value as! [String]
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    func getRandomMerch(num: Int, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: { snap in
            var arr:[String] = []
            for val in snap.children {
                let data = val as! DataSnapshot
                let key = data.key
                arr.append(key)
            }
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    func getRandomContent(num: Int, completion: @escaping (([String]) -> Void)) {
        Database.database().reference().child("All Content IDs").observeSingleEvent(of: .value, with: { snap in
            let arr = snap.value as! [String]
            var shuff = arr
            shuff.shuffle()
            var randomIDs:[String] = []
            for i in 0..<num {
                guard i < shuff.count else {
                    completion(randomIDs)
                    return
                }
                let word = shuff[i].split(separator: "Ã†")
                let id = word[0]
                randomIDs.append(String(id))
            }
            completion(randomIDs)
        })
    }
    
    
    public typealias SongIdSearchCompletion = (Result<SongData, Error>) -> Void
    func findSongById(songId: String, completion: @escaping SongIdSearchCompletion) {
        var foundSong:SongData!
        var tick = 0
        Database.database().reference().child("Music Content").child("Songs").observeSingleEvent(of: .value, with: { snapshot in
            
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                tick += 1
                if key.contains(songId) == true {
                    
                    var youtubeAlts:[String] = []
                    let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    for kid in data.children {
                        let sub = kid as! DataSnapshot
                        let dkey = sub.key
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = sub.value as! [String:Any]
                            if let tval = (dvalue["Name"] as? String) {
                                song.name = tval
                            }
                            if let tval = (dvalue["Artist"] as? [String]) {
                                song.songArtist = tval.sorted()
                            }
                            if let tval = (dvalue["Producers"] as? [String]) {
                                song.songProducers = tval.sorted()
                            }
                            if let tval = (dvalue["Number of Favorites Overall"] as? Int) {
                                song.favoritesOverall = tval
                            }
                            if let tval = (dvalue["Tone Deaf App Id"] as? String) {
                                song.toneDeafAppId = tval
                            }
                            temp.append(dvalue["Active Status"] as! Bool)
                            if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                if let eng = engies1["Mix Engineer"] as? Array<String> {
                                    song.songMixEngineer = eng.sorted()
                                }
                                if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                    song.songMasteringEngineer = eng.sorted()
                                }
                                if let eng = engies1["Recording Engineer"] as? Array<String> {
                                    song.songRecordingEngineer = eng.sorted()
                                }
                            }
                            if let merchandise = (dvalue["Merch"] as? [String]) {
                                song.merch = (merchandise).sorted()
                            }
                            if let tval = (dvalue["Instrumentals"] as? [String]) {
                                song.instrumentals = tval.sorted()
                            }
                            if let tval = (dvalue["Albums"] as? [String]) {
                                song.albums = tval.sorted()
                            }
                            if let tval = (dvalue["Videos"] as? [String]) {
                                song.videos = tval.sorted()
                            }
                            if let tval = (dvalue["Writers"] as? [String]) {
                                song.songWriters = tval.sorted()
                            }
                            if let tval = (dvalue["Manual Image URL"] as? String) {
                                song.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"] as? String) {
                                song.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                song.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                song.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Explicit"] as? Bool) {
                                song.explicit = tval
                            }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                            song.isActive = temp[0] as! Bool
                        }
                        if dkey.contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist"] as! String)
                            temp.append(dvalue["Album Name"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = temp[15] as! Bool
                            
                            song.apple = apple
                            
                        }
                        if dkey.contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist 1"] as! String)
                            temp.append(dvalue["Artist 1 URL"] as! String)
                            temp.append(dvalue["Artist 2"] as! String)
                            temp.append(dvalue["Artist 2 URL"] as! String)
                            temp.append(dvalue["Artist 3"] as! String)
                            temp.append(dvalue["Artist 3 URL"] as! String)
                            temp.append(dvalue["Artist 4"] as! String)
                            temp.append(dvalue["Artist 4 URL"] as! String)
                            temp.append(dvalue["Artist 5"] as! String)
                            temp.append(dvalue["Artist 5 URL"] as! String)
                            temp.append(dvalue["Artist 6"] as! String)
                            temp.append(dvalue["Artist 6 URL"] as! String)
                            temp.append(dvalue["Album Type"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            song.spotify = spotify
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                            soundcloud.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            song.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            youtubeMusic.url = temp[0] as! String
                            youtubeMusic.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            amazon.url = temp[0] as! String
                            amazon.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String : Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String : Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.isrc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.previewURL = temp[7] as! String
                            deezer.timeIA = temp[8] as! String
                            deezer.deezerID = temp[9] as! Int
                            deezer.dateIA = temp[10] as! String
                            deezer.isActive = temp[11] as! Bool
                            
                            song.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            spinrilla.url = temp[0] as! String
                            spinrilla.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            song.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            napster.url = temp[0] as! String
                            napster.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            tidal.url = temp[0] as! String
                            tidal.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in sub.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        song.officialVideo = temp[0] as! String
                                    }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                                if vidkey == "Lyric" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.lyricVideo = temp[0] as! String
                                }
                            }
                        }
                        
                    }
                    foundSong = song
                    completion(.success(foundSong))
                    
                }
            }
            if tick == snapshot.childrenCount {
                if foundSong == nil {
                    completion(.failure(SongIdErrors.iDNotFound))
                    print("Id not found.")
                    return
                }
            }
        }, withCancel: { err in
            
            print("firebase trim : ",err)
        })
        
    }
    func findSongById(songId: String, pageAmount:Int, completion: @escaping SongIdSearchCompletion) {
        var foundSong:SongData!
        
        Database.database().reference().child("Music Content").child("Songs").queryLimited(toFirst: UInt(pageAmount)).observe(.value, with: { snapshot in
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                
                if key.contains(songId) == true {
                    
                    var youtubeAlts:[String] = []
                    let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    for kid in data.children {
                        let sub = kid as! DataSnapshot
                        let dkey = sub.key
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = sub.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artist"] as! Array<String>)
                            temp.append(dvalue["Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                if let eng = engies1["Mix Engineer"] as? Array<String> {
                                    song.songMixEngineer = eng
                                }
                                if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                    song.songMasteringEngineer = eng
                                }
                                if let eng = engies1["Recording Engineer"] as? Array<String> {
                                    song.songRecordingEngineer = eng
                                }
                            }
                            if let merchandise = (dvalue["Merch"] as? [String]) {
                                song.merch = (merchandise)
                            }
                            if let tval = (dvalue["Instrumentals"] as? [String]) {
                                song.instrumentals = tval
                            }
                            if let tval = (dvalue["Albums"] as? [String]) {
                                song.albums = tval
                            }
                            if let tval = (dvalue["Videos"] as? [String]) {
                                song.videos = tval
                            }
                            if let tval = (dvalue["Writers"] as? [String]) {
                                song.songWriters = tval
                            }
                            if let tval = (dvalue["Manual Image URL"] as? String) {
                                song.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"] as? String) {
                                song.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                song.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                song.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Explicit"] as? Bool) {
                                song.explicit = tval
                        }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                        
                        song.name = temp[0] as! String
                            song.songArtist = temp[1] as! Array<String>
                            song.songProducers = temp[2] as! Array<String>
                            song.favoritesOverall = temp[3] as! Int
                            song.toneDeafAppId = temp[4] as! String
                            song.isActive = temp[5] as! Bool
                        }
                        if dkey.contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist"] as! String)
                            temp.append(dvalue["Album Name"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = temp[15] as! Bool
                            
                            song.apple = apple
                            
                        }
                        if dkey.contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist 1"] as! String)
                            temp.append(dvalue["Artist 1 URL"] as! String)
                            temp.append(dvalue["Artist 2"] as! String)
                            temp.append(dvalue["Artist 2 URL"] as! String)
                            temp.append(dvalue["Artist 3"] as! String)
                            temp.append(dvalue["Artist 3 URL"] as! String)
                            temp.append(dvalue["Artist 4"] as! String)
                            temp.append(dvalue["Artist 4 URL"] as! String)
                            temp.append(dvalue["Artist 5"] as! String)
                            temp.append(dvalue["Artist 5 URL"] as! String)
                            temp.append(dvalue["Artist 6"] as! String)
                            temp.append(dvalue["Artist 6 URL"] as! String)
                            temp.append(dvalue["Album Type"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            song.spotify = spotify
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                            soundcloud.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            song.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            youtubeMusic.url = temp[0] as! String
                            youtubeMusic.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            amazon.url = temp[0] as! String
                            amazon.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String : Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String : Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.isrc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.previewURL = temp[7] as! String
                            deezer.timeIA = temp[8] as! String
                            deezer.deezerID = temp[9] as! Int
                            deezer.dateIA = temp[10] as! String
                            deezer.isActive = temp[11] as! Bool
                            
                            song.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            spinrilla.url = temp[0] as! String
                            spinrilla.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            song.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            napster.url = temp[0] as! String
                            napster.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            tidal.url = temp[0] as! String
                            tidal.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in sub.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        song.officialVideo = temp[0] as! String
                                    }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                                if vidkey == "Lyric" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.lyricVideo = temp[0] as! String
                                }
                            }
                        }
                        
                    }
                    foundSong = song
                    completion(.success(foundSong))
                    
                }
            }
            if foundSong == nil {
                completion(.failure(SongIdErrors.iDNotFound))
                print("Id not found.")
                return
            }
        })
    }
    
    
    public typealias AlbumIdSearchCompletion = (Result<AlbumData, Error>) -> Void
    func findAlbumById(albumId: String, completion: @escaping AlbumIdSearchCompletion) {
        var foundAlbum:AlbumData!
        
        Database.database().reference().child("Music Content").child("Albums").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                
                if key.contains(albumId) == true {
                    
                    var youtubeAlts:[String] = []
                    let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                    for sub in data.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        //print(up.key)
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = up.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Main Artist"] as! Array<String>)
                            temp.append(dvalue["All Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Number Of Tracks"] as! Int)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            if let tval = (dvalue["All Artist"]) as? [String] {
                                album.allArtists = tval
                            }
                            if let tval = (dvalue["All Writers"]) as? [String] {
                                album.writers = tval
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mix Engineer"]) as? [String] {
                                    album.mixEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mastering Engineer"]) as? [String] {
                                    album.masteringEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Recording Engineer"]) as? [String] {
                                    album.recordingEngineers = tval
                                }
                            }
                            if let merchandise = (dvalue["Merch"]) {
                                album.merch = (merchandise as! [String])
                            }
                            if let tval = (dvalue["Songs"]) as? [String] {
                                album.songs = tval
                            }
                            if let tval = (dvalue["Instrumentals"]) as? [String] {
                                album.instrumentals = tval
                            }
                            if let tval = (dvalue["Videos"]) as? [String] {
                                album.videos = tval
                            }
                            if let tval = (dvalue["Tracks"]) as? [String:String] {
                                album.tracks = tval
                            }
                            if let tval = (dvalue["Manual Image URL"]) as? String {
                                album.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"]) as? String {
                                album.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                album.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                album.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Deluxes"] as? [String]) {
                                album.deluxes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                album.otherVersions = tval
                            }
                        if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                            let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isDeluxe = deluxe
                        }
                        if let taval = (dvalue["Other Version"] as? NSDictionary) {
                            let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                            if let tval = (taval["Standard Edition"] as? String) {
                                deluxe.standardEdition = tval
                            }
                            if let tval = (taval["Status"] as? Bool) {
                                deluxe.status = tval
                            }
                            album.isOtherVersion = deluxe
                        }
                            
                            
                            
                            album.name = temp[0] as! String
                            album.mainArtist = temp[1] as! Array<String>
                            album.producers = temp[2] as! Array<String>
                            album.favoritesOverall = temp[3] as! Int
                            album.toneDeafAppId = temp[4] as! String
                            album.numberofTracks = temp[5] as! Int
                            album.timeRegisteredToApp = temp[6] as! String
                            album.dateRegisteredToApp = temp[7] as! String
                            album.isActive = temp[8] as! Bool
                        }
                        if dkey.contains("APPL") == true {
                            let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            appleData.name = temp[0] as! String
                            appleData.artist = temp[1] as! String
                            appleData.dateReleasedApple = temp[2] as! String
                            appleData.timeIA = temp[3] as! String
                            appleData.dateIA = temp[4] as! String
                            appleData.imageURL = temp[5] as! String
                            appleData.url = temp[6] as! String
                            //appleData. = temp[6] as! Int
                            appleData.trackCount = temp[7] as! Int
                            appleData.appleId = temp[8] as! String
                            appleData.isActive = temp[9] as! Bool
                            
                            album.apple = appleData
                        }
                        if dkey.contains("SPTY") == true {
                            let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! [[String:String]])
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Album URI"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            
                            spotifyData.name = temp[0] as! String
                            spotifyData.artist = temp[1] as! [[String:String]]
                            spotifyData.upc = temp[2] as! String
                            spotifyData.dateReleasedSpotify = temp[3] as! String
                            spotifyData.timeIA = temp[4] as! String
                            spotifyData.dateIA = temp[5] as! String
                            spotifyData.imageURL = temp[6] as! String
                            spotifyData.url = temp[7] as! String
                            spotifyData.uri = temp[8] as! String
                            //spotifyData. = temp[10] as! Bool
                            spotifyData.trackNumberTotal = temp[9] as! Int
                            spotifyData.spotifyId = temp[10] as! String
                            
                            album.spotify = spotifyData
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            album.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            youtubeMusic.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            amazon.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String:Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String:Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.upc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.timeIA = temp[7] as! String
                            deezer.deezerID = temp[8] as! Int
                            deezer.dateIA = temp[9] as! String
                            
                            album.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            spinrilla.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            album.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            napster.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            tidal.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in up.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        album.officialAlbumVideo = temp[0] as! String
                                    }
                                }
                        }
                    }
                    
                    foundAlbum = album
                    completion(.success(foundAlbum))
                    
                }
            }
            if foundAlbum == nil {
                
                completion(.failure(SongIdErrors.iDNotFound))
                print("Id not found.")
                return
            }
        })
    }
    
    public typealias VideoIdSearchCompletion = (Result<VideoData, Error>) -> Void
    func findVideoById(videoid: String, completion: @escaping VideoIdSearchCompletion) {
        var foundVideo:VideoData!
        
        Database.database().reference().child("Music Content").child("Videos").observeSingleEvent(of: .value, with: { snapshot in
            let video = VideoData(title: "", toneDeafAppId: "", persons: nil, videographers: nil, albums: nil, instrumentals: nil, merch: nil, songs: nil, beats: nil, favorites: 0, type: "", timeIA: "", dateIA: "", viewsIA: 0, manualThumbnailURL: nil, isActive: false, youtube: nil, igtv: nil, instagramPost: nil, facebookPost: nil, worldstar: nil, twitter: nil, appleMusic: nil, tikTok: nil, industryCerified: nil, verificationLevel: nil)
            var tick = 0
            for child in snapshot.children {
                let bdata = child as! DataSnapshot
                let akey = bdata.key
                tick += 1
                if akey.contains(videoid) == true {
                    for chi in bdata.children {
                        let data = chi as! DataSnapshot
                        let key = data.key
                        if key == "Active Status" {
                            video.isActive = data.value  as! Bool
                        }
                        if key == "Albums" {
                            video.albums = data.value as? [String]
                        }
                        if key == "Instrumentals" {
                            if data.value as! [String] != [""] {
                            video.instrumentals = data.value as? [String]
                            }
                        }
                        if key == "Beats" {
                            if data.value as! [String] != [""] {
                            video.beats = data.value as? [String]
                            }
                        }
                        if key == "Songs" {
                            if data.value as! [String] != [""] {
                            video.songs = data.value as? [String]
                            }
                        }
                        if key == "Persons" {
                            if data.value as! [String] != [""] {
                            video.persons = data.value as? [String]
                            }
                        }
                        if key == "Videographers" {
                            if data.value as! [String] != [""] {
                            video.videographers = data.value as? [String]
                            }
                        }
                        if key == "Date Uploaded To App" {
                            video.dateIA = data.value as! String
                        }
                        if key == "Time Uploaded To App" {
                            video.timeIA = data.value as! String
                        }
                        if key == "Number of Favorites" {
                            video.favorites = data.value as! Int
                        }
                        if key == "Views In App" {
                            video.viewsIA = data.value as! Int
                        }
                        if key == "Title" {
                            video.title = data.value as! String
                        }
                        if key == "Tone Deaf App Video Id" {
                            video.toneDeafAppId = data.value as! String
                        }
                        if key == "Manual Thumbnail URL" {
                            video.manualThumbnailURL = (data.value as! String)
                        }
                        if key == "Industry Certified" {
                            video.industryCerified = (data.value as? Bool)
                        }
                        if key == "Verification Level" {
                            video.verificationLevel = (data.value as? Character)
                        }
                        if key == "Youtube" {
                            for shi in data.children {
                                let odata = shi as! DataSnapshot
                                let okey = odata.key
                                
                                if okey.contains("YT") == true && !okey.contains("YTPL")  {
                                    if video.youtube == nil {
                                        video.youtube = []
                                    }
                                    let avideo = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Channel Title"] as! String)
                                    temp.append(ovalue["Duration"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                    temp.append(ovalue["Description"] as! String)
                                    temp.append(ovalue["Thumbnail URL"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                    temp.append(ovalue["Title"] as! String)
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(avalue["Views In App"] as! Int)
                                    temp.append(ovalue["Views on Youtube"] as! Int)
                                    temp.append(ovalue["Youtube Id"] as! String)
                                    temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                    temp.append(ovalue["Type"] as! String)
                                    
                                    avideo.channelTitle = temp[0] as! String
                                    avideo.duration = temp[1] as! String
                                    avideo.dateIA = temp[2] as! String
                                    avideo.dateYT = temp[3] as! String
                                    avideo.description = temp[4] as! String
                                    //                        video.favorites = temp[5] as! Int
                                    avideo.thumbnailURL = temp[5] as! String
                                    avideo.timeIA = temp[6] as! String
                                    avideo.timeYT = temp[7] as! String
                                    avideo.title = temp[8] as! String
                                    avideo.url = temp[9] as! String
                                    avideo.viewsIA = temp[10] as! Int
                                    avideo.viewsYT = temp[11] as! Int
                                    avideo.youtubeId = temp[12] as! String
                                    avideo.toneDeafAppId = temp[13] as! String
                                    avideo.type = temp[14] as! String
                                    video.youtube!.append(avideo)
                                    
                                    
                                }
                                
                                if okey.contains("YTPL") == true {
                                    if video.youtube == nil {
                                        video.youtube = []
                                    }
                                    let avideo = YouTubeData(duration: nil, url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                                    //print(key)
                                    
                                    var temp:Array<Any> = []
                                    let avalue = bdata.value as! [String:Any]
                                    let ovalue = odata.value as! [String:Any]
                                    temp.append(ovalue["Channel Title"] as! String)
                                    temp.append(ovalue["Date Uploaded To App"] as! String)
                                    temp.append(ovalue["Date Uploaded To Youtube"] as! String)
                                    temp.append(ovalue["Description"] as! String)
                                    temp.append(ovalue["Thumbnail URL"] as! String)
                                    temp.append(ovalue["Time Uploaded To App"] as! String)
                                    temp.append(ovalue["Time Uploaded To Youtube"] as! String)
                                    temp.append(ovalue["Title"] as! String)
                                    temp.append(ovalue["Video URL"] as! String)
                                    temp.append(avalue["Views In App"] as! Int)
                                    temp.append(ovalue["Youtube Id"] as! String)
                                    temp.append(avalue["Tone Deaf App Video Id"] as! String)
                                    temp.append(ovalue["Type"] as! String)
                                    
                                    avideo.channelTitle = temp[0] as! String
                                    avideo.dateIA = temp[1] as! String
                                    avideo.dateYT = temp[2] as! String
                                    avideo.description = temp[3] as! String
                                    avideo.thumbnailURL = temp[4] as! String
                                    avideo.timeIA = temp[5] as! String
                                    avideo.timeYT = temp[6] as! String
                                    avideo.title = temp[7] as! String
                                    avideo.url = temp[8] as! String
                                    avideo.viewsIA = temp[9] as! Int
                                    avideo.youtubeId = temp[10] as! String
                                    avideo.toneDeafAppId = temp[11] as! String
                                    avideo.type = temp[12] as! String
                                    video.youtube!.append(avideo)
                                }
                            }
                        }
                        
                        if key == "Twitter" {
                            for shi in data.children {
                                let odata = shi as! DataSnapshot
                                let okey = odata.key
                                if video.twitter == nil {
                                    video.twitter = []
                                }
                                let avideo = TwitterTweetData(url: "", media: nil, twitterId: "", text: nil, dateTwitter: "", dateIA: "", timeIA: "", viewsIA: 0, isActive: false)
                                //print(key)
                                
                                var temp:Array<Any> = []
                                let avalue = bdata.value as! [String:Any]
                                let ovalue = odata.value as! [String:Any]
                                temp.append(ovalue["Video URL"] as! String)
                                temp.append(ovalue["Twitter Id"] as! String)
                                temp.append(ovalue["Text"] as? String)
                                temp.append(ovalue["Date Uploaded To App"] as! String)
                                temp.append(ovalue["Date Uploaded To Twitter"] as! String)
                                temp.append(ovalue["Time Uploaded To App"] as! String)
                                temp.append(ovalue["Views In App"] as! Int)
                                temp.append(ovalue["Active Status"] as! Bool)
                                
                                if let med = ovalue["Media"] as? [NSDictionary] {
                                    var medArr:[MediaDataForTwitter] = []
                                    for puppy in med {
                                        let tMed = MediaDataForTwitter(url: nil, mediaKey: nil, previewURL: nil, type: nil, contentType: nil)
                                        if let valval = puppy["Preview URL"] as? String {
                                            tMed.previewURL = valval
                                        }
                                        if let valval = puppy["Media Key"] as? String {
                                            tMed.mediaKey = valval
                                        }
                                        if let valval = puppy["Type"] as? String {
                                            tMed.type = valval
                                        }
                                        medArr.append(tMed)
                                    }
                                    avideo.media = medArr
                                }
                                
                                avideo.url = temp[0] as! String
                                avideo.twitterId = temp[1] as! String
                                avideo.text = temp[2] as? String
                                avideo.dateIA = temp[3] as! String
                                avideo.dateTwitter = temp[4] as! String
                                avideo.timeIA = temp[5] as! String
                                avideo.viewsIA = temp[6] as! Int
                                avideo.isActive = temp[7] as! Bool
                                
                                
                                
                                video.twitter!.append(avideo)
                                
                            }
                        }
                        
                        if key == "Tik Tok" {
                            for shi in data.children {
                                let odata = shi as! DataSnapshot
                                let okey = odata.key
                                if video.tikTok == nil {
                                    video.tikTok = []
                                }
                                let avideo = TikTokData(url: "", dateIA: "", timeIa: "", isActive: false)
                                //print(key)
                                
                                var temp:Array<Any> = []
                                let avalue = bdata.value as! [String:Any]
                                let ovalue = odata.value as! [String:Any]
                                temp.append(ovalue["Video URL"] as! String)
                                temp.append(ovalue["Date Uploaded To App"] as! String)
                                temp.append(ovalue["Time Uploaded To App"] as! String)
                                temp.append(ovalue["Active Status"] as! Bool)
                                
                                avideo.url = temp[0] as! String
                                avideo.dateIA = temp[1] as! String
                                avideo.timeIa = temp[2] as! String
                                avideo.isActive = temp[3] as! Bool
                                
                                
                                
                                video.tikTok!.append(avideo)
                                
                            }
                        }
                        
                        if key == "Instagram" {
                            for shi in data.children {
                                let odata = shi as! DataSnapshot
                                let okey = odata.key
                                if video.instagramPost == nil {
                                    video.instagramPost = []
                                }
                                let avideo = InstagramPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                //print(key)
                                
                                var temp:Array<Any> = []
                                let avalue = bdata.value as! [String:Any]
                                let ovalue = odata.value as! [String:Any]
                                temp.append(ovalue["Video URL"] as! String)
                                temp.append(ovalue["Date Uploaded To App"] as! String)
                                temp.append(ovalue["Time Uploaded To App"] as! String)
                                temp.append(ovalue["Active Status"] as! Bool)
                                
                                avideo.url = temp[0] as! String
                                avideo.dateIA = temp[1] as! String
                                avideo.timeIa = temp[2] as! String
                                avideo.isActive = temp[3] as! Bool
                                
                                
                                
                                video.instagramPost!.append(avideo)
                                
                            }
                        }
                        
                        if key == "Facebook" {
                            for shi in data.children {
                                let odata = shi as! DataSnapshot
                                let okey = odata.key
                                if video.facebookPost == nil {
                                    video.facebookPost = []
                                }
                                let avideo = FacebookPostData(url: "", dateIA: "", timeIa: "", isActive: false)
                                //print(key)
                                
                                var temp:Array<Any> = []
                                let avalue = bdata.value as! [String:Any]
                                let ovalue = odata.value as! [String:Any]
                                temp.append(ovalue["Video URL"] as! String)
                                temp.append(ovalue["Date Uploaded To App"] as! String)
                                temp.append(ovalue["Time Uploaded To App"] as! String)
                                temp.append(ovalue["Active Status"] as! Bool)
                                
                                avideo.url = temp[0] as! String
                                avideo.dateIA = temp[1] as! String
                                avideo.timeIa = temp[2] as! String
                                avideo.isActive = temp[3] as! Bool
                                
                                
                                
                                video.facebookPost!.append(avideo)
                                
                            }
                        }
                        
                        if key == "Worldstar" {
                            for shi in data.children {
                                let odata = shi as! DataSnapshot
                                let okey = odata.key
                                if video.worldstar == nil {
                                    video.worldstar = []
                                }
                                let avideo = WorldstarData(url: "", dateIA: "", timeIa: "", isActive: false)
                                //print(key)
                                
                                var temp:Array<Any> = []
                                let avalue = bdata.value as! [String:Any]
                                let ovalue = odata.value as! [String:Any]
                                temp.append(ovalue["Video URL"] as! String)
                                temp.append(ovalue["Date Uploaded To App"] as! String)
                                temp.append(ovalue["Time Uploaded To App"] as! String)
                                temp.append(ovalue["Active Status"] as! Bool)
                                
                                avideo.url = temp[0] as! String
                                avideo.dateIA = temp[1] as! String
                                avideo.timeIa = temp[2] as! String
                                avideo.isActive = temp[3] as! Bool
                                
                                
                                
                                video.worldstar!.append(avideo)
                                
                            }
                        }
                        
                    }
                    
                    
//                        tick += 1
                    foundVideo = video
                    print(video)
                    completion(.success(foundVideo))
                }
                if tick == snapshot.childrenCount {
                    if foundVideo == nil {
                        completion(.failure(VideoIdErrors.iDNotFound))
                        print("Id not found.")
                        return
                    }
                }
            }
        })
    }
    
    public typealias InstrumentalIdSearchCompletion = (Result<InstrumentalData, Error>) -> Void
    func findInstrumentalById(instrumentalId: String, completion: @escaping InstrumentalIdSearchCompletion) {
        var foundInstrumental:InstrumentalData!
        
        Database.database().reference().child("Music Content").child("Instrumentals").observeSingleEvent(of: .value, with: { snapshot in
            
            var tick = 0
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                tick += 1
                print(key)
                if key.contains(instrumentalId) == true {
                    let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    var ltemp:Array<Any> = []
                    let dvalue = data.value as! [String:Any]
                    ltemp.append(dvalue["Name"] as! String)
                    ltemp.append(dvalue["Producers"] as! Array<String>)
                    ltemp.append(dvalue["Audio URL"] as! String)
                    ltemp.append(dvalue["Time Uploaded To App"] as! String)
                    ltemp.append(dvalue["Date Uploaded To App"] as! String)
                    ltemp.append(dvalue["Duration"] as! String)
                    ltemp.append(dvalue["Number of Favorites"] as! Int)
                    ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                    ltemp.append(dvalue["Active Status"] as! Bool)
                    if let tval = (dvalue["Songs"] as? [String]) {
                        instrumental.songs = tval
                    }
                    if let tval = (dvalue["Albums"] as? [String]) {
                        instrumental.albums = tval
                    }
                    if let eval = (dvalue["Engineers"] as? NSDictionary) {
                        if let tval = (eval["Mix Engineer"] as? [String]) {
                            instrumental.mixEngineer = tval
                        }
                        if let tval = (eval["Mastering Engineer"] as? [String]) {
                            instrumental.masteringEngineer = tval
                        }
                    }
                    if let tval = (dvalue["Videos"] as? [String]) {
                        instrumental.videos = tval
                    }
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        instrumental.merch = (merchandise)
                    }
                    if let tval = (dvalue["Artists"] as? [String]) {
                        instrumental.artist = tval
                    }
                    if let tval = (dvalue["Manual Image URL"] as? String) {
                        instrumental.manualImageURL = tval
                    }
                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                        instrumental.manualPreviewURL = tval
                    }
                    if let tval = (dvalue["Official Video"] as? String) {
                        instrumental.officialVideo = tval
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        instrumental.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        instrumental.verificationLevel = Character(tval)
                    }
                    for chi in data.children {
                        let da = chi as! DataSnapshot
                        let lilkey = da.key
                        if lilkey == "Store Info" {
                            let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                            let botval = da.value as! [String:Any]
                            
                            inststore.retailPrice = botval["Retail Price"] as! Double
                            inststore.merchType = botval["Merch Type"] as! String
                            inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                            let predate = botval["Date Uploaded"] as! String
                            guard predate != "" else {return}
                            let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                            inststore.dateUploaded = date
                            if let ite = botval["Sale Price"] as? Double {
                                inststore.salePrice = ite
                            }
                            if let ite = botval["Quantity"] as? Int {
                                inststore.quantity = ite
                            }
                            instrumental.storeInfo = inststore
                        }
                    }
                    instrumental.instrumentalName = ltemp[0] as! String
                    instrumental.producers = ltemp[1] as! Array<String>
                    instrumental.audioURL = ltemp[2] as! String
                    instrumental.timeRegisteredToApp = ltemp[3] as! String
                    instrumental.dateRegisteredToApp = ltemp[4] as! String
                    instrumental.duration = ltemp[5] as! String
                    instrumental.favoritesOverall = ltemp[6] as! Int
                    instrumental.toneDeafAppId = ltemp[7] as! String
                    instrumental.isActive = ltemp[8] as! Bool
                    let songname = ltemp[0] as! String
                    instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                    for val in data.children {
                        var temp:Array<Any> = []
                        let cont = val as! DataSnapshot
                        let chi = cont.key
                        if (chi).contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Spotify"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist 1"] as! String)
                            temp.append(svalue["Artist 1 URL"] as! String)
                            temp.append(svalue["Artist 2"] as! String)
                            temp.append(svalue["Artist 2 URL"] as! String)
                            temp.append(svalue["Artist 3"] as! String)
                            temp.append(svalue["Artist 3 URL"] as! String)
                            temp.append(svalue["Artist 4"] as! String)
                            temp.append(svalue["Artist 4 URL"] as! String)
                            temp.append(svalue["Artist 5"] as! String)
                            temp.append(svalue["Artist 5 URL"] as! String)
                            temp.append(svalue["Artist 6"] as! String)
                            temp.append(svalue["Artist 6 URL"] as! String)
                            temp.append(svalue["Album Type"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            instrumental.spotify = spotify
                        }
                        if (chi).contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Apple"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist"] as! String)
                            temp.append(svalue["Album Name"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Apple Music Id"] as! String)
                            ltemp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = ltemp[15] as! Bool
                            
                            instrumental.apple = apple
                        }
                        if chi.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                                soundcloud.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                instrumental.soundcloud = soundcloud
                            }
                            if chi.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                youtubeMusic.url = temp[0] as! String
                                youtubeMusic.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.youtubeMusic = youtubeMusic
                            }
                            if chi.contains(amazonMusicContentType) == true {
                                let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                amazon.url = temp[0] as! String
                                amazon.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.amazon = amazon
                            }
                            if chi.contains(deezerMusicContentType) == true {
                                let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String : Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["ISRC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Song URL"] as! String)
                                temp.append(dvalue["Preview URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String : Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.isrc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.previewURL = temp[7] as! String
                                deezer.timeIA = temp[8] as! String
                                deezer.deezerID = temp[9] as! Int
                                deezer.dateIA = temp[10] as! String
                                deezer.isActive = temp[11] as! Bool
                                
                                instrumental.deezer = deezer
                            }
                            if chi.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                spinrilla.url = temp[0] as! String
                                spinrilla.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                instrumental.spinrilla = spinrilla
                            }
                            if chi.contains(napsterMusicContentType) == true {
                                let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                napster.url = temp[0] as! String
                                napster.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.napster = napster
                            }
                            if chi.contains(tidalMusicContentType) == true {
                                let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                tidal.url = temp[0] as! String
                                tidal.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.tidal = tidal
                            }
                        }
                    
                    foundInstrumental = instrumental
                    completion(.success(foundInstrumental))
                    
                }
                if tick == snapshot.childrenCount {
                    if foundInstrumental == nil {
                        completion(.failure(VideoIdErrors.iDNotFound))
                        print("Id not found.")
                        return
                    }
                }
            }
            if foundInstrumental == nil {
                completion(.failure(SongIdErrors.iDNotFound))
                print("Id not found.")
                return
            }
        })
    }
    
    public typealias BeatIdSearchCompletion = (Result<BeatData, Error>) -> Void
    func findBeatById(beatId: String, completion: @escaping BeatIdSearchCompletion) {
        var foundBeat:BeatData!
        let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
        
        Database.database().reference().child("Beats").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                    let bea = child as! DataSnapshot
                    let key = bea.key
                    if key.contains(beatId) == true {
                        var temp:Array<Any> = []
                        let value = bea.value as! [String:Any]
                        var typeArray:[String] = []
                        var soundArray:[String] = []
                        var time:String!
                        var date:String!
                        if let tval = value["Duration"] as? String {
                            beat.duration = tval
                        }
                        if let tval = value["Name"] as? String {
                            beat.name = tval
                        }
                        if let tval = value["Date"] as? String {
                            beat.date = tval
                            date = tval
                        }
                        if let tval = value["Number of Downloads"] as? Int {
                            beat.downloads = tval
                        }
                        if let tval = value["Wav Price"] as? Double {
                            beat.wavPrice = tval
                        }
                        if let tval = value["Lease Price"] as? Double {
                            beat.mp3Price = tval
                        }
                        if let tval = value["Exclusive Price"] as? Double {
                            beat.exclusivePrice = tval
                        }
                        if let tval = value["Time"] as? String {
                            beat.time = tval
                            time = tval
                        }
                        if let tval = value["Types"] as? [String] {
                            beat.types = tval
                        }
                        if let tval = value["Sounds"] as? [String] {
                            beat.sounds = tval
                        }
                        if let tval = value["Tempo"] as? Int {
                            beat.tempo = tval
                        }
                        if let tval = value["Audio"] as? String {
                            beat.audioURL = tval
                        }
                        if let tval = value["Image"] as? String {
                            beat.imageURL = tval
                        }
                        if let tval = value["beatId"] as? String {
                            beat.beatID = tval
                        }
                        if let tval = value["Price Type"] as? String {
                            beat.priceType = tval
                        }
                        if let tval = value["Producers"] as? [String] {
                            beat.producers = tval
                        }
                        if let tval = value["Tone Deaf App Id"] as? String {
                            beat.toneDeafAppId = tval
                        }
                        if let tval = value["Exclusive Files URL"] as? String {
                            beat.exclusiveFilesURL = tval
                        }
                        if let tval = value["Wav URL"] as? String {
                            beat.wavURL = tval
                        }
                        if let tval = value["Official Video"] as? String {
                            beat.officialVideo = tval
                        }
                        if let tval = value["Videos"] as? [String] {
                            beat.videos = tval
                        }
                        if let tval = value["Key"] as? String {
                            beat.key = tval
                        }
                        if let tval = value["Active Status"] as? Bool {
                            beat.isActive = tval
                        }
                        if let merchandise = (value["Merch"] as? [String]) {
                            beat.merch = (merchandise)
                        }
                        beat.datetime = "\(date)\(time)"
                        let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        for kiddo in bea.children {
                            let dada = kiddo as! DataSnapshot
                            if dada.key.contains(soundcloudMusicContentType) == true {
                                var temp:Array<Any> = []
                                let dvalue = dada.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                soundcloud.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                beat.soundcloud = soundcloud
                            }
                        }                        //print("ðŸ“™ beat \(beat)")
                        foundBeat = beat
                        completion(.success(foundBeat))
                    }
            }
            if foundBeat == nil {
                completion(.failure(SongIdErrors.iDNotFound))
                print("Id not found.")
                return
            }
        })
    }
    
    func fetchArtistData(artist: String,completion: @escaping ((ArtistData) -> Void)) {
        //print(artist)
        //var contentFeaturedArray:[ArtistData] = []
        Database.database().reference().child("Registered Artists").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            
            let artis = ArtistData(name: "", legalName: nil, toneDeafAppId: "", songs: [""], videos: [""], albums: [""], merch: nil, alternateNames: [""], dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotifyProfileURL: "", appleProfileURL: "", soundcloudProfileURL: nil, youtubeMusicProfileURL: nil, amazonProfileURL: nil, deezerProfileURL: nil, spinrillaProfileURL: nil, napsterProfileURL: nil, tidalProfileURL: nil, youtubeChannelURL: nil, instagramProfileURL: nil, twitterProfileURL: nil, facebookProfileURL: nil, spotifyProfileImageURL: "", soundcloudProfileImageURL: nil, youtubeMusicProfileImageURL: nil, amazonProfileImageURL: nil, deezerProfileImageURL: nil, spinrillaProfileImageURL: nil, napsterProfileImageURL: nil, tidalProfileImageURL: nil, youtubeChannelImageURL: nil, instagramProfileImageURL: nil, twitterProfileImageURL: nil, facebookProfileImageURL: nil, appleAllArtistAlbumIds: [""],followers: 0)
            for child in snapshot.children {
                let up = child as! DataSnapshot
                let key = up.key
                if key.contains(artist) {
                    
                    var temp:Array<Any> = []
                    let dvalue = up.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Alternate Names"] as! Array<String>)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Linked To Account"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Songs"] as! Array<String>)
                    temp.append(dvalue["Albums"] as! Array<String>)
                    temp.append(dvalue["Videos"] as! Array<String>)
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        artis.merch = (merchandise)
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        artis.legalName = (lname as! String)
                    }
                    if let profileurl = (dvalue["Apple Profile URL"]) {
                        artis.appleProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Spotify Profile URL"]) {
                        artis.spotifyProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spotify Profile Image URL"]) {
                        artis.spotifyProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Soundcloud Profile URL"]) {
                        artis.soundcloudProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Soundcloud Profile Image URL"]) {
                        artis.soundcloudProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Music Profile URL"]) {
                        artis.youtubeMusicProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Youtube Music Profile Image URL"]) {
                        artis.youtubeMusicProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Amazon Profile URL"]) {
                        artis.amazonProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Amazon Profile Image URL"]) {
                        artis.amazonProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Deezer Profile URL"]) {
                        artis.deezerProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Deezer Profile Image URL"]) {
                        artis.deezerProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Spinrilla Profile URL"]) {
                        artis.spinrillaProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spinrilla Profile Image URL"]) {
                        artis.spinrillaProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Napster Profile URL"]) {
                        artis.napsterProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Napster Profile Image URL"]) {
                        artis.napsterProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Tidal Profile URL"]) {
                        artis.tidalProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Tidal Profile Image URL"]) {
                        artis.tidalProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Channel URL"]) {
                        artis.youtubeChannelURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Instagram Profile URL"]) {
                        artis.instagramProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Instagram Profile Image URL"]) {
                        artis.instagramProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Twitter Profile URL"]) {
                        artis.twitterProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Twitter Profile Image URL"]) {
                        artis.twitterProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Facebook Profile URL"]) {
                        artis.facebookProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Facebook Profile Image URL"]) {
                        artis.facebookProfileImageURL = (imageurl as! String)
                    }
                    
                    artis.name = temp[0] as! String
                    artis.alternateNames = temp[1] as! Array<String>
                    artis.dateRegisteredToApp = temp[2] as! String
                    artis.timeRegisteredToApp = temp[3] as! String
                    artis.linkedToAccount = temp[4] as! String
                    artis.followers = temp[5] as! Int
                    artis.toneDeafAppId = temp[6] as! String
                    artis.songs = temp[7] as! Array<String>
                    artis.albums = temp[8] as! Array<String>
                    artis.videos = temp[9] as! Array<String>
                    
                    completion(artis)
                }
            }
            
        })
    }
    
    public typealias PersonIdSearchCompletion = (Result<PersonData, Error>) -> Void
    func fetchPersonData(person: String, completion: @escaping PersonIdSearchCompletion) {
        //print(artist)
        //var contentFeaturedArray:[ArtistData] = []
        Database.database().reference().child("Registered Persons").observeSingleEvent(of: .value, with: { snapshot in
        //print("ðŸ““\(snapshot)")
            let perso = PersonData(name: "", legalName: nil, toneDeafAppId: "", mainRole: "", roles: nil, songs: nil, videos: nil, beats: nil, instrumentals: nil, albums: nil, merch: nil, alternateNames: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, youtube: nil, instagram: nil, twitter: nil, facebook: nil, tikTok: nil, manualImageURL: nil,followers: 0, industryCerified: false, verificationLevel: nil, isActive: nil)
            for child in snapshot.children {
                let up = child as! DataSnapshot
                let key = up.key
                
                if key.contains(person) {
                    var temp:Array<Any> = []
                    let dvalue = up.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Main Role"] as! String)
                    if let tval = dvalue["Alternate Names"] as? [String] {
                        perso.alternateNames = tval
                    }
                    if let tval = dvalue["Linked To Account"] as? String {
                        perso.linkedToAccount = tval
                    }
                    if let tval = dvalue["Songs"] as? [String] {
                        perso.songs = tval
                    }
                    if let tval = dvalue["Albums"] as? [String] {
                        perso.albums = tval
                    }
                    if let tval = dvalue["Beats"] as? [String] {
                        perso.beats = tval
                    }
                    if let tval = dvalue["Videos"] as? [String] {
                        perso.videos = tval
                    }
                    if let tval = dvalue["Instrumentals"] as? [String] {
                        perso.instrumentals = tval
                    }
                    if let merchandise = (dvalue["Merch"]) {
                        perso.merch = (merchandise as! [String])
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        perso.legalName = (lname as! String)
                    }
                    if let rolesarr = (dvalue["Roles"]) {
                        perso.roles = (rolesarr as! NSMutableDictionary)
                    }
                    if let tval = dvalue["Manual Image URL"] as? String {
                        perso.manualImageURL = tval
                    }
                    if let data = dvalue["Apple Music"] as? NSDictionary {
                        let togo = AppleMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, allAlbumIDs: nil)
                        if let aaid = data["All Album IDs"] as? [String] {
                            togo.allAlbumIDs = aaid
                        }
                        perso.apple = togo
                    }
                    if let data = dvalue["Spotify"] as? NSDictionary {
                        let togo = SpotifyPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.spotify = togo
                    }
                    if let data = dvalue["Soundcloud"] as? NSDictionary {
                        let togo = SoundcloudPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.soundcloud = togo
                    }
                    if let data = dvalue["Youtube Music"] as? NSDictionary {
                        let togo = YoutubeMusicPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtubeMusic = togo
                    }
                    if let data = dvalue["Amazon Music"] as? NSDictionary {
                        let togo = AmazonPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.amazon = togo
                    }
                    if let data = dvalue["Deezer"] as? NSDictionary {
                        let togo = DeezerPersonData(url: data["URL"] as! String, profileImageURL: data["Profile Image URL"] as! String, id: data["id"] as! String, name: data["Name"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.deezer = togo
                    }
                    if let data = dvalue["Spinrilla"] as? NSDictionary {
                        let togo = SpinrillaPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.spinrilla = togo
                    }
                    if let data = dvalue["Napster"] as? NSDictionary {
                        let togo = NapsterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.napster = togo
                    }
                    if let data = dvalue["Tidal"] as? NSDictionary {
                        let togo = TidalPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tidal = togo
                    }
                    if let data = dvalue["Youtube"] as? NSDictionary {
                        let togo = YoutubePersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.youtube = togo
                    }
                    if let data = dvalue["Instagram"] as? NSDictionary {
                        let togo = InstagramPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.instagram = togo
                    }
                    if let data = dvalue["Twitter"] as? NSDictionary {
                        let togo = TwitterPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool, dateCreated: data["Date Created"] as! String, name: data["Name"] as! String, userName: data["Username"] as! String, id: data["id"] as! String, profileImageURL: data["Profile Image URL"] as! String)
                        perso.twitter = togo
                    }
                    if let data = dvalue["Facebook"] as? NSDictionary {
                        let togo = FacebookPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.facebook = togo
                    }
                    if let data = dvalue["TikTok"] as? NSDictionary {
                        let togo = TikTokPersonData(url: data["URL"] as! String, isActive: data["Active Status"] as! Bool)
                        perso.tikTok = togo
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        perso.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        perso.verificationLevel = Character(tval)
                    }
                    
                    perso.name = temp[0] as! String
                    perso.dateRegisteredToApp = temp[1] as! String
                    perso.timeRegisteredToApp = temp[2] as! String
                    perso.followers = temp[3] as! Int
                    perso.toneDeafAppId = (temp[4] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                    perso.mainRole = temp[5] as! String
                    
                }
            }
            completion(.success(perso))
            
        })
    }
    
    public typealias MerchIdSearchCompletion = (Result<MerchData, Error>) -> Void
    func findMerchById(merchId: String, completion: @escaping MerchIdSearchCompletion) {
        var foundMerch:MerchData!
        
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: { snapshot in
            for data in snapshot.children {
                let child = data as! DataSnapshot
                let key = child.key
                
                if key.contains(merchId) == true {
                    let merch = MerchData(kit: nil, apperal: nil, instrumentalSale: nil, service: nil, memorabilia: nil)
                    switch merchId.count {
                    case 24:
                        let memo = MerchMemorabiliaData(date: Date(), colors: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                        let dvalue = child.value as! [String:Any]
                        let images = dvalue["Images"] as! [String]
                        let merchType = dvalue["Merch Type"] as! String
                        let subcat = dvalue["Sub Category"] as! String
                        let tdID = dvalue["Tone Deaf App Id"] as! String
                        let name = dvalue["Name"] as! String
                        let nof = dvalue["Number of Favorites"] as! Int
                        let nop = dvalue["Number of Purchases"] as! Int
                        let predate = dvalue["Date Uploaded"] as! String
                        if let array = dvalue["Artists"] as? [String] {
                            memo.artists = array
                        }
                        if let array = dvalue["Producers"] as? [String] {
                            memo.producers = array
                        }
                        if let array = dvalue["Songs"] as? [String] {
                            memo.songs = array
                        }
                        if let array = dvalue["Albums"] as? [String] {
                            memo.albums = array
                        }
                        if let array = dvalue["Videos"] as? [String] {
                            memo.videos = array
                        }
                        if let array = dvalue["Beats"] as? [String] {
                            memo.beats = array
                        }
                        if let array = dvalue["Instrumentals"] as? [String] {
                            memo.instrumentals = array
                        }
                        for sub in child.children {
                            let up = sub as! DataSnapshot
                            let dkey = up.key
                            if dkey == "Colors" {
                                var colorArr:[MemorabiliaColorData] = []
                                for siz in up.children {
                                    let sze = siz as! DataSnapshot
                                    let size = sze.key
                                    let colordata = MemorabiliaColorData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0)
                                    let cval = sze.value as! [String:Any]
                                    let coll = cval["Color"] as! String
                                    let dateRes = cval["Date Restocked"] as! String
                                    let descript = cval["Description"] as! String
                                    let nopur = cval["Number of Purchases"] as! Int
                                    let quan = cval["Quantity"] as! Int
                                    let repe = cval["Retail Price"] as! Double
                                    if let sale = cval["Sale Price"] as? Double {
                                        colordata.salePrice = sale
                                    }
                                    
                                    colordata.color = coll
                                    let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                    colordata.dateLastRestocked = dateee
                                    colordata.description = descript
                                    colordata.numberOfPurchases = nopur
                                    colordata.quantity = quan
                                    colordata.retailPrice = repe
                                    
                                    
                                    colorArr.append(colordata)
                                    memo.colors = colorArr
                                    
                                }
                            }
                        }
                        memo.merchType = merchType
                        memo.imageURLs = images
                        memo.subcategory = subcat
                        memo.tDAppId = tdID
                        memo.name = name
                        memo.numberOfFavorites = nof
                        memo.numberOfPurchases = nop
                        
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        memo.date = date
                        
                        merch.memorabilia = memo
                    case 23:
                        let apperal = MerchApperalData(date: Date(), osfaSize: nil, xxsmallSize: nil,xsmallSize: nil,smallSize: nil,mediumSize: nil,largeSize: nil,xlargeSize: nil,xxlargeSize: nil,xxxlargeSize: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                        let dvalue = child.value as! [String:Any]
                        let images = dvalue["Images"] as! [String]
                        let merchType = dvalue["Merch Type"] as! String
                        let subcat = dvalue["Sub Category"] as! String
                        let tdID = dvalue["Tone Deaf App Id"] as! String
                        let name = dvalue["Name"] as! String
                        let nof = dvalue["Number of Favorites"] as! Int
                        let nop = dvalue["Number of Purchases"] as! Int
                        let predate = dvalue["Date Uploaded"] as! String
                        if let array = dvalue["Artists"] as? [String] {
                            apperal.artists = array
                        }
                        if let array = dvalue["Producers"] as? [String] {
                            apperal.producers = array
                        }
                        if let array = dvalue["Songs"] as? [String] {
                            apperal.songs = array
                        }
                        if let array = dvalue["Albums"] as? [String] {
                            apperal.albums = array
                        }
                        if let array = dvalue["Videos"] as? [String] {
                            apperal.videos = array
                        }
                        if let array = dvalue["Beats"] as? [String] {
                            apperal.beats = array
                        }
                        if let array = dvalue["Instrumentals"] as? [String] {
                            apperal.instrumentals = array
                        }
                        for sub in child.children {
                            let up = sub as! DataSnapshot
                            let dkey = up.key
                            if dkey == "Sizes" {
                                var osfaarr:[ApperalSizeData] = []
                                var xxsmallarr:[ApperalSizeData] = []
                                var xsmallarr:[ApperalSizeData] = []
                                var smallarr:[ApperalSizeData] = []
                                var mediumarr:[ApperalSizeData] = []
                                var largearr:[ApperalSizeData] = []
                                var xlargearr:[ApperalSizeData] = []
                                var xxlargearr:[ApperalSizeData] = []
                                var xxxlargearr:[ApperalSizeData] = []
                                for siz in up.children {
                                    let sze = siz as! DataSnapshot
                                    let size = sze.key
                                    for col in sze.children {
                                        let sizedata = ApperalSizeData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0, size: "")
                                        
                                        let cole = col as! DataSnapshot
                                        let color = cole.key
                                        let cval = cole.value as! [String:Any]
                                        let coll = cval["Color"] as! String
                                        let dateRes = cval["Date Restocked"] as! String
                                        let descript = cval["Description"] as! String
                                        let nopur = cval["Number of Purchases"] as! Int
                                        let quan = cval["Quantity"] as! Int
                                        let repe = cval["Retail Price"] as! Double
                                        let dasize = cval["Size"] as! String
                                        
                                        sizedata.color = coll
                                        let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                        sizedata.dateLastRestocked = dateee
                                        sizedata.description = descript
                                        sizedata.numberOfPurchases = nopur
                                        sizedata.quantity = quan
                                        sizedata.retailPrice = repe
                                        sizedata.size = dasize
                                        
                                        if let sale = cval["Sale Price"] as? Double {
                                            sizedata.salePrice = sale
                                        }
                                        
                                        switch sizedata.size {
                                        case "OSFA":
                                            osfaarr.append(sizedata)
                                            apperal.osfaSize = osfaarr
                                        case "XXS":
                                            xxsmallarr.append(sizedata)
                                            apperal.xxsmallSize = xxsmallarr
                                        case "XS":
                                            xsmallarr.append(sizedata)
                                            apperal.xsmallSize = xsmallarr
                                        case "S":
                                            smallarr.append(sizedata)
                                            apperal.smallSize = smallarr
                                        case "M":
                                            mediumarr.append(sizedata)
                                            apperal.mediumSize = mediumarr
                                        case "L":
                                            largearr.append(sizedata)
                                            apperal.largeSize = largearr
                                        case "XL":
                                            xlargearr.append(sizedata)
                                            apperal.xlargeSize = xlargearr
                                        case "XXL":
                                            xxlargearr.append(sizedata)
                                            apperal.xxlargeSize = xxlargearr
                                        case "XXXL":
                                            xxxlargearr.append(sizedata)
                                            apperal.xxxlargeSize = xxxlargearr
                                        default:
                                            print("you trippin tone")
                                        }
                                        
                                    }
                                }
                            }
                        }
                        apperal.merchType = merchType
                        apperal.imageURLs = images
                        apperal.subcategory = subcat
                        apperal.tDAppId = tdID
                        apperal.name = name
                        apperal.numberOfFavorites = nof
                        apperal.numberOfPurchases = nop
                        
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        apperal.date = date
                        
                        merch.apperal = apperal
                    case 22:
                        let kit = MerchKitData(date: Date(), description: "", fileURL: "", imageURLs: [], merchType: "", name: "", quantity: 0, numberOfPurchases: 0, numberOfFavorites: 0, previewURL: "", retailPrice: 0.0, salePrice: 0.0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                        let dvalue = child.value as! [String:Any]
                        let images = dvalue["Images"] as! [String]
                        let merchType = dvalue["Merch Type"] as! String
                        let subcat = dvalue["Sub Category"] as! String
                        let tdID = dvalue["Tone Deaf App Id"] as! String
                        let name = dvalue["Name"] as! String
                        let fileurl = dvalue["File URL"] as! String
                        let prevurl = dvalue["Preview URL"] as! String
                        let description = dvalue["Description"] as! String
                        let nof = dvalue["Number of Favorites"] as! Int
                        let nop = dvalue["Number of Purchases"] as! Int
                        let predate = dvalue["Date Uploaded"] as! String
                        if let array = dvalue["Artists"] as? [String] {
                            kit.artists = array
                        }
                        if let array = dvalue["Producers"] as? [String] {
                            kit.producers = array
                        }
                        if let array = dvalue["Songs"] as? [String] {
                            kit.songs = array
                        }
                        if let array = dvalue["Albums"] as? [String] {
                            kit.albums = array
                        }
                        if let array = dvalue["Videos"] as? [String] {
                            kit.videos = array
                        }
                        if let array = dvalue["Beats"] as? [String] {
                            kit.beats = array
                        }
                        if let array = dvalue["Instrumentals"] as? [String] {
                            kit.instrumentals = array
                        }
                        if let num = dvalue["Retail Price"] as? Double {
                            kit.retailPrice = num
                        }
                        if let num = dvalue["Sale Price"] as? Double {
                            kit.salePrice = num
                        }
                        if let num = dvalue["Quantity"] as? Int {
                            kit.quantity = num
                        }
                        kit.merchType = merchType
                        kit.imageURLs = images
                        kit.subcategory = subcat
                        kit.tDAppId = tdID
                        kit.name = name
                        kit.numberOfFavorites = nof
                        kit.numberOfPurchases = nop
                        kit.description = description
                        kit.fileURL = fileurl
                        kit.previewURL = prevurl
                        
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        kit.date = date
                        merch.kit = kit
                    case 21:
                        print("Bundle")
                    case 20:
                        let service = MerchServiceData(name: "", serviceType: "", tDAppId: "", retailPrice: nil, salePrice: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date(), description: "", producers: nil)
                        let dvalue = child.value as! [String:Any]
                        let merchType = dvalue["Merch Type"] as! String
                        let servtype = dvalue["Service Type"] as! String
                        let tdID = dvalue["Tone Deaf App Id"] as! String
                        let name = dvalue["Name"] as! String
                        let description = dvalue["Description"] as! String
                        let nof = dvalue["Number of Favorites"] as! Int
                        let nop = dvalue["Number of Purchases"] as! Int
                        let predate = dvalue["Date Uploaded"] as! String
                        if let array = dvalue["Producers"] as? [String] {
                            service.producers = array
                        }
                        if let num = dvalue["Retail Price"] as? Double {
                            service.retailPrice = num
                        }
                        if let num = dvalue["Sale Price"] as? Double {
                            service.salePrice = num
                        }
                        service.merchType = merchType
                        service.serviceType = servtype
                        service.tDAppId = tdID
                        service.name = name
                        service.numberOfFavorites = nof
                        service.numberOfPurchases = nop
                        service.description = description
                        
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        service.dateUploaded = date
                        merch.service = service
                    case 12:
                        let botval = child.value as! [String:Any]
                        let instr = MerchInstrumentalData(instrumentaldbid: key, retailPrice: 0.0, salePrice: nil, quantity: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date())
                        instr.retailPrice = botval["Retail Price"] as! Double
                        instr.merchType = botval["Merch Type"] as! String
                        instr.numberOfPurchases = botval["Number of Purchases"] as! Int
                        let predate = botval["Date Uploaded"] as! String
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        instr.dateUploaded = date
                        if let ite = botval["Sale Price"] as? Double {
                            instr.salePrice = ite
                        }
                        if let ite = botval["Quantity"] as? Int {
                            instr.quantity = ite
                        }
                        merch.instrumentalSale = instr
                    default:
                        print("All Merch Fecth Error")
                    }
                    foundMerch = merch
                    completion(.success(foundMerch))
                    
                }
            }
            if foundMerch == nil {
                completion(.failure(SongIdErrors.iDNotFound))
                print("Id \(merchId) not found.")
                return
            }
        })
    }
    
    func searchSongs(text: String, limit: Int, completion: @escaping (([SongData]) -> Void)) {
        //print(text)
        var foundSongs:[SongData] = []
        Database.database().reference().child("Music Content").child("Songs").observeSingleEvent(of: .value, with: { snap in
            for child in snap.children {
                let kic = child as! DataSnapshot
                let key = kic.key
                if key == "All Song IDs" {} else {
                    if foundSongs.count == limit {
                        break
                    }
                    var rtemp:Array<Any> = []
                    var youtubeAlts:[String] = []
                    let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)

                    for kid in kic.children {
                        let sub = kid as! DataSnapshot
                        let dkey = sub.key
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = sub.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artist"] as! Array<String>)
                            temp.append(dvalue["Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            if let engies1 = dvalue["Engineers"] as? NSDictionary {
                                if let eng = engies1["Mix Engineer"] as? Array<String> {
                                    song.songMixEngineer = eng
                                }
                                if let eng = engies1["Mastering Engineer"] as? Array<String> {
                                    song.songMasteringEngineer = eng
                                }
                                if let eng = engies1["Recording Engineer"] as? Array<String> {
                                    song.songRecordingEngineer = eng
                                }
                            }
                            if let merchandise = (dvalue["Merch"] as? [String]) {
                                song.merch = (merchandise)
                            }
                            if let tval = (dvalue["Instrumentals"] as? [String]) {
                                song.instrumentals = tval
                            }
                            if let tval = (dvalue["Albums"] as? [String]) {
                                song.albums = tval
                            }
                            if let tval = (dvalue["Videos"] as? [String]) {
                                song.videos = tval
                            }
                            if let tval = (dvalue["Writers"] as? [String]) {
                                song.songWriters = tval
                            }
                            if let tval = (dvalue["Manual Image URL"] as? String) {
                                song.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"] as? String) {
                                song.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"] as? String) {
                                song.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                song.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                song.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Explicit"] as? Bool) {
                                song.explicit = tval
                        }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                        
                        song.name = temp[0] as! String
                            song.songArtist = temp[1] as! Array<String>
                            song.songProducers = temp[2] as! Array<String>
                            song.favoritesOverall = temp[3] as! Int
                            song.toneDeafAppId = temp[4] as! String
                            song.isActive = temp[5] as! Bool
                        }
                        if dkey.contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist"] as! String)
                            temp.append(dvalue["Album Name"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = temp[15] as! Bool
                            
                            song.apple = apple
                            
                        }
                        if dkey.contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Explicity"] as! Bool)
                            temp.append(dvalue["Artist 1"] as! String)
                            temp.append(dvalue["Artist 1 URL"] as! String)
                            temp.append(dvalue["Artist 2"] as! String)
                            temp.append(dvalue["Artist 2 URL"] as! String)
                            temp.append(dvalue["Artist 3"] as! String)
                            temp.append(dvalue["Artist 3 URL"] as! String)
                            temp.append(dvalue["Artist 4"] as! String)
                            temp.append(dvalue["Artist 4 URL"] as! String)
                            temp.append(dvalue["Artist 5"] as! String)
                            temp.append(dvalue["Artist 5 URL"] as! String)
                            temp.append(dvalue["Artist 6"] as! String)
                            temp.append(dvalue["Artist 6 URL"] as! String)
                            temp.append(dvalue["Album Type"] as! String)
                            temp.append(dvalue["Track Number"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = temp[26] as! Bool
                            
                            song.spotify = spotify
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                            soundcloud.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            song.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            youtubeMusic.url = temp[0] as! String
                            youtubeMusic.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            amazon.url = temp[0] as! String
                            amazon.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String : Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["ISRC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Song URL"] as! String)
                            temp.append(dvalue["Preview URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String : Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.isrc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.previewURL = temp[7] as! String
                            deezer.timeIA = temp[8] as! String
                            deezer.deezerID = temp[9] as! Int
                            deezer.dateIA = temp[10] as! String
                            deezer.isActive = temp[11] as! Bool
                            
                            song.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            spinrilla.url = temp[0] as! String
                            spinrilla.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            song.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            napster.url = temp[0] as! String
                            napster.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = sub.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            tidal.url = temp[0] as! String
                            tidal.isActive = temp[1] as! Bool
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            song.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in sub.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        song.officialVideo = temp[0] as! String
                                    }
                                if vidkey == "Audio" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.audioVideo = temp[0] as! String
                                }
                                if vidkey == "Lyric" {
                                    var temp:Array<Any> = []
                                    let vvalue = lsat.value! as! [String:Any]
                                    temp.append(vvalue["id"] as! String)
                                    song.lyricVideo = temp[0] as! String
                                }
                            }
                        }
                        
                    }
                    if (rtemp[0] as! String).lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                        if !foundSongs.contains(song) {
                            foundSongs.append(song)
                        }
                    }
                    if (rtemp[1] as! Array<String>) != [""] {
                        for artist in (rtemp[1] as! Array<String>) {
                            let word = artist.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundSongs.contains(song) {
                                    foundSongs.append(song)
                                }
                            }
                        }
                    }
                    if (rtemp[2] as! Array<String>) != [""] {
                        for producer in (rtemp[2] as! Array<String>) {
                            let word = producer.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundSongs.contains(song) {
                                    foundSongs.append(song)
                                }
                            }
                        }
                        
                    }
                    if (rtemp[5] as! Array<String>) != [""] {
                        for instrumental in (rtemp[5] as! Array<String>) {
                            let word = instrumental.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundSongs.contains(song) {
                                    foundSongs.append(song)
                                }
                            }
                        }
                        
                    }
                    if (rtemp[6] as! Array<String>) != [""] {
                        for album in (rtemp[6] as! Array<String>) {
                            let word = album.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundSongs.contains(song) {
                                    foundSongs.append(song)
                                }
                            }
                        }
                    }
                    if (rtemp[7] as! Array<String>) != [""] {
                        for video in (rtemp[7] as! Array<String>) {
                            let word = video.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundSongs.contains(song) {
                                    foundSongs.append(song)
                                }
                            }
                        }
                        
                    }
                    if let arr = rtemp[8] as? [String] {
                        for merch in arr {
                            let word = merch.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundSongs.contains(song) {
                                    foundSongs.append(song)
                                }
                            }
                        }
                        
                    }
                }
                
                
            }
            completion(foundSongs)
            return
        })
    }
    
    func searchMerch(text: String, limit: Int, completion: @escaping (([MerchData]) -> Void)) {
        //print(text)
        var foundMerch:[MerchData] = []
        Database.database().reference().child("Merch").observeSingleEvent(of: .value, with: { snap in
            for child in snap.children {
                let kid = child as! DataSnapshot
                let key = kid.key
                if foundMerch.count == limit {
                    break
                }
                for kid in snap.children {
                    var rtemp:Array<Any> = []
                    let merch = MerchData(kit: nil, apperal: nil, instrumentalSale: nil, service: nil, memorabilia: nil)
                    let child = kid as! DataSnapshot
                    let key = child.key
                    let word = key.split(separator: "Ã†")
                    let id = String(word[0])
                    switch id.count {
                    case 24:
                        let memo = MerchMemorabiliaData(date: Date(), colors: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                        let dvalue = child.value as! [String:Any]
                        let images = dvalue["Images"] as! [String]
                        let merchType = dvalue["Merch Type"] as! String
                        let subcat = dvalue["Sub Category"] as! String
                        let tdID = dvalue["Tone Deaf App Id"] as! String
                        let name = dvalue["Name"] as! String
                        let nof = dvalue["Number of Favorites"] as! Int
                        let nop = dvalue["Number of Purchases"] as! Int
                        let predate = dvalue["Date Uploaded"] as! String
                        if let array = dvalue["Artists"] as? [String] {
                            memo.artists = array
                        }
                        if let array = dvalue["Producers"] as? [String] {
                            memo.producers = array
                        }
                        if let array = dvalue["Songs"] as? [String] {
                            memo.songs = array
                        }
                        if let array = dvalue["Albums"] as? [String] {
                            memo.albums = array
                        }
                        if let array = dvalue["Videos"] as? [String] {
                            memo.videos = array
                        }
                        if let array = dvalue["Beats"] as? [String] {
                            memo.beats = array
                        }
                        if let array = dvalue["Instrumentals"] as? [String] {
                            memo.instrumentals = array
                        }
                        for sub in child.children {
                            let up = sub as! DataSnapshot
                            let dkey = up.key
                            if dkey == "Colors" {
                                var colorArr:[MemorabiliaColorData] = []
                                for siz in up.children {
                                    let sze = siz as! DataSnapshot
                                    let size = sze.key
                                    let colordata = MemorabiliaColorData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0)
                                    let cval = sze.value as! [String:Any]
                                    let coll = cval["Color"] as! String
                                    let dateRes = cval["Date Restocked"] as! String
                                    let descript = cval["Description"] as! String
                                    let nopur = cval["Number of Purchases"] as! Int
                                    let quan = cval["Quantity"] as! Int
                                    let repe = cval["Retail Price"] as! Double
                                    if let sale = cval["Sale Price"] as? Double {
                                        colordata.salePrice = sale
                                    }
                                    
                                    colordata.color = coll
                                    let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                    colordata.dateLastRestocked = dateee
                                    colordata.description = descript
                                    colordata.numberOfPurchases = nopur
                                    colordata.quantity = quan
                                    colordata.retailPrice = repe
                                    
                                    
                                    colorArr.append(colordata)
                                    memo.colors = colorArr
                                    
                                }
                            }
                        }
                        memo.merchType = merchType
                        memo.imageURLs = images
                        memo.subcategory = subcat
                        memo.tDAppId = tdID
                        memo.name = name
                        memo.numberOfFavorites = nof
                        memo.numberOfPurchases = nop
                        
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        memo.date = date
                        
                        merch.memorabilia = memo
                    case 23:
                        let apperal = MerchApperalData(date: Date(), osfaSize: nil, xxsmallSize: nil,xsmallSize: nil,smallSize: nil,mediumSize: nil,largeSize: nil,xlargeSize: nil,xxlargeSize: nil,xxxlargeSize: nil, imageURLs: [], merchType: "", name: "", numberOfPurchases: 0, numberOfFavorites: 0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                        let dvalue = child.value as! [String:Any]
                        let images = dvalue["Images"] as! [String]
                        let merchType = dvalue["Merch Type"] as! String
                        let subcat = dvalue["Sub Category"] as! String
                        let tdID = dvalue["Tone Deaf App Id"] as! String
                        let name = dvalue["Name"] as! String
                        let nof = dvalue["Number of Favorites"] as! Int
                        let nop = dvalue["Number of Purchases"] as! Int
                        let predate = dvalue["Date Uploaded"] as! String
                        if let array = dvalue["Artists"] as? [String] {
                            apperal.artists = array
                        }
                        if let array = dvalue["Producers"] as? [String] {
                            apperal.producers = array
                        }
                        if let array = dvalue["Songs"] as? [String] {
                            apperal.songs = array
                        }
                        if let array = dvalue["Albums"] as? [String] {
                            apperal.albums = array
                        }
                        if let array = dvalue["Videos"] as? [String] {
                            apperal.videos = array
                        }
                        if let array = dvalue["Beats"] as? [String] {
                            apperal.beats = array
                        }
                        if let array = dvalue["Instrumentals"] as? [String] {
                            apperal.instrumentals = array
                        }
                        for sub in child.children {
                            let up = sub as! DataSnapshot
                            let dkey = up.key
                            if dkey == "Sizes" {
                                var osfaarr:[ApperalSizeData] = []
                                var xxsmallarr:[ApperalSizeData] = []
                                var xsmallarr:[ApperalSizeData] = []
                                var smallarr:[ApperalSizeData] = []
                                var mediumarr:[ApperalSizeData] = []
                                var largearr:[ApperalSizeData] = []
                                var xlargearr:[ApperalSizeData] = []
                                var xxlargearr:[ApperalSizeData] = []
                                var xxxlargearr:[ApperalSizeData] = []
                                for siz in up.children {
                                    let sze = siz as! DataSnapshot
                                    let size = sze.key
                                    for col in sze.children {
                                        let sizedata = ApperalSizeData(color: "", numberOfPurchases: 0, retailPrice: 0.0, salePrice: nil, dateLastRestocked: Date(), description: "", quantity: 0, size: "")
                                        
                                        let cole = col as! DataSnapshot
                                        let color = cole.key
                                        let cval = cole.value as! [String:Any]
                                        let coll = cval["Color"] as! String
                                        let dateRes = cval["Date Restocked"] as! String
                                        let descript = cval["Description"] as! String
                                        let nopur = cval["Number of Purchases"] as! Int
                                        let quan = cval["Quantity"] as! Int
                                        let repe = cval["Retail Price"] as! Double
                                        let dasize = cval["Size"] as! String
                                        
                                        sizedata.color = coll
                                        let dateee = dateRes.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                                        sizedata.dateLastRestocked = dateee
                                        sizedata.description = descript
                                        sizedata.numberOfPurchases = nopur
                                        sizedata.quantity = quan
                                        sizedata.retailPrice = repe
                                        sizedata.size = dasize
                                        
                                        if let sale = cval["Sale Price"] as? Double {
                                            sizedata.salePrice = sale
                                        }
                                        
                                        switch sizedata.size {
                                        case "OSFA":
                                            osfaarr.append(sizedata)
                                            apperal.osfaSize = osfaarr
                                        case "XXS":
                                            xxsmallarr.append(sizedata)
                                            apperal.xxsmallSize = xxsmallarr
                                        case "XS":
                                            xsmallarr.append(sizedata)
                                            apperal.xsmallSize = xsmallarr
                                        case "S":
                                            smallarr.append(sizedata)
                                            apperal.smallSize = smallarr
                                        case "M":
                                            mediumarr.append(sizedata)
                                            apperal.mediumSize = mediumarr
                                        case "L":
                                            largearr.append(sizedata)
                                            apperal.largeSize = largearr
                                        case "XL":
                                            xlargearr.append(sizedata)
                                            apperal.xlargeSize = xlargearr
                                        case "XXL":
                                            xxlargearr.append(sizedata)
                                            apperal.xxlargeSize = xxlargearr
                                        case "XXXL":
                                            xxxlargearr.append(sizedata)
                                            apperal.xxxlargeSize = xxxlargearr
                                        default:
                                            print("you trippin tone")
                                        }
                                        
                                    }
                                }
                            }
                        }
                        apperal.merchType = merchType
                        apperal.imageURLs = images
                        apperal.subcategory = subcat
                        apperal.tDAppId = tdID
                        apperal.name = name
                        apperal.numberOfFavorites = nof
                        apperal.numberOfPurchases = nop
                        
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        apperal.date = date
                        
                        merch.apperal = apperal
                    case 22:
                        let kit = MerchKitData(date: Date(), description: "", fileURL: "", imageURLs: [], merchType: "", name: "", quantity: 0, numberOfPurchases: 0, numberOfFavorites: 0, previewURL: "", retailPrice: 0.0, salePrice: 0.0, subcategory: "", tDAppId: "", artists: nil, producers: nil, songs: nil, albums: nil, videos: nil, instrumentals: nil, beats: nil)
                        let dvalue = child.value as! [String:Any]
                        let images = dvalue["Images"] as! [String]
                        let merchType = dvalue["Merch Type"] as! String
                        let subcat = dvalue["Sub Category"] as! String
                        let tdID = dvalue["Tone Deaf App Id"] as! String
                        let name = dvalue["Name"] as! String
                        let fileurl = dvalue["File URL"] as! String
                        let prevurl = dvalue["Preview URL"] as! String
                        let description = dvalue["Description"] as! String
                        let nof = dvalue["Number of Favorites"] as! Int
                        let nop = dvalue["Number of Purchases"] as! Int
                        let predate = dvalue["Date Uploaded"] as! String
                        if let array = dvalue["Artists"] as? [String] {
                            kit.artists = array
                        }
                        if let array = dvalue["Producers"] as? [String] {
                            kit.producers = array
                        }
                        if let array = dvalue["Songs"] as? [String] {
                            kit.songs = array
                        }
                        if let array = dvalue["Albums"] as? [String] {
                            kit.albums = array
                        }
                        if let array = dvalue["Videos"] as? [String] {
                            kit.videos = array
                        }
                        if let array = dvalue["Beats"] as? [String] {
                            kit.beats = array
                        }
                        if let array = dvalue["Instrumentals"] as? [String] {
                            kit.instrumentals = array
                        }
                        if let num = dvalue["Retail Price"] as? Double {
                            kit.retailPrice = num
                        }
                        if let num = dvalue["Sale Price"] as? Double {
                            kit.salePrice = num
                        }
                        if let num = dvalue["Quantity"] as? Int {
                            kit.quantity = num
                        }
                        kit.merchType = merchType
                        kit.imageURLs = images
                        kit.subcategory = subcat
                        kit.tDAppId = tdID
                        kit.name = name
                        kit.numberOfFavorites = nof
                        kit.numberOfPurchases = nop
                        kit.description = description
                        kit.fileURL = fileurl
                        kit.previewURL = prevurl
                        
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        kit.date = date
                        merch.kit = kit
                    case 21:
                        print("Bundle")
                    case 20:
                        let service = MerchServiceData(name: "", serviceType: "", tDAppId: "", retailPrice: nil, salePrice: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date(), description: "", producers: nil)
                        let dvalue = child.value as! [String:Any]
                        let merchType = dvalue["Merch Type"] as! String
                        let servtype = dvalue["Service Type"] as! String
                        let tdID = dvalue["Tone Deaf App Id"] as! String
                        let name = dvalue["Name"] as! String
                        let description = dvalue["Description"] as! String
                        let nof = dvalue["Number of Favorites"] as! Int
                        let nop = dvalue["Number of Purchases"] as! Int
                        let predate = dvalue["Date Uploaded"] as! String
                        if let array = dvalue["Producers"] as? [String] {
                            service.producers = array
                        }
                        if let num = dvalue["Retail Price"] as? Double {
                            service.retailPrice = num
                        }
                        if let num = dvalue["Sale Price"] as? Double {
                            service.salePrice = num
                        }
                        service.merchType = merchType
                        service.serviceType = servtype
                        service.tDAppId = tdID
                        service.name = name
                        service.numberOfFavorites = nof
                        service.numberOfPurchases = nop
                        service.description = description
                        
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        service.dateUploaded = date
                        merch.service = service
                    case 12:
                        let botval = child.value as! [String:Any]
                        let instr = MerchInstrumentalData(instrumentaldbid: key, retailPrice: 0.0, salePrice: nil, quantity: nil, merchType: "", numberOfFavorites: 0, numberOfPurchases: 0, dateUploaded: Date())
                        instr.retailPrice = botval["Retail Price"] as! Double
                        instr.merchType = botval["Merch Type"] as! String
                        instr.numberOfPurchases = botval["Number of Purchases"] as! Int
                        let predate = botval["Date Uploaded"] as! String
                        guard predate != "" else {return}
                        let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                        instr.dateUploaded = date
                        if let ite = botval["Sale Price"] as? Double {
                            instr.salePrice = ite
                        }
                        if let ite = botval["Quantity"] as? Int {
                            instr.quantity = ite
                        }
                        merch.instrumentalSale = instr
                    default:
                        print("All Merch Fecth Error")
                    }
                    if let merr = merch.kit {
                        rtemp.append(merr.name)
                        rtemp.append(merr.artists as Any)
                        rtemp.append(merr.producers as Any)
                        rtemp.append(merr.instrumentals as Any)
                        rtemp.append(merr.albums as Any)
                        rtemp.append(merr.videos as Any)
                        rtemp.append(merr.songs as Any)
                    } else if let merr = merch.apperal {
                        rtemp.append(merr.name)
                        rtemp.append(merr.artists as Any)
                        rtemp.append(merr.producers as Any)
                        rtemp.append(merr.instrumentals as Any)
                        rtemp.append(merr.albums as Any)
                        rtemp.append(merr.videos as Any)
                        rtemp.append(merr.songs as Any)
                    } else if let merr = merch.service {
                        rtemp.append(merr.name)
                        rtemp.append("")
                        rtemp.append(merr.producers as Any)
                        rtemp.append("")
                        rtemp.append("")
                        rtemp.append("")
                        rtemp.append("")
                    } else if let merr = merch.memorabilia {
                        rtemp.append(merr.name)
                        rtemp.append(merr.artists as Any)
                        rtemp.append(merr.producers as Any)
                        rtemp.append(merr.instrumentals as Any)
                        rtemp.append(merr.albums as Any)
                        rtemp.append(merr.videos as Any)
                        rtemp.append(merr.songs as Any)
                    } else if let merr = merch.instrumentalSale {
                        let word = merr.instrumentaldbid.split(separator: "Ã†")
                        let name = String(word[1])
                        rtemp.append(name)
                        rtemp.append("")
                        rtemp.append("")
                        rtemp.append("")
                        rtemp.append("")
                        rtemp.append("")
                        rtemp.append("")
                    }
                    if (rtemp[0] as! String).lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                        if !foundMerch.contains(merch) {
                            foundMerch.append(merch)
                        }
                    }
                    if let arr = rtemp[1] as? [String] {
                        for artist in arr {
                            let word = artist.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundMerch.contains(merch) {
                                    foundMerch.append(merch)
                                }
                            }
                        }
                    }
                    if let arr = rtemp[2] as? [String] {
                        for producer in arr {
                            let word = producer.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundMerch.contains(merch) {
                                    foundMerch.append(merch)
                                }
                            }
                        }
                        
                    }
                    if let arr = rtemp[3] as? [String] {
                        for instrumental in arr {
                            let word = instrumental.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundMerch.contains(merch) {
                                    foundMerch.append(merch)
                                }
                            }
                        }
                        
                    }
                    if let arr = rtemp[4] as? [String] {
                        for album in arr {
                            let word = album.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundMerch.contains(merch) {
                                    foundMerch.append(merch)
                                }
                            }
                        }
                    }
                    if let arr = rtemp[5] as? [String] {
                        for video in arr {
                            let word = video.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundMerch.contains(merch) {
                                    foundMerch.append(merch)
                                }
                            }
                        }
                        
                    }
                    if let arr = rtemp[6] as? [String] {
                        for song in arr {
                            let word = song.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundMerch.contains(merch) {
                                    foundMerch.append(merch)
                                }
                            }
                        }
                        
                    }
                }
                
                
            }
            
            completion(foundMerch)
            return
        })
    }
    
    func searchAlbums(text: String, limit: Int, completion: @escaping (([AlbumData]) -> Void)) {
        //print(text)
        var foundAlbums:[AlbumData] = []
        Database.database().reference().child("Music Content").child("Albums").observeSingleEvent(of: .value, with: { snap in
            for child in snap.children {
                let kid = child as! DataSnapshot
                let key = kid.key
                if key == "All Album IDs" {} else {
                    if foundAlbums.count == limit {
                        break
                    }
                    var rtemp:Array<Any> = []
                    var youtubeAlts:[String] = []
                    let album = AlbumData(toneDeafAppId: "", instrumentals: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", songs: nil, tracks: [:], videos: nil, merch: nil, name: "", mainArtist: [], allArtists: nil, producers: [], writers: nil, mixEngineers: nil, masteringEngineers: nil, recordingEngineers: nil, isActive: false, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, numberofTracks: 0, officialAlbumVideo: nil, spotify: nil, apple: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, tidal: nil, deezer: nil, spinrilla: nil, napster: nil, industryCerified: nil, verificationLevel:nil, deluxes: nil, isDeluxe: nil, isOtherVersion: nil, otherVersions: nil)
                    for sub in kid.children {
                        let up = sub as! DataSnapshot
                        let dkey = up.key
                        //print(up.key)
                        if dkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            let dvalue = up.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Main Artist"] as! Array<String>)
                            temp.append(dvalue["All Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Number Of Tracks"] as! Int)
                            temp.append(dvalue["Time Registered To App"] as! String)
                            temp.append(dvalue["Date Registered To App"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            if let tval = (dvalue["All Artist"]) as? [String] {
                                album.allArtists = tval
                            }
                            if let tval = (dvalue["All Writers"]) as? [String] {
                                album.writers = tval
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mix Engineer"]) as? [String] {
                                    album.mixEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Mastering Engineer"]) as? [String] {
                                    album.masteringEngineers = tval
                                }
                            }
                            if let trval = (dvalue["Engineers"]) as? NSDictionary {
                                if let tval = (trval["Recording Engineer"]) as? [String] {
                                    album.recordingEngineers = tval
                                }
                            }
                            if let merchandise = (dvalue["Merch"]) {
                                album.merch = (merchandise as! [String])
                            }
                            if let tval = (dvalue["Songs"]) as? [String] {
                                album.songs = tval
                            }
                            if let tval = (dvalue["Instrumentals"]) as? [String] {
                                album.instrumentals = tval
                            }
                            if let tval = (dvalue["Videos"]) as? [String] {
                                album.videos = tval
                            }
                            if let tval = (dvalue["Tracks"]) as? [String:String] {
                                album.tracks = tval
                            }
                            if let tval = (dvalue["Manual Image URL"]) as? String {
                                album.manualImageURL = tval
                            }
                            if let tval = (dvalue["Manual Preview URL"]) as? String {
                                album.manualPreviewURL = tval
                            }
                            if let tval = (dvalue["Industry Certified"] as? Bool) {
                                album.industryCerified = tval
                            }
                            if let tval = (dvalue["Verification Level"] as? String) {
                                album.verificationLevel = Character(tval)
                            }
                            if let tval = (dvalue["Deluxes"] as? [String]) {
                                album.deluxes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                album.otherVersions = tval
                            }
                            if let taval = (dvalue["Deluxe"] as? NSDictionary) {
                                let deluxe = AlbumDeluxeData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                album.isDeluxe = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = AlbumOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                album.isOtherVersion = deluxe
                            }
                            
                            
                            album.name = temp[0] as! String
                            album.mainArtist = temp[1] as! Array<String>
                            album.producers = temp[2] as! Array<String>
                            album.favoritesOverall = temp[3] as! Int
                            album.toneDeafAppId = temp[4] as! String
                            album.numberofTracks = temp[5] as! Int
                            album.timeRegisteredToApp = temp[6] as! String
                            album.dateRegisteredToApp = temp[7] as! String
                            album.isActive = temp[8] as! Bool
                        }
                        if dkey.contains("APPL") == true {
                            let appleData = AppleAlbumData(name: "", toneDeafAppId: "", dateReleasedApple: "", dateIA: "", timeIA: "", imageURL: "", trackCount: 0, artist: "", url: "", appleId: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! String)
                            temp.append(dvalue["Date Released On Apple"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Apple Music Id"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            
                            appleData.name = temp[0] as! String
                            appleData.artist = temp[1] as! String
                            appleData.dateReleasedApple = temp[2] as! String
                            appleData.timeIA = temp[3] as! String
                            appleData.dateIA = temp[4] as! String
                            appleData.imageURL = temp[5] as! String
                            appleData.url = temp[6] as! String
                            //appleData. = temp[6] as! Int
                            appleData.trackCount = temp[7] as! Int
                            appleData.appleId = temp[8] as! String
                            appleData.isActive = temp[9] as! Bool
                            
                            album.apple = appleData
                        }
                        if dkey.contains("SPTY") == true {
                            let spotifyData = SpotifyAlbumData(toneDeafAppId: "", name: "", artist: [["":""]], spotifyId: "", url: "", uri: "", imageURL: "", upc: "", trackNumberTotal: 0, dateReleasedSpotify: "", dateIA: "", timeIA: "", isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Artists"] as! [[String:String]])
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Date Released On Spotify"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Album URI"] as! String)
                            //temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Number of Tracks"] as! Int)
                            temp.append(dvalue["Spotify Id"] as! String)
                            
                            spotifyData.name = temp[0] as! String
                            spotifyData.artist = temp[1] as! [[String:String]]
                            spotifyData.upc = temp[2] as! String
                            spotifyData.dateReleasedSpotify = temp[3] as! String
                            spotifyData.timeIA = temp[4] as! String
                            spotifyData.dateIA = temp[5] as! String
                            spotifyData.imageURL = temp[6] as! String
                            spotifyData.url = temp[7] as! String
                            spotifyData.uri = temp[8] as! String
                            //spotifyData. = temp[10] as! Bool
                            spotifyData.trackNumberTotal = temp[9] as! Int
                            spotifyData.spotifyId = temp[10] as! String
                            
                            album.spotify = spotifyData
                            
                        }
                        if dkey.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            soundcloud.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Soundcloud"] != nil {
                                soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                            }
                            album.soundcloud = soundcloud
                        }
                        if dkey.contains(youtubeMusicContentType) == true {
                            let youtubeMusic = YoutubeMusicAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            youtubeMusic.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.youtubeMusic = youtubeMusic
                        }
                        if dkey.contains(amazonMusicContentType) == true {
                            let amazon = AmazonAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            amazon.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                amazon.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.amazon = amazon
                        }
                        if dkey.contains(deezerMusicContentType) == true {
                            let deezer = DeezerAlbumData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, upc: nil, name: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            
                            temp.append(dvalue["Date Released On Deezer"] as! String)
                            temp.append(dvalue["Artist"] as! [[String:Any]])
                            temp.append(dvalue["Artwork URL"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["UPC"] as! String)
                            temp.append(dvalue["Name"] as! String)
                            temp.append(dvalue["Album URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Deezer Music Id"] as! Int)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            
                            deezer.deezerDate = temp[0] as! String
                            deezer.artist = temp[1] as! [[String:Any]]
                            deezer.imageurl = temp[2] as! String
                            deezer.duration = temp[3] as! String
                            deezer.upc = temp[4] as! String
                            deezer.name = temp[5] as! String
                            deezer.url = temp[6] as! String
                            deezer.timeIA = temp[7] as! String
                            deezer.deezerID = temp[8] as! Int
                            deezer.dateIA = temp[9] as! String
                            
                            album.deezer = deezer
                        }
                        if dkey.contains(spinrillaMusicContentType) == true {
                            let spinrilla = SpinrillaAlbumData(url: "",imageurl: nil,releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            spinrilla.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            if dvalue["Date Released On Spinrilla"] != nil {
                                spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                            }
                            album.spinrilla = spinrilla
                        }
                        if dkey.contains(napsterMusicContentType) == true {
                            let napster = NapsterAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            napster.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                napster.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.napster = napster
                        }
                        if dkey.contains(tidalMusicContentType) == true {
                            let tidal = TidalAlbumData(url: "", imageurl: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = up.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            tidal.url = temp[0] as! String
                            if dvalue["Artwork URL"] != nil {
                                tidal.imageurl = (dvalue["Artwork URL"] as! String)
                            }
                            album.tidal = tidal
                        }
                        if dkey == "Videos" {
                                for diva in up.children {
                                    let lsat = diva as! DataSnapshot
                                    let vidkey = lsat.key
                                    if vidkey == "Official" {
                                        var temp:Array<Any> = []
                                        let vvalue = lsat.value! as! [String:Any]
                                        temp.append(vvalue["id"] as! String)
                                        album.officialAlbumVideo = temp[0] as! String
                                    }
                                }
                        }
                    }
                    if (rtemp[0] as! String).lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                        if !foundAlbums.contains(album) {
                            foundAlbums.append(album)
                        }
                    }
                    if (rtemp[2] as! Array<String>) != [""] {
                        for artist in (rtemp[2] as! Array<String>) {
                            let word = artist.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundAlbums.contains(album) {
                                    foundAlbums.append(album)
                                }
                            }
                        }
                    }
                    if (rtemp[3] as! Array<String>) != [""] {
                        for producer in (rtemp[3] as! Array<String>) {
                            let word = producer.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundAlbums.contains(album) {
                                    foundAlbums.append(album)
                                }
                            }
                        }
                        
                    }
                    if (rtemp[5] as! Array<String>) != [""] {
                        for instrumental in (rtemp[5] as! Array<String>) {
                            let word = instrumental.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundAlbums.contains(album) {
                                    foundAlbums.append(album)
                                }
                            }
                        }
                        
                    }
                    for (num,song) in (rtemp[6] as! [String:String]) {
                        let word = song.split(separator: "Ã†")
                        let contentName = word[1]
                        if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                            if !foundAlbums.contains(album) {
                                foundAlbums.append(album)
                            }
                        }
                    }
                    if (rtemp[7] as! Array<String>) != [""] {
                        for video in (rtemp[7] as! Array<String>) {
                            let word = video.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundAlbums.contains(album) {
                                    foundAlbums.append(album)
                                }
                            }
                        }
                        
                    }
                    if let arr = rtemp[8] as? [String] {
                        for merch in arr {
                            let word = merch.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundAlbums.contains(album) {
                                    foundAlbums.append(album)
                                }
                            }
                        }
                        
                    }
                }
                
                
            }
            completion(foundAlbums)
            return
        })
    }
    
    func searchInstrumentals(text: String, limit: Int, completion: @escaping (([InstrumentalData]) -> Void)) {
        //print(text)
        var foundInstrumentals:[InstrumentalData] = []
        Database.database().reference().child("Music Content").child("Instrumentals").observeSingleEvent(of: .value, with: { snap in
            for child in snap.children {
                let kid = child as! DataSnapshot
                let key = kid.key
                if key == "All Instrumental IDs" {} else {
                    if foundInstrumentals.count == limit {
                        break
                    }
                    let instrumental = InstrumentalData(instrumentalName: nil, toneDeafAppId: "", artist: nil, producers: [], mixEngineer: nil, masteringEngineer: nil, songName: nil, songs: nil, duration: "", audioURL: "", manualImageURL: nil, manualPreviewURL: nil, favoritesOverall: 0, officialVideo: nil, dateRegisteredToApp: "", timeRegisteredToApp: "", apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, videos: nil, albums: nil, merch: nil, storeInfo: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    var ltemp:Array<Any> = []
                    let dvalue = kid.value as! [String:Any]
                    ltemp.append(dvalue["Name"] as! String)
                    ltemp.append(dvalue["Producers"] as! Array<String>)
                    ltemp.append(dvalue["Audio URL"] as! String)
                    ltemp.append(dvalue["Time Uploaded To App"] as! String)
                    ltemp.append(dvalue["Date Uploaded To App"] as! String)
                    ltemp.append(dvalue["Duration"] as! String)
                    ltemp.append(dvalue["Number of Favorites"] as! Int)
                    ltemp.append(dvalue["Tone Deaf App Id"] as! String)
                    ltemp.append(dvalue["Active Status"] as! Bool)
                    if let tval = (dvalue["Songs"] as? [String]) {
                        instrumental.songs = tval
                    }
                    if let tval = (dvalue["Albums"] as? [String]) {
                        instrumental.albums = tval
                    }
                    if let eval = (dvalue["Engineers"] as? NSDictionary) {
                        if let tval = (eval["Mix Engineer"] as? [String]) {
                            instrumental.mixEngineer = tval
                        }
                        if let tval = (eval["Mastering Engineer"] as? [String]) {
                            instrumental.masteringEngineer = tval
                        }
                    }
                    if let tval = (dvalue["Videos"] as? [String]) {
                        instrumental.videos = tval
                    }
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        instrumental.merch = (merchandise)
                    }
                    if let tval = (dvalue["Artists"] as? [String]) {
                        instrumental.artist = tval
                    }
                    if let tval = (dvalue["Manual Image URL"] as? String) {
                        instrumental.manualImageURL = tval
                    }
                    if let tval = (dvalue["Manual Preview URL"] as? String) {
                        instrumental.manualPreviewURL = tval
                    }
                    if let tval = (dvalue["Industry Certified"] as? Bool) {
                        instrumental.industryCerified = tval
                    }
                    if let tval = (dvalue["Verification Level"] as? String) {
                        instrumental.verificationLevel = Character(tval)
                    }
                    for chi in kid.children {
                        let da = chi as! DataSnapshot
                        let lilkey = da.key
                        if lilkey == "Store Info" {
                            let inststore = InstrumentalStoreInfo(retailPrice: 0.0, salePrice: nil, dateUploaded: Date(), merchType: "", numberOfPurchases: 0, quantity: nil)
                            let botval = da.value as! [String:Any]
                            
                            inststore.retailPrice = botval["Retail Price"] as! Double
                            inststore.merchType = botval["Merch Type"] as! String
                            inststore.numberOfPurchases = botval["Number of Purchases"] as! Int
                            let predate = botval["Date Uploaded"] as! String
                            guard predate != "" else {return}
                            let date = predate.date(format: "yyyy-MM-dd HH:mm:ss Z")!
                            inststore.dateUploaded = date
                            if let ite = botval["Sale Price"] as? Double {
                                inststore.salePrice = ite
                            }
                            if let ite = botval["Quantity"] as? Int {
                                inststore.quantity = ite
                            }
                            instrumental.storeInfo = inststore
                        }
                        if lilkey == "Videos" {
                            for dis in da.children {
                                let fha = dis as! DataSnapshot
                                let dvalue = fha.value as! [String:Any]
                                if let tval = (dvalue["Official"] as? String) {
                                    instrumental.officialVideo = tval
                                }
                            }
                        }
                    }
                    instrumental.instrumentalName = ltemp[0] as! String
                    instrumental.producers = ltemp[1] as! Array<String>
                    instrumental.audioURL = ltemp[2] as! String
                    instrumental.timeRegisteredToApp = ltemp[3] as! String
                    instrumental.dateRegisteredToApp = ltemp[4] as! String
                    instrumental.duration = ltemp[5] as! String
                    instrumental.favoritesOverall = ltemp[6] as! Int
                    instrumental.toneDeafAppId = ltemp[7] as! String
                    instrumental.isActive = ltemp[8] as! Bool
                    let songname = ltemp[0] as! String
                    instrumental.songName = songname.replacingOccurrences(of: " (Instrumental)", with: "")
                    for val in kid.children {
                        var temp:Array<Any> = []
                        let cont = val as! DataSnapshot
                        let chi = cont.key
                        if (chi).contains(spotifyMusicContentType) == true {
                            let spotify = SpotifySongData(spotifyName: "", spotifySongURL: "", spotifyDuration: "", spotifyDateSPT: "", spotifyDateIA: "", spotifyTimeIA: "", spotifyArtworkURL: "", spotifyArtist1: "", spotifyArtist1URL: "", spotifyArtist2: "", spotifyArtist2URL: "", spotifyArtist3: "", spotifyArtist3URL: "", spotifyArtist4: "", spotifyArtist4URL: "", spotifyArtist5: "", spotifyArtist5URL: "", spotifyArtist6: "", spotifyArtist6URL: "", spotifyExplicity: false, spotifyISRC: "", spotifyAlbumType: "", spotifyTrackNumber: 0, spotifyPreviewURL: "", spotifyFavorites: 0, spotifyId: "", isActive: false)
                            
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Spotify"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist 1"] as! String)
                            temp.append(svalue["Artist 1 URL"] as! String)
                            temp.append(svalue["Artist 2"] as! String)
                            temp.append(svalue["Artist 2 URL"] as! String)
                            temp.append(svalue["Artist 3"] as! String)
                            temp.append(svalue["Artist 3 URL"] as! String)
                            temp.append(svalue["Artist 4"] as! String)
                            temp.append(svalue["Artist 4 URL"] as! String)
                            temp.append(svalue["Artist 5"] as! String)
                            temp.append(svalue["Artist 5 URL"] as! String)
                            temp.append(svalue["Artist 6"] as! String)
                            temp.append(svalue["Artist 6 URL"] as! String)
                            temp.append(svalue["Album Type"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Spotify Id"] as! String)
                            ltemp.append(dvalue["Active Status"] as! Bool)
                            
                            spotify.spotifyName = temp[0] as! String
                            spotify.spotifyDuration = temp[1] as! String
                            spotify.spotifyDateIA = temp[2] as! String
                            spotify.spotifyDateSPT = temp[3] as! String
                            spotify.spotifyPreviewURL = temp[4] as! String
                            spotify.spotifyISRC = temp[5] as! String
                            spotify.spotifyFavorites = temp[6] as! Int
                            spotify.spotifyArtworkURL = temp[7] as! String
                            spotify.spotifyTimeIA = temp[8] as! String
                            spotify.spotifySongURL = temp[9] as! String
                            spotify.spotifyExplicity = temp[10] as! Bool
                            spotify.spotifyArtist1 = temp[11] as! String
                            spotify.spotifyArtist1URL = temp[12] as! String
                            spotify.spotifyArtist2 = temp[13] as! String
                            spotify.spotifyArtist2URL = temp[14] as! String
                            spotify.spotifyArtist3 = temp[15] as! String
                            spotify.spotifyArtist3URL = temp[16] as! String
                            spotify.spotifyArtist4 = temp[17] as! String
                            spotify.spotifyArtist4URL = temp[18] as! String
                            spotify.spotifyArtist5 = temp[19] as! String
                            spotify.spotifyArtist5URL = temp[20] as! String
                            spotify.spotifyArtist6 = temp[21] as! String
                            spotify.spotifyArtis6URL = temp[22] as! String
                            spotify.spotifyAlbumType = temp[23] as! String
                            spotify.spotifyTrackNumber = temp[24] as! Int
                            spotify.spotifyId = temp[25] as! String
                            spotify.isActive = ltemp[26] as! Bool
                            
                            instrumental.spotify = spotify
                        }
                        if (chi).contains(appleMusicContentType) == true {
                            let apple = AppleMusicSongData(appleName: "", appleSongURL: "", appleDuration: "", appleDateAPPL: "", appleDateIA: "", appleTimeIA: "", appleArtworkURL: "", appleArtist: "", appleExplicity: false, appleISRC: "", appleAlbumName: "", applePreviewURL: "", applecomposers: "", appleTrackNumber: 0, appleGenres: [], appleFavorites: 0, appleMusicId: "", isActive: false)
                            var temp:Array<Any> = []
                            let svalue = cont.value as! [String:Any]
                            temp.append(svalue["Name"] as! String)
                            temp.append(svalue["Duration"] as! String)
                            temp.append(svalue["Date Uploaded To App"] as! String)
                            temp.append(svalue["Date Released On Apple"] as! String)
                            temp.append(svalue["Preview URL"] as! String)
                            temp.append(svalue["ISRC"] as! String)
                            temp.append(svalue["Number of Favorites"] as! Int)
                            temp.append(svalue["Artwork URL"] as! String)
                            temp.append(svalue["Time Uploaded To App"] as! String)
                            temp.append(svalue["Song URL"] as! String)
                            temp.append(svalue["Explicity"] as! Bool)
                            temp.append(svalue["Artist"] as! String)
                            temp.append(svalue["Album Name"] as! String)
                            temp.append(svalue["Track Number"] as! Int)
                            temp.append(svalue["Apple Music Id"] as! String)
                            ltemp.append(dvalue["Active Status"] as! Bool)
                            
                            apple.appleName = temp[0] as! String
                            apple.appleDuration = temp[1] as! String
                            apple.appleDateIA = temp[2] as! String
                            apple.appleDateAPPL = temp[3] as! String
                            apple.applePreviewURL = temp[4] as! String
                            apple.appleISRC = temp[5] as! String
                            apple.appleFavorites = temp[6] as! Int
                            apple.appleArtworkURL = temp[7] as! String
                            apple.appleTimeIA = temp[8] as! String
                            apple.appleSongURL = temp[9] as! String
                            apple.appleExplicity = temp[10] as! Bool
                            apple.appleArtist = temp[11] as! String
                            apple.appleAlbumName = temp[12] as! String
                            apple.appleTrackNumber = temp[13] as! Int
                            apple.appleMusicId = temp[14] as! String
                            apple.isActive = ltemp[15] as! Bool
                            
                            instrumental.apple = apple
                        }
                        if chi.contains(soundcloudMusicContentType) == true {
                            let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                            var temp:Array<Any> = []
                            let dvalue = cont.value! as! [String:Any]
                            temp.append(dvalue["url"] as! String)
                            temp.append(dvalue["Active Status"] as! Bool)
                            soundcloud.url = temp[0] as! String
                                soundcloud.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                instrumental.soundcloud = soundcloud
                            }
                            if chi.contains(youtubeMusicContentType) == true {
                                let youtubeMusic = YoutubeMusicSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                youtubeMusic.url = temp[0] as! String
                                youtubeMusic.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    youtubeMusic.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.youtubeMusic = youtubeMusic
                            }
                            if chi.contains(amazonMusicContentType) == true {
                                let amazon = AmazonSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                amazon.url = temp[0] as! String
                                amazon.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    amazon.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.amazon = amazon
                            }
                            if chi.contains(deezerMusicContentType) == true {
                                let deezer = DeezerSongData(url: "", imageurl: nil, deezerDate: nil, artist: nil, duration: nil, isrc: nil, name: nil, previewURL: nil, timeIA: nil, dateIA: nil, deezerID: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                
                                temp.append(dvalue["Date Released On Deezer"] as! String)
                                temp.append(dvalue["Artist"] as! [[String : Any]])
                                temp.append(dvalue["Artwork URL"] as! String)
                                temp.append(dvalue["Duration"] as! String)
                                temp.append(dvalue["ISRC"] as! String)
                                temp.append(dvalue["Name"] as! String)
                                temp.append(dvalue["Song URL"] as! String)
                                temp.append(dvalue["Preview URL"] as! String)
                                temp.append(dvalue["Time Uploaded To App"] as! String)
                                temp.append(dvalue["Deezer Music Id"] as! Int)
                                temp.append(dvalue["Date Uploaded To App"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                
                                deezer.deezerDate = temp[0] as! String
                                deezer.artist = temp[1] as! [[String : Any]]
                                deezer.imageurl = temp[2] as! String
                                deezer.duration = temp[3] as! String
                                deezer.isrc = temp[4] as! String
                                deezer.name = temp[5] as! String
                                deezer.url = temp[6] as! String
                                deezer.previewURL = temp[7] as! String
                                deezer.timeIA = temp[8] as! String
                                deezer.deezerID = temp[9] as! Int
                                deezer.dateIA = temp[10] as! String
                                deezer.isActive = temp[11] as! Bool
                                
                                instrumental.deezer = deezer
                            }
                            if chi.contains(spinrillaMusicContentType) == true {
                                let spinrilla = SpinrillaSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                spinrilla.url = temp[0] as! String
                                spinrilla.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    spinrilla.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Spinrilla"] != nil {
                                    spinrilla.releaseDate = (dvalue["Date Released On Spinrilla"] as! String)
                                }
                                instrumental.spinrilla = spinrilla
                            }
                            if chi.contains(napsterMusicContentType) == true {
                                let napster = NapsterSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                napster.url = temp[0] as! String
                                napster.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    napster.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.napster = napster
                            }
                            if chi.contains(tidalMusicContentType) == true {
                                let tidal = TidalSongData(url: "", imageurl: nil, isActive: false)
                                var temp:Array<Any> = []
                                let dvalue = cont.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                temp.append(dvalue["Active Status"] as! Bool)
                                tidal.url = temp[0] as! String
                                tidal.isActive = temp[1] as! Bool
                                if dvalue["Artwork URL"] != nil {
                                    tidal.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                instrumental.tidal = tidal
                            }
                        }
                    if (ltemp[0] as! String).lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                        if !foundInstrumentals.contains(instrumental) {
                            foundInstrumentals.append(instrumental)
                        }
                    }
                    if (ltemp[1] as! Array<String>) != [""] {
                        for producer in (ltemp[1] as! Array<String>) {
                            let word = producer.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundInstrumentals.contains(instrumental) {
                                    foundInstrumentals.append(instrumental)
                                }
                            }
                        }
                    }
                    if (ltemp[10] as! Array<String>) != [""] {
                        for song in (ltemp[10] as! Array<String>) {
                            let word = song.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundInstrumentals.contains(instrumental) {
                                    foundInstrumentals.append(instrumental)
                                }
                            }
                        }
                        
                    }
                    if (ltemp[11] as! Array<String>) != [""] {
                        for album in (ltemp[11] as! Array<String>) {
                            let word = album.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundInstrumentals.contains(instrumental) {
                                    foundInstrumentals.append(instrumental)
                                }
                            }
                        }
                    }
                    if (ltemp[12] as! Array<String>) != [""] {
                        for video in (ltemp[12] as! Array<String>) {
                            let word = video.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundInstrumentals.contains(instrumental) {
                                    foundInstrumentals.append(instrumental)
                                }
                            }
                        }
                        
                    }
                    if let arr = ltemp[13] as? [String] {
                        for merch in arr {
                            let word = merch.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundInstrumentals.contains(instrumental) {
                                    foundInstrumentals.append(instrumental)
                                }
                            }
                        }
                        
                    }
                }
                
                
            }
            completion(foundInstrumentals)
            return
        })
    }
    
    func searchVideos(text: String, limit: Int, completion: @escaping (([AnyObject]) -> Void)) {
        //print(text)
        var foundVideos:[AnyObject] = []
        Database.database().reference().child("Music Content").child("Videos").observeSingleEvent(of: .value, with: {[weak self] snap in
            guard let strongSelf = self else {return}
            for child in snap.children {
                let kid = child as! DataSnapshot
                let key = kid.key
                if key == "All Video IDs" {} else {
                    if foundVideos.count == limit {
                        break
                    }
                    var rtemp:Array<Any> = []
                    let vid:AnyObject!
                    if key.contains("YT") == true {
                        let video = YouTubeData(duration: "", url: "", title: "", dateYT: "", dateIA: "", timeYT: "", timeIA: "", description: "", thumbnailURL: "", channelTitle: "", viewsYT: 0, viewsIA: 0, toneDeafAppId: "", youtubeId: "", type: "", isActive: false)
                        let dvalue = kid.value as! [String:Any]
                        rtemp.append(dvalue["Channel Title"] as! String)
                        rtemp.append(dvalue["Duration"] as! String)
                        rtemp.append(dvalue["Date Uploaded To App"] as! String)
                        rtemp.append(dvalue["Date Uploaded To Youtube"] as! String)
                        rtemp.append(dvalue["Description"] as! String)
                        rtemp.append(dvalue["Number of Favorites"] as! Int)
                        rtemp.append(dvalue["Thumbnail URL"] as! String)
                        rtemp.append(dvalue["Time Uploaded To App"] as! String)
                        rtemp.append(dvalue["Time Uploaded To Youtube"] as! String)
                        rtemp.append(dvalue["Title"] as! String)
                        rtemp.append(dvalue["Video URL"] as! String)
                        rtemp.append(dvalue["Views In App"] as! Int)
                        rtemp.append(dvalue["Views on Youtube"] as! Int)
                        rtemp.append(dvalue["Youtube Id"] as! String)
                        rtemp.append(dvalue["Tone Deaf App Video Id"] as! String)
                        rtemp.append(dvalue["Artist"] as! [String])
                        rtemp.append(dvalue["Producers"] as! [String])
                        rtemp.append(dvalue["Albums"] as! [String])
                        rtemp.append(dvalue["Instrumentals"] as! [String])
                        rtemp.append(dvalue["Songs"] as! [String])
                        rtemp.append(dvalue["Beats"] as! [String])
                        rtemp.append(dvalue["Type"] as! String)
                        if let merchandise = (dvalue["Merch"] as? [String]) {
                            rtemp.append(merchandise)
//                            video.merch = (merchandise)
                        } else {
                            rtemp.append("")
                        }
                        
                        video.channelTitle = rtemp[0] as! String
                        video.duration = rtemp[1] as! String
                        video.dateIA = rtemp[2] as! String
                        video.dateYT = rtemp[3] as! String
                        video.description = rtemp[4] as! String
//                        video.favorites = rtemp[5] as! Int
                        video.thumbnailURL = rtemp[6] as! String
                        video.timeIA = rtemp[7] as! String
                        video.timeYT = rtemp[8] as! String
                        video.title = rtemp[9] as! String
                        video.url = rtemp[10] as! String
                        video.viewsIA = rtemp[11] as! Int
                        video.viewsYT = rtemp[12] as! Int
                        video.youtubeId = rtemp[13] as! String
                        video.toneDeafAppId = rtemp[14] as! String
//                        video.artist = rtemp[15] as! [String]
//                        video.producers = rtemp[16] as! [String]
//                        video.albums = rtemp[17] as! [String]
//                        video.instrumentals = rtemp[18] as! [String]
//                        video.songs = rtemp[19] as! [String]
//                        video.beats = rtemp[20] as! [String]
                        video.type = rtemp[21] as! String
                        
                        if (rtemp[9] as! String).lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                            var dup = false
                            for item in foundVideos {
                                if strongSelf.isEqual(type: YouTubeData.self, a: item, b: video) {
                                    let up = item as! YouTubeData
                                    if up == video {
                                        dup = true
                                    }
                                }
                            }
                            if dup == false{
                                foundVideos.append(video)
                            }
                        }
                        if (rtemp[15] as! Array<String>) != [""] {
                            for artist in (rtemp[15] as! Array<String>) {
                                let word = artist.split(separator: "Ã†")
                                let contentName = word[1]
                                if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    var dup = false
                                    for item in foundVideos {
                                        if strongSelf.isEqual(type: YouTubeData.self, a: item, b: video) {
                                            let up = item as! YouTubeData
                                            if up == video {
                                                dup = true
                                            }
                                        }
                                    }
                                    if dup == false{
                                        foundVideos.append(video)
                                    }
                                }
                            }
                        }
                        if (rtemp[16] as! Array<String>) != [""] {
                            for producer in (rtemp[16] as! Array<String>) {
                                let word = producer.split(separator: "Ã†")
                                let contentName = word[1]
                                if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    var dup = false
                                    for item in foundVideos {
                                        if strongSelf.isEqual(type: YouTubeData.self, a: item, b: video) {
                                            let up = item as! YouTubeData
                                            if up == video {
                                                dup = true
                                            }
                                        }
                                    }
                                    if dup == false{
                                        foundVideos.append(video)
                                    }
                                }
                            }
                            
                        }
                        if (rtemp[18] as! Array<String>) != [""] {
                            for instrumental in (rtemp[18] as! Array<String>) {
                                let word = instrumental.split(separator: "Ã†")
                                let contentName = word[1]
                                if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    var dup = false
                                    for item in foundVideos {
                                        if strongSelf.isEqual(type: YouTubeData.self, a: item, b: video) {
                                            let up = item as! YouTubeData
                                            if up == video {
                                                dup = true
                                            }
                                        }
                                    }
                                    if dup == false{
                                        foundVideos.append(video)
                                    }
                                }
                            }
                            
                        }
                        if (rtemp[19] as! Array<String>) != [""] {
                            for song in (rtemp[19] as! Array<String>) {
                                let word = song.split(separator: "Ã†")
                                let contentName = word[1]
                                if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    var dup = false
                                    for item in foundVideos {
                                        if strongSelf.isEqual(type: YouTubeData.self, a: item, b: video) {
                                            dup = true
                                        }
                                    }
                                    if !dup{
                                        foundVideos.append(video)
                                    }
                                }
                            }
                        }
                        if (rtemp[17] as! Array<String>) != [""] {
                            for album in (rtemp[17] as! Array<String>) {
                                let word = album.split(separator: "Ã†")
                                let contentName = word[1]
                                if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    var dup = false
                                    for item in foundVideos {
                                        if strongSelf.isEqual(type: YouTubeData.self, a: item, b: video) {
                                            let up = item as! YouTubeData
                                            if up == video {
                                                dup = true
                                            }
                                        }
                                    }
                                    if dup == false{
                                        foundVideos.append(video)
                                    }
                                }
                            }
                            
                        }
                        if let arr = rtemp[22] as? [String] {
                            for merch in arr {
                                let word = merch.split(separator: "Ã†")
                                let contentName = word[1]
                                if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    var dup = false
                                    for item in foundVideos {
                                        if strongSelf.isEqual(type: YouTubeData.self, a: item, b: video) {
                                            dup = true
                                        }
                                    }
                                    if !dup{
                                        foundVideos.append(video)
                                    }
                                }
                            }
                        }
                    }
                    
                }
                
                
            }
            completion(foundVideos)
            return
        })
    }
    
    func searchBeats(text: String, limit: Int, completion: @escaping (([BeatData]) -> Void)) {
        //print(text)
        var foundBeats:[BeatData] = []
        Database.database().reference().child("Beats").observeSingleEvent(of: .value, with: { snap in
            
            for child in snap.children {
                let data = child as! DataSnapshot
                let price = data.key
                let beat = BeatData(duration: "", name: "", toneDeafAppId: "", producers: [""], date: "", downloads: 0, mp3Price: 0.0, wavPrice: 0.0, exclusivePrice: 0.0, time: "", tempo: 0, datetime: "", audioURL: "", imageURL: "", beatID: "", priceType: "", types: [], sounds: [], exclusiveFilesURL: nil, wavURL: nil, officialVideo: nil, videos: [], soundcloud: nil, key: "", merch: nil, isActive: nil)
                if price == "All Beat IDs" {} else {
                    if foundBeats.count == limit {
                        return
                    }
                for item in data.children {
                    let bea = item as! DataSnapshot
                    let key = bea.key
                    if key != "Free Beat IDs" && key != "Paid Beat IDs" {
                        var temp:Array<Any> = []
                        let value = bea.value as! [String:Any]
                        var typeArray:[String] = []
                        var soundArray:[String] = []
                        var time:String!
                        var date:String!
                        if let tval = value["Duration"] as? String {
                            beat.duration = tval
                        }
                        if let tval = value["Name"] as? String {
                            beat.name = tval
                        }
                        if let tval = value["Date"] as? String {
                            beat.date = tval
                            date = tval
                        }
                        if let tval = value["Number of Downloads"] as? Int {
                            beat.downloads = tval
                        }
                        if let tval = value["Wav Price"] as? Double {
                            beat.wavPrice = tval
                        }
                        if let tval = value["Lease Price"] as? Double {
                            beat.mp3Price = tval
                        }
                        if let tval = value["Exclusive Price"] as? Double {
                            beat.exclusivePrice = tval
                        }
                        if let tval = value["Time"] as? String {
                            beat.time = tval
                            time = tval
                        }
                        if let tval = value["Types"] as? [String] {
                            beat.types = tval
                        }
                        if let tval = value["Sounds"] as? [String] {
                            beat.sounds = tval
                        }
                        if let tval = value["Tempo"] as? Int {
                            beat.tempo = tval
                        }
                        if let tval = value["Audio"] as? String {
                            beat.audioURL = tval
                        }
                        if let tval = value["Image"] as? String {
                            beat.imageURL = tval
                        }
                        if let tval = value["beatId"] as? String {
                            beat.beatID = tval
                        }
                        if let tval = value["Price Type"] as? String {
                            beat.priceType = tval
                        }
                        if let tval = value["Producers"] as? [String] {
                            beat.producers = tval
                        }
                        if let tval = value["Tone Deaf App Id"] as? String {
                            beat.toneDeafAppId = tval
                        }
                        if let tval = value["Exclusive Files URL"] as? String {
                            beat.exclusiveFilesURL = tval
                        }
                        if let tval = value["Wav URL"] as? String {
                            beat.wavURL = tval
                        }
                        if let tval = value["Official Video"] as? String {
                            beat.officialVideo = tval
                        }
                        if let tval = value["Videos"] as? [String] {
                            beat.videos = tval
                        }
                        if let tval = value["Key"] as? String {
                            beat.key = tval
                        }
                        if let tval = value["Active Status"] as? Bool {
                            beat.isActive = tval
                        }
                        if let merchandise = (value["Merch"] as? [String]) {
                            beat.merch = (merchandise)
                        }
                        beat.datetime = "\(date)\(time)"
                        let soundcloud = SoundcloudSongData(url: "", imageurl: nil, releaseDate: nil, isActive: false)
                        for kiddo in bea.children {
                            let dada = kiddo as! DataSnapshot
                            if dada.key.contains(soundcloudMusicContentType) == true {
                                var temp:Array<Any> = []
                                let dvalue = dada.value! as! [String:Any]
                                temp.append(dvalue["url"] as! String)
                                soundcloud.url = temp[0] as! String
                                if dvalue["Artwork URL"] != nil {
                                    soundcloud.imageurl = (dvalue["Artwork URL"] as! String)
                                }
                                if dvalue["Date Released On Soundcloud"] != nil {
                                    soundcloud.releaseDate = (dvalue["Date Released On Soundcloud"] as! String)
                                }
                                beat.soundcloud = soundcloud
                            }
                        }
                        //print("ðŸ“™ beat \(beat)")
                        if (temp[1] as! String).lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                            if !foundBeats.contains(beat) {
                                foundBeats.append(beat)
                            }
                        }
                        if (temp[65] as! Array<String>) != [""] {
                            for producer in (temp[65] as! Array<String>) {
                                let word = producer.split(separator: "Ã†")
                                let contentName = word[1]
                                if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    if !foundBeats.contains(beat) {
                                        foundBeats.append(beat)
                                    }
                                }
                            }
                            
                        }
                        if !typeArray.isEmpty {
                            for type in typeArray {
                                if type.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    if !foundBeats.contains(beat) {
                                        foundBeats.append(beat)
                                    }
                                }
                            }
                        }
                        if !soundArray.isEmpty {
                            for sound in soundArray {
                                if sound.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                    if !foundBeats.contains(beat) {
                                        foundBeats.append(beat)
                                    }
                                }
                            }
                        }
//                        if let arr = merr {
//                            for merch in arr {
//                                let word = merch.split(separator: "Ã†")
//                                let contentName = word[1]
//                                if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
//                                    if !foundBeats.contains(beat) {
//                                        foundBeats.append(beat)
//                                    }
//                                }
//                            }
//
//                        }
                    }
                }
                }
            }
            completion(foundBeats)
            return
        })
    }
    
    func searchArtists(text: String, limit: Int, completion: @escaping (([ArtistData]) -> Void)) {
        //print(text)
        var foundArtists:[ArtistData] = []
        Database.database().reference().child("Registered Artists").observeSingleEvent(of: .value, with: { snap in
            for child in snap.children {
                let kid = child as! DataSnapshot
                let key = kid.key
                if key == "All Artist IDs" {} else {
                    if foundArtists.count == limit {
                        break
                    }
                    let artis = ArtistData(name: "", legalName: nil, toneDeafAppId: "", songs: [""], videos: [""], albums: [""], merch: nil, alternateNames: [""], dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotifyProfileURL: "", appleProfileURL: "", soundcloudProfileURL: nil, youtubeMusicProfileURL: nil, amazonProfileURL: nil, deezerProfileURL: nil, spinrillaProfileURL: nil, napsterProfileURL: nil, tidalProfileURL: nil, youtubeChannelURL: nil, instagramProfileURL: nil, twitterProfileURL: nil, facebookProfileURL: nil, spotifyProfileImageURL: "", soundcloudProfileImageURL: nil, youtubeMusicProfileImageURL: nil, amazonProfileImageURL: nil, deezerProfileImageURL: nil, spinrillaProfileImageURL: nil, napsterProfileImageURL: nil, tidalProfileImageURL: nil, youtubeChannelImageURL: nil, instagramProfileImageURL: nil, twitterProfileImageURL: nil, facebookProfileImageURL: nil,appleAllArtistAlbumIds: [""],followers: 0)

                    
                    var temp:Array<Any> = []
                    let dvalue = kid.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Alternate Names"] as! Array<String>)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Linked To Account"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Songs"] as! Array<String>)
                    temp.append(dvalue["Albums"] as! Array<String>)
                    temp.append(dvalue["Videos"] as! Array<String>)
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        temp.append(merchandise)
                        artis.merch = (merchandise)
                    } else {
                        temp.append("")
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        artis.legalName = (lname as! String)
                    }
                    if let profileurl = (dvalue["Apple Profile URL"]) {
                        artis.appleProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Spotify Profile URL"]) {
                        artis.spotifyProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spotify Profile Image URL"]) {
                        artis.spotifyProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Soundcloud Profile URL"]) {
                        artis.soundcloudProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Soundcloud Profile Image URL"]) {
                        artis.soundcloudProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Music Profile URL"]) {
                        artis.youtubeMusicProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Youtube Music Profile Image URL"]) {
                        artis.youtubeMusicProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Amazon Profile URL"]) {
                        artis.amazonProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Amazon Profile Image URL"]) {
                        artis.amazonProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Deezer Profile URL"]) {
                        artis.deezerProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Deezer Profile Image URL"]) {
                        artis.deezerProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Spinrilla Profile URL"]) {
                        artis.spinrillaProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spinrilla Profile Image URL"]) {
                        artis.spinrillaProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Napster Profile URL"]) {
                        artis.napsterProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Napster Profile Image URL"]) {
                        artis.napsterProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Tidal Profile URL"]) {
                        artis.tidalProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Tidal Profile Image URL"]) {
                        artis.tidalProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Channel URL"]) {
                        artis.youtubeChannelURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Instagram Profile URL"]) {
                        artis.instagramProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Instagram Profile Image URL"]) {
                        artis.instagramProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Twitter Profile URL"]) {
                        artis.twitterProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Twitter Profile Image URL"]) {
                        artis.twitterProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Facebook Profile URL"]) {
                        artis.facebookProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Facebook Profile Image URL"]) {
                        artis.facebookProfileImageURL = (imageurl as! String)
                    }
                    
                    artis.name = temp[0] as! String
                    artis.alternateNames = temp[1] as! Array<String>
                    artis.dateRegisteredToApp = temp[2] as! String
                    artis.timeRegisteredToApp = temp[3] as! String
                    artis.linkedToAccount = temp[4] as! String
                    artis.followers = temp[5] as! Int
                    artis.toneDeafAppId = (temp[6] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                    artis.songs = temp[7] as! Array<String>
                    artis.albums = temp[8] as! Array<String>
                    artis.videos = temp[9] as! Array<String>
                    if (temp[0] as! String).lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                        if !foundArtists.contains(artis) {
                            foundArtists.append(artis)
                        }
                    }
                    if (temp[1] as! Array<String>) != [""] {
                        for altName in (temp[1] as! Array<String>) {
                            if altName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundArtists.contains(artis) {
                                    foundArtists.append(artis)
                                }
                            }
                        }
                    }
                    if (temp[7] as! Array<String>) != [""] {
                        for song in (temp[7] as! Array<String>) {
                            let word = song.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundArtists.contains(artis) {
                                    foundArtists.append(artis)
                                }
                            }
                        }
                        
                    }
                    if (temp[8] as! Array<String>) != [""] {
                        for album in (temp[8] as! Array<String>) {
                            let word = album.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundArtists.contains(artis) {
                                    foundArtists.append(artis)
                                }
                            }
                        }
                        
                    }
                    if (temp[9] as! Array<String>) != [""] {
                        for video in (temp[9] as! Array<String>) {
                            let word = video.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundArtists.contains(artis) {
                                    foundArtists.append(artis)
                                }
                            }
                        }
                    }
                    if let arr = temp[10] as? Array<String> {
                        for merch in arr {
                            let word = merch.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundArtists.contains(artis) {
                                    foundArtists.append(artis)
                                }
                            }
                        }
                        
                    }
                }
                
                
            }
            completion(foundArtists)
            return
        })
    }
    func searchProducers(text: String, limit: Int, completion: @escaping (([ProducerData]) -> Void)) {
        //print(text)
        var foundProducers:[ProducerData] = []
        Database.database().reference().child("Registered Producers").observeSingleEvent(of: .value, with: { snap in
            for child in snap.children {
                let kid = child as! DataSnapshot
                let key = kid.key
                if key == "All Producer IDs" {} else {
                    if foundProducers.count == limit {
                        break
                    }
                    let producer = ProducerData(name: "", legalName: nil, toneDeafAppId: "", songs: [""], videos: [""], beats: [""], instrumentals: [""], albums: [""], merch: nil, alternateNames: [""], dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotifyProfileURL: "", appleProfileURL: "", soundcloudProfileURL: nil, youtubeMusicProfileURL: nil, amazonProfileURL: nil, deezerProfileURL: nil, spinrillaProfileURL: nil, napsterProfileURL: nil, tidalProfileURL: nil, youtubeChannelURL: nil, instagramProfileURL: nil, twitterProfileURL: nil, facebookProfileURL: nil, spotifyProfileImageURL: "", appleAllArtistAlbumIds: [""], followers: 0)
                    let up = child as! DataSnapshot
                    var temp:Array<Any> = []
                        let dvalue = up.value as! [String:Any]
                        temp.append(dvalue["Name"] as! String)
                        temp.append(dvalue["Alternate Names"] as! Array<String>)
                        temp.append(dvalue["Date Registered To App"] as! String)
                        temp.append(dvalue["Time Registered To App"] as! String)
                        temp.append(dvalue["Linked To Account"] as! String)
                        temp.append(dvalue["Followers"] as! Int)
                        temp.append(dvalue["Tone Deaf App Id"] as! String)
                        temp.append(dvalue["Songs"] as! Array<String>)
                        temp.append(dvalue["Albums"] as! Array<String>)
                        temp.append(dvalue["Videos"] as! Array<String>)
                        temp.append(dvalue["Beats"] as! Array<String>)
                        temp.append(dvalue["Instrumentals"] as! Array<String>)
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        temp.append(merchandise)
                        producer.merch = (merchandise)
                    } else {
                        temp.append("")
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        producer.legalName = (lname as! String)
                    }
                    if let profileurl = (dvalue["Apple Profile URL"]) {
                        producer.appleProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Spotify Profile URL"]) {
                        producer.spotifyProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spotify Profile Image URL"]) {
                        producer.spotifyProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Soundcloud Profile URL"]) {
                        producer.soundcloudProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Music Profile URL"]) {
                        producer.youtubeMusicProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Amazon Profile URL"]) {
                        producer.amazonProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Deezer Profile URL"]) {
                        producer.deezerProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Spinrilla Profile URL"]) {
                        producer.spinrillaProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Napster Profile URL"]) {
                        producer.napsterProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Tidal Profile URL"]) {
                        producer.tidalProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Channel URL"]) {
                        producer.youtubeChannelURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Instagram Profile URL"]) {
                        producer.instagramProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Twitter Profile URL"]) {
                        producer.twitterProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Facebook Profile URL"]) {
                        producer.facebookProfileURL = (profileurl as! String)
                    }
                        
                        producer.name = temp[0] as! String
                        producer.alternateNames = temp[1] as! Array<String>
                        producer.dateRegisteredToApp = temp[2] as! String
                        producer.timeRegisteredToApp = temp[3] as! String
                        producer.linkedToAccount = temp[4] as! String
                        producer.followers = temp[5] as! Int
                        producer.toneDeafAppId = (temp[6] as! String).trimmingCharacters(in: .whitespacesAndNewlines)
                        producer.songs = temp[7] as! Array<String>
                        producer.albums = temp[8] as! Array<String>
                        producer.videos = temp[9] as! Array<String>
                        producer.beats = temp[10] as! Array<String>
                        producer.instrumentals = temp[11] as! Array<String>
                    if (temp[0] as! String).lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                        if !foundProducers.contains(producer) {
                            foundProducers.append(producer)
                        }
                    }
                    if (temp[1] as! Array<String>) != [""] {
                        for altName in (temp[1] as! Array<String>) {
                            if altName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundProducers.contains(producer) {
                                    foundProducers.append(producer)
                                }
                            }
                        }
                    }
                    if (temp[7] as! Array<String>) != [""] {
                        for song in (temp[7] as! Array<String>) {
                            let word = song.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundProducers.contains(producer) {
                                    foundProducers.append(producer)
                                }
                            }
                        }
                        
                    }
                    if (temp[8] as! Array<String>) != [""] {
                        for album in (temp[8] as! Array<String>) {
                            let word = album.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundProducers.contains(producer) {
                                    foundProducers.append(producer)
                                }
                            }
                        }
                        
                    }
                    if (temp[9] as! Array<String>) != [""] {
                        for video in (temp[9] as! Array<String>) {
                            let word = video.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundProducers.contains(producer) {
                                    foundProducers.append(producer)
                                }
                            }
                        }
                    }
                    if (temp[10] as! Array<String>) != [""] {
                        for beats in (temp[10] as! Array<String>) {
                            let word = beats.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundProducers.contains(producer) {
                                    foundProducers.append(producer)
                                }
                            }
                        }
                    }
                    if (temp[11] as! Array<String>) != [""] {
                        for instrumental in (temp[11] as! Array<String>) {
                            let word = instrumental.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundProducers.contains(producer) {
                                    foundProducers.append(producer)
                                }
                            }
                        }
                    }
                    if let arr = temp[12] as? Array<String> {
                        for merch in arr {
                            let word = merch.split(separator: "Ã†")
                            let contentName = word[1]
                            if contentName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines).contains(text.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)) {
                                if !foundProducers.contains(producer) {
                                    foundProducers.append(producer)
                                }
                            }
                        }
                        
                    }
                }
                
                
            }
            completion(foundProducers)
            return
        })
    }
    
    
    
    
    
    func getSongFavorites(currentSong: SongData, completion: @escaping ((Int) -> Void)) {
        var artistNameData:Array<String> = []
        for artist in currentSong.songArtist {
            
            let word = artist.split(separator: "Ã†")
            let id = word[1]
            artistNameData.append(String(id))
        }
        let categorty = "\(songContentTag)--\(currentSong.name)--\(artistNameData.joined(separator: ", "))--\(currentSong.toneDeafAppId)"
        Database.database().reference().child("Music Content").child("Songs").child(categorty).child("REQUIRED").observeSingleEvent(of: .value, with: { snap in
            let dvalue = snap.value as! [String:Any]
            let favs = dvalue["Number of Favorites Overall"] as! Int
            print(favs)
            completion(favs)
        })
        
        
    }
    
    func getAlbumFavorites(currentAlbum: AlbumData, completion: @escaping ((Int) -> Void)) {
        var mainArtistsNames:Array<String> = []
        for artist in currentAlbum.mainArtist {
            let word = artist.split(separator: "Ã†")
            let id = word[1]
            mainArtistsNames.append(String(id))
        }
        let categorty = "\(albumContentTag)--\(currentAlbum.name)--\(mainArtistsNames.joined(separator: ", "))--\(currentAlbum.toneDeafAppId)"
        Database.database().reference().child("Music Content").child("Albums").child(categorty).child("REQUIRED").observeSingleEvent(of: .value, with: { snap in
            let dvalue = snap.value as! [String:Any]
            let favs = dvalue["Number of Favorites Overall"] as! Int
            print(favs)
            completion(favs)
        })
        
        
    }
    
    func getInstrumentalFavorites(currentInstrumental: InstrumentalData, completion: @escaping ((Int) -> Void)) {
        var name = ""
        if let j = currentInstrumental.instrumentalName?.replacingOccurrences(of: " (Instrumental)", with: "") {
            name = j
        } else if let j = currentInstrumental.songName {
            name = j
        }
        let categorty = ("\(instrumentalContentType )--\(name)--\(currentInstrumental.dateRegisteredToApp ?? "")--\(currentInstrumental.timeRegisteredToApp ?? "")--\(currentInstrumental.toneDeafAppId)")
        print(categorty)
        Database.database().reference().child("Music Content").child("Instrumentals").child(categorty).observeSingleEvent(of: .value, with: { snap in
            let dvalue = snap.value as! [String:Any]
            let favs = dvalue["Number of Favorites"] as! Int
            print(favs)
            completion(favs)
        })
    }
    
    func getVideoFavorites(currentVideo: AnyObject, completion: @escaping ((Int) -> Void)) {
        var artistNameData:Array<String> = []
        var categorty = ""
        switch currentVideo {
        case is YouTubeData:
            let youtube = currentVideo as! YouTubeData
            categorty = ("\(youtube.type)--\(youtube.title.replacingOccurrences(of: ".", with: " ").replacingOccurrences(of: "#", with: " ").replacingOccurrences(of: "$", with: " ").replacingOccurrences(of: "[", with: " ").replacingOccurrences(of: "]", with: " ").replacingOccurrences(of: ":", with: " "))--\(youtube.dateIA)--\(youtube.timeIA)--\(youtube.toneDeafAppId)")
        default:
            print("kjvhg")
        }
        Database.database().reference().child("Music Content").child("Videos").child(categorty).observeSingleEvent(of: .value, with: { snap in
            let dvalue = snap.value as! [String:Any]
            let favs = dvalue["Number of Favorites"] as! Int
            print(favs)
            completion(favs)
        })
        
        
    }
    
    func getBeatFavorites(currentBeat: BeatData, completion: @escaping ((Int) -> Void)) {
        print(currentBeat.priceType)
        print(currentBeat.beatID)
        Database.database().reference().child("Beats").child(currentBeat.priceType).child(currentBeat.beatID).observeSingleEvent(of: .value, with: { snap in
            let dvalue = snap.value as! [String:Any]
            let favs = dvalue["Number of Favorites"] as! Int
            completion(favs)
        })
        
        
    }
    
    func getBeatDownloads(currentBeat: BeatData, completion: @escaping ((Int) -> Void)) {
        print(currentBeat.priceType)
        print(currentBeat.beatID)
        Database.database().reference().child("Beats").child(currentBeat.priceType).child(currentBeat.beatID).observeSingleEvent(of: .value, with: { snap in
            let dvalue = snap.value as! [String:Any]
            let dloads = dvalue["Number of Downloads"] as! Int
            completion(dloads)
        })
        
        
    }
    
    
    
    public typealias downgradeAccountToListenerCompletion = (Result<Bool, Error>) -> Void
    func downgradeAccountToListener(completion: @escaping downgradeAccountToListenerCompletion) {
        Database.database().reference().child("Users").child(currentAppUser.uid).child("Account Type").setValue(ListenerAccount)
        completion(.success(true))
    }
    
    public typealias upgradeAccountToCreatorCompletion = (Result<Bool, Error>) -> Void
    func upgradeAccountToCreator(completion: @escaping upgradeAccountToCreatorCompletion) {
        Database.database().reference().child("Users").child(currentAppUser.uid).child("Account Type").setValue(CreatorAccount)
        completion(.success(true))
    }
    
    
    
    
    
    
    
    public func setMusicFeaturedArtistContent(completion: @escaping (([ArtistData]) -> Void)) {
        var snapArray:[DataSnapshot] = []
        var artistFeaturedArray:[ArtistData] = []
        
        Database.database().reference().child("Registered Artists").observeSingleEvent(of: .value, with: { snapshot in
            for content in snapshot.children {
                let pieceOfContent = content as! DataSnapshot
                snapArray.append(pieceOfContent)
            }
            snapArray.shuffle()
            //print(snapArray)
            for snapshot in snapArray {
                if count < 11 {
                    let key = snapshot.key
                    
                    
                    let artist = ArtistData(name: "", legalName: nil, toneDeafAppId: "", songs: [""], videos: [""], albums: [""], merch: nil, alternateNames: [""], dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotifyProfileURL: "", appleProfileURL: "", soundcloudProfileURL: nil, youtubeMusicProfileURL: nil, amazonProfileURL: nil, deezerProfileURL: nil, spinrillaProfileURL: nil, napsterProfileURL: nil, tidalProfileURL: nil, youtubeChannelURL: nil, instagramProfileURL: nil, twitterProfileURL: nil, facebookProfileURL: nil, spotifyProfileImageURL: "", soundcloudProfileImageURL: nil, youtubeMusicProfileImageURL: nil, amazonProfileImageURL: nil, deezerProfileImageURL: nil, spinrillaProfileImageURL: nil, napsterProfileImageURL: nil, tidalProfileImageURL: nil, youtubeChannelImageURL: nil, instagramProfileImageURL: nil, twitterProfileImageURL: nil, facebookProfileImageURL: nil,appleAllArtistAlbumIds: [""],followers: 0)

                    
                    var temp:Array<Any> = []
                    let dvalue = snapshot.value as! [String:Any]
                    temp.append(dvalue["Name"] as! String)
                    temp.append(dvalue["Alternate Names"] as! Array<String>)
                    temp.append(dvalue["Date Registered To App"] as! String)
                    temp.append(dvalue["Time Registered To App"] as! String)
                    temp.append(dvalue["Linked To Account"] as! String)
                    temp.append(dvalue["Spotify Profile URL"] as! String)
                    temp.append(dvalue["Spotify Profile Image URL"] as! String)
                    temp.append(dvalue["Followers"] as! Int)
                    temp.append(dvalue["Tone Deaf App Id"] as! String)
                    temp.append(dvalue["Songs"] as! Array<String>)
                    temp.append(dvalue["Albums"] as! Array<String>)
                    if let merchandise = (dvalue["Merch"] as? [String]) {
                        artist.merch = (merchandise)
                    }
                    if let lname = (dvalue["Legal Name"]) {
                        artist.legalName = (lname as! String)
                    }
                    if let profileurl = (dvalue["Apple Profile URL"]) {
                        artist.appleProfileURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Spotify Profile URL"]) {
                        artist.spotifyProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spotify Profile Image URL"]) {
                        artist.spotifyProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Soundcloud Profile URL"]) {
                        artist.soundcloudProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Soundcloud Profile Image URL"]) {
                        artist.soundcloudProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Music Profile URL"]) {
                        artist.youtubeMusicProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Youtube Music Profile Image URL"]) {
                        artist.youtubeMusicProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Amazon Profile URL"]) {
                        artist.amazonProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Amazon Profile Image URL"]) {
                        artist.amazonProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Deezer Profile URL"]) {
                        artist.deezerProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Deezer Profile Image URL"]) {
                        artist.deezerProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Spinrilla Profile URL"]) {
                        artist.spinrillaProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Spinrilla Profile Image URL"]) {
                        artist.spinrillaProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Napster Profile URL"]) {
                        artist.napsterProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Napster Profile Image URL"]) {
                        artist.napsterProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Tidal Profile URL"]) {
                        artist.tidalProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Tidal Profile Image URL"]) {
                        artist.tidalProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Youtube Channel URL"]) {
                        artist.youtubeChannelURL = (profileurl as! String)
                    }
                    if let profileurl = (dvalue["Instagram Profile URL"]) {
                        artist.instagramProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Instagram Profile Image URL"]) {
                        artist.instagramProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Twitter Profile URL"]) {
                        artist.twitterProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Twitter Profile Image URL"]) {
                        artist.twitterProfileImageURL = (imageurl as! String)
                    }
                    if let profileurl = (dvalue["Facebook Profile URL"]) {
                        artist.facebookProfileURL = (profileurl as! String)
                    }
                    if let imageurl = (dvalue["Facebook Profile Image URL"]) {
                        artist.facebookProfileImageURL = (imageurl as! String)
                    }
                    
                    artist.name = temp[0] as! String
                    artist.alternateNames = temp[1] as! Array<String>
                    artist.dateRegisteredToApp = temp[2] as! String
                    artist.timeRegisteredToApp = temp[3] as! String
                    artist.linkedToAccount = temp[4] as! String
                    artist.spotifyProfileURL = temp[5] as! String
                    artist.spotifyProfileImageURL = temp[6] as! String
                    artist.followers = temp[7] as! Int
                    artist.toneDeafAppId = temp[8] as! String
                    artist.songs = temp[9] as! Array<String>
                    artist.albums = temp[10] as! Array<String>
                    
                    artistFeaturedArray.append(artist)
                    
                    //Copy 12 To other node
                    Database.database().reference().child("Current Featured Content").child("Main Music Featured Artists").removeValue()
                    let ref1 = Database.database().reference().child("Registered Artists").child(key)
                    let ref2 = Database.database().reference().child("Current Featured Content").child("Main Music Featured Artists").child(key)
                    
                    ref1.observeSingleEvent(of: .value, with: { snapshot in
                        let log = snapshot.value
                        ref2.setValue(log)
                        //print("Done")
                    })
                }
                
            }
            //print(artistFeaturedArray)
            completion(artistFeaturedArray)
        })
        
        
    }
    
    func getMusicFeaturedArtistContent(completion: @escaping (([ArtistData]) -> Void)) {
        var contentFeaturedArray:[ArtistData] = []
        Database.database().reference().child("Current Featured Content").child("Main Music Featured Artists").observeSingleEvent(of: .value, with: { snapshot in
            //print("ðŸ““\(snapshot)")
            for child in snapshot.children {
                let up = child as! DataSnapshot
                let artist = ArtistData(name: "", legalName: nil, toneDeafAppId: "", songs: [""], videos: [""], albums: [""], merch: nil, alternateNames: [""], dateRegisteredToApp: "", timeRegisteredToApp: "", linkedToAccount: "", spotifyProfileURL: "", appleProfileURL: "", soundcloudProfileURL: nil, youtubeMusicProfileURL: nil, amazonProfileURL: nil, deezerProfileURL: nil, spinrillaProfileURL: nil, napsterProfileURL: nil, tidalProfileURL: nil, youtubeChannelURL: nil, instagramProfileURL: nil, twitterProfileURL: nil, facebookProfileURL: nil, spotifyProfileImageURL: "", soundcloudProfileImageURL: nil, youtubeMusicProfileImageURL: nil, amazonProfileImageURL: nil, deezerProfileImageURL: nil, spinrillaProfileImageURL: nil, napsterProfileImageURL: nil, tidalProfileImageURL: nil, youtubeChannelImageURL: nil, instagramProfileImageURL: nil, twitterProfileImageURL: nil, facebookProfileImageURL: nil,appleAllArtistAlbumIds: [""],followers: 0)

                var temp:Array<Any> = []
                let dvalue = up.value as! [String:Any]
                temp.append(dvalue["Name"] as! String)
                temp.append(dvalue["Alternate Names"] as! Array<String>)
                temp.append(dvalue["Date Registered To App"] as! String)
                temp.append(dvalue["Time Registered To App"] as! String)
                temp.append(dvalue["Linked To Account"] as! String)
                temp.append(dvalue["Spotify Profile URL"] as! String)
                temp.append(dvalue["Spotify Profile Image URL"] as! String)
                temp.append(dvalue["Followers"] as! Int)
                temp.append(dvalue["Tone Deaf App Id"] as! String)
                temp.append(dvalue["Songs"] as! Array<String>)
                temp.append(dvalue["Albums"] as! Array<String>)
                if let merchandise = (dvalue["Merch"] as? [String]) {
                    artist.merch = (merchandise)
                }
                if let lname = (dvalue["Legal Name"]) {
                    artist.legalName = (lname as! String)
                }
                if let profileurl = (dvalue["Apple Profile URL"]) {
                    artist.appleProfileURL = (profileurl as! String)
                }
                if let profileurl = (dvalue["Spotify Profile URL"]) {
                    artist.spotifyProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Spotify Profile Image URL"]) {
                    artist.spotifyProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Soundcloud Profile URL"]) {
                    artist.soundcloudProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Soundcloud Profile Image URL"]) {
                    artist.soundcloudProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Youtube Music Profile URL"]) {
                    artist.youtubeMusicProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Youtube Music Profile Image URL"]) {
                    artist.youtubeMusicProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Amazon Profile URL"]) {
                    artist.amazonProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Amazon Profile Image URL"]) {
                    artist.amazonProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Deezer Profile URL"]) {
                    artist.deezerProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Deezer Profile Image URL"]) {
                    artist.deezerProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Spinrilla Profile URL"]) {
                    artist.spinrillaProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Spinrilla Profile Image URL"]) {
                    artist.spinrillaProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Napster Profile URL"]) {
                    artist.napsterProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Napster Profile Image URL"]) {
                    artist.napsterProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Tidal Profile URL"]) {
                    artist.tidalProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Tidal Profile Image URL"]) {
                    artist.tidalProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Youtube Channel URL"]) {
                    artist.youtubeChannelURL = (profileurl as! String)
                }
                if let profileurl = (dvalue["Instagram Profile URL"]) {
                    artist.instagramProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Instagram Profile Image URL"]) {
                    artist.instagramProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Twitter Profile URL"]) {
                    artist.twitterProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Twitter Profile Image URL"]) {
                    artist.twitterProfileImageURL = (imageurl as! String)
                }
                if let profileurl = (dvalue["Facebook Profile URL"]) {
                    artist.facebookProfileURL = (profileurl as! String)
                }
                if let imageurl = (dvalue["Facebook Profile Image URL"]) {
                    artist.facebookProfileImageURL = (imageurl as! String)
                }
                
                artist.name = temp[0] as! String
                artist.alternateNames = temp[1] as! Array<String>
                artist.dateRegisteredToApp = temp[2] as! String
                artist.timeRegisteredToApp = temp[3] as! String
                artist.linkedToAccount = temp[4] as! String
                artist.spotifyProfileURL = temp[5] as! String
                artist.spotifyProfileImageURL = temp[6] as! String
                artist.followers = temp[7] as! Int
                artist.toneDeafAppId = temp[8] as! String
                artist.songs = temp[9] as! Array<String>
                artist.albums = temp[10] as! Array<String>
                
                contentFeaturedArray.append(artist)
            }
            //print(contentFeaturedArray)
            completion(contentFeaturedArray)
        })
    }
    
    func fetchArtistVideos(completion: @escaping (([AnyObject]) -> Void)) {
        var contentFeaturedArray:[AnyObject] = []
        Database.database().reference().child("Music Content").observeSingleEvent(of: .value, with: { snapshot in
            for child in snapshot.children {
                let data = child as! DataSnapshot
                let key = data.key
                if key.contains(songContentTag) == true {
                    var youtubeAlts:[String] = []
                    let song = SongData(toneDeafAppId: "", instrumentals: [], albums: [], videos: [], merch: nil, name: "", dateRegisteredToApp: "", timeRegisteredToApp: "", songArtist: [], songProducers: [], songWriters: nil, songMixEngineer: nil, songMasteringEngineer: nil, songRecordingEngineer: nil, favoritesOverall: 0, manualImageURL: nil, manualPreviewURL: nil, apple: nil, spotify: nil, soundcloud: nil, youtubeMusic: nil, amazon: nil, deezer: nil, spinrilla: nil, napster: nil, tidal: nil, officialVideo: nil, audioVideo: nil,lyricVideo:nil, remixes: nil, isRemix:nil, isOtherVersion: nil, otherVersions: nil, explicit: nil, industryCerified: nil, verificationLevel: nil, isActive: false)
                    for kid in data.children {
                        let lildata = kid as! DataSnapshot
                        let lilkey = lildata.key
                        if lilkey == "REQUIRED" {
                            var temp:Array<Any> = []
                            var artistarray:Array<String> = []
                            let dvalue = lildata.value as! [String:Any]
                            temp.append(dvalue["Name"] as! String)
                            let tist = (dvalue["Artist"] as! Array<[String:Any]>)
                            for art in tist {
                                for (key, value) in art {
                                    let avalue = value as! [String:Any]
                                    let theid = avalue["id"]
                                    let id = String(describing: theid).replacingOccurrences(of: "Optional", with: "").replacingOccurrences(of: "(", with: "").replacingOccurrences(of: ")", with: "")
                                    artistarray.append(id)
                                }
                            }
                            print(artistarray)
                            temp.append(dvalue["Producers"] as! Array<String>)
                            temp.append(dvalue["Number of Favorites Overall"] as! Int)
                            temp.append(dvalue["Tone Deaf App Id"] as! String)
                            temp.append(dvalue["Instrumental App Id"] as! String)
                            temp.append(dvalue["Album App Id"] as! String)
                            if let merchandise = (dvalue["Merch"] as? [String]) {
                                song.merch = (merchandise)
                        }
                            if let tval = (dvalue["Date Registered To App"] as? String) {
                                song.dateRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Time Registered To App"] as? String) {
                                song.timeRegisteredToApp = tval
                            }
                            if let tval = (dvalue["Remixes"] as? [String]) {
                                song.remixes = tval
                            }
                            if let tval = (dvalue["Other Versions"] as? [String]) {
                                song.otherVersions = tval
                            }
                            
                            if let taval = (dvalue["Remix"] as? NSDictionary) {
                                let deluxe = SongRemixData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isRemix = deluxe
                            }
                            if let taval = (dvalue["Other Version"] as? NSDictionary) {
                                let deluxe = SongOtherVersionData(standardEdition: nil, status: false)
                                if let tval = (taval["Standard Edition"] as? String) {
                                    deluxe.standardEdition = tval
                                }
                                if let tval = (taval["Status"] as? Bool) {
                                    deluxe.status = tval
                                }
                                song.isOtherVersion = deluxe
                            }
                        
                        song.name = temp[0] as! String
                            song.songArtist = artistarray
                            song.songProducers = temp[1] as! Array<String>
                            song.favoritesOverall = temp[2] as! Int
                            song.toneDeafAppId = temp[3] as! String
                        }
                        if lilkey.contains(youtubeAltVideoContentType) == true {
                            var temp:Array<Any> = []
                            let dvalue = lildata.value! as! [String:Any]
                            temp.append(dvalue["Channel Title"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To Youtube"] as! String)
                            temp.append(dvalue["Description"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Thumbnail URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Time Uploaded To Youtube"] as! String)
                            temp.append(dvalue["Title"] as! String)
                            temp.append(dvalue["Video URL"] as! String)
                            temp.append(dvalue["Views In App"] as! Int)
                            temp.append(dvalue["Views on Youtube"] as! Int)
                            temp.append(dvalue["Youtube Id"] as! String)
                            //print(temp)
                            
                           
                        }
                        if lilkey.contains(youtubeVideoContentTyp) == true {
                            var temp:Array<Any> = []
                            let dvalue = lildata.value! as! [String:Any]
                            temp.append(dvalue["Channel Title"] as! String)
                            temp.append(dvalue["Duration"] as! String)
                            temp.append(dvalue["Date Uploaded To App"] as! String)
                            temp.append(dvalue["Date Uploaded To Youtube"] as! String)
                            temp.append(dvalue["Description"] as! String)
                            temp.append(dvalue["Number of Favorites"] as! Int)
                            temp.append(dvalue["Thumbnail URL"] as! String)
                            temp.append(dvalue["Time Uploaded To App"] as! String)
                            temp.append(dvalue["Time Uploaded To Youtube"] as! String)
                            temp.append(dvalue["Title"] as! String)
                            temp.append(dvalue["Video URL"] as! String)
                            temp.append(dvalue["Views In App"] as! Int)
                            temp.append(dvalue["Views on Youtube"] as! Int)
                            temp.append(dvalue["Youtube Id"] as! String)
                            //print(temp)
                            
                            }
                        }
                    contentFeaturedArray.append(song)
                    }
                }
                completion(contentFeaturedArray)
            })
        
    }
    
    func isEqual<T: Equatable>(type: T.Type, a: Any, b: Any) -> Bool {
        guard let a = a as? T, let b = b as? T else { return false }

        return a == b
    }
}

public enum SongIdErrors: Error {
    case iDNotFound
}

public enum VideoIdErrors: Error {
    case iDNotFound
} 


extension ArtistData: Equatable {
    static func == (lhs: ArtistData, rhs: ArtistData) -> Bool {
        return lhs.toneDeafAppId == rhs.toneDeafAppId
    }
}

extension ProducerData: Equatable {
    static func == (lhs: ProducerData, rhs: ProducerData) -> Bool {
        return lhs.toneDeafAppId == rhs.toneDeafAppId
    }
}




extension AlbumSong: Equatable {
    static func == (lhs: AlbumSong, rhs: AlbumSong) -> Bool {
        return lhs.trackNumber == rhs.trackNumber
    }
}

extension UserDownload: Equatable {
    static func == (lhs: UserDownload, rhs: UserDownload) -> Bool {
        return lhs.dbid == rhs.dbid
    }
}

extension MerchData: Equatable {
    static func == (lhs: MerchData, rhs: MerchData) -> Bool {
        var bool = false
        if lhs.apperal == rhs.apperal && lhs.instrumentalSale == rhs.instrumentalSale && lhs.kit == rhs.kit && lhs.memorabilia == rhs.memorabilia && lhs.service == rhs.service {
            bool = true
        }
        return bool
    }
}

extension MerchKitData: Equatable {
    static func == (lhs: MerchKitData, rhs: MerchKitData) -> Bool {
        return lhs.tDAppId == rhs.tDAppId
    }
}

extension MerchApperalData: Equatable {
    static func == (lhs: MerchApperalData, rhs: MerchApperalData) -> Bool {
        return lhs.tDAppId == rhs.tDAppId
    }
}

extension MerchServiceData: Equatable {
    static func == (lhs: MerchServiceData, rhs: MerchServiceData) -> Bool {
        return lhs.tDAppId == rhs.tDAppId
    }
}

extension MerchMemorabiliaData: Equatable {
    static func == (lhs: MerchMemorabiliaData, rhs: MerchMemorabiliaData) -> Bool {
        return lhs.tDAppId == rhs.tDAppId
    }
}

extension MerchInstrumentalData: Equatable {
    static func == (lhs: MerchInstrumentalData, rhs: MerchInstrumentalData) -> Bool {
        return lhs.instrumentaldbid == rhs.instrumentaldbid
    }
}

extension CheckoutAgreementPair: Equatable {
    static func == (lhs: CheckoutAgreementPair, rhs: CheckoutAgreementPair) -> Bool {
        var bool = false
        if lhs.product.id == rhs.product.id && lhs.type == rhs.type {
            bool = true
        }
        return bool
    }
}
